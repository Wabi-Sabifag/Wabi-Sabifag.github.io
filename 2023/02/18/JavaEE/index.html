<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>JavaEE | 当你抬头仰望星辰时，月辉亲昵双颊</title><meta name="author" content="Wabi-Sabifag"><meta name="copyright" content="Wabi-Sabifag"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="1.SpringBoot1.Rest风格1.1Rest1.1.1 Rest简介 Rest 表现形式状态转换传统风格   http:&#x2F;&#x2F;localhost&#x2F;user&#x2F;getById?id&#x3D;1  http:&#x2F;&#x2F;localhost&#x2F;user&#x2F;saveUser   Rest风格  http:&#x2F;&#x2F;localhost&#x2F;user&#x2F;1&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbs">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaEE">
<meta property="og:url" content="https://github.com/Wabi-Sabifag/Wabi-Sabifag.github.io/2023/02/18/JavaEE/index.html">
<meta property="og:site_name" content="当你抬头仰望星辰时，月辉亲昵双颊">
<meta property="og:description" content="1.SpringBoot1.Rest风格1.1Rest1.1.1 Rest简介 Rest 表现形式状态转换传统风格   http:&#x2F;&#x2F;localhost&#x2F;user&#x2F;getById?id&#x3D;1  http:&#x2F;&#x2F;localhost&#x2F;user&#x2F;saveUser   Rest风格  http:&#x2F;&#x2F;localhost&#x2F;user&#x2F;1&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbs">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://github.com/Wabi-Sabifag/Wabi-Sabifag.github.io/img/22.png">
<meta property="article:published_time" content="2023-02-18T05:02:38.000Z">
<meta property="article:modified_time" content="2024-03-08T21:54:16.865Z">
<meta property="article:author" content="Wabi-Sabifag">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="JavaEE">
<meta property="article:tag" content="Mybatis">
<meta property="article:tag" content="MybatisPlus">
<meta property="article:tag" content="SpringBoot">
<meta property="article:tag" content="Docker">
<meta property="article:tag" content="Redis">
<meta property="article:tag" content="Swaggger">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/Wabi-Sabifag/Wabi-Sabifag.github.io/img/22.png"><link rel="shortcut icon" href="https://safebooru.org//samples/3404/sample_2d70be5f0453c31b5e9ad641db7cf3fb90ba2c23.jpg?3541071"><link rel="canonical" href="https://github.com/Wabi-Sabifag/Wabi-Sabifag.github.io/2023/02/18/JavaEE/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":730,"position":"top","messagePrev":"该版本已经是","messageNext":"天前的内容，请你仔细辨别版本和其他问题😉"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'JavaEE',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2024-03-09 05:54:16'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@1,300&display=swap" rel="stylesheet"><meta name="generator" content="Hexo 5.4.2">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="当你抬头仰望星辰时，月辉亲昵双颊" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://safebooru.org//samples/3404/sample_2d70be5f0453c31b5e9ad641db7cf3fb90ba2c23.jpg?3541071" onerror="onerror=null;src='https://safebooru.org//samples/3404/sample_2d70be5f0453c31b5e9ad641db7cf3fb90ba2c23.jpg?3541071'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">25</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">28</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 殿首</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-moon"></i><span> 吾の博客</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-clock"></i><span> 故往尘飞、吾心犹然</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-earth"></i><span> 自然科学</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/nature/"><i class="fa-fw fas fa-sun"></i><span> 舒适の自然</span></a></li><li><a class="site-page child" href="/animal/"><i class="fa-fw fas fa-dog"></i><span> 可爱の动物</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-computer"></i><span> 社会科学</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/science/"><i class="fa-fw fas fa-ruler"></i><span> 理性科学</span></a></li><li><a class="site-page child" href="/history/"><i class="fa-fw fas fa-history"></i><span> 历史</span></a></li><li><a class="site-page child" href="/philosophy/"><i class="fa-fw fas fa-brain"></i><span> 哲学</span></a></li><li><a class="site-page child" href="/psychology/"><i class="fa-fw fas fa-heartbeat"></i><span> 心理</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-coffee"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/book/"><i class="fa-fw fas fa-book"></i><span> 文学</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/images/"><i class="fa-fw fas fa-images"></i><span> 绘画</span></a></li><li><a class="site-page child" href="/hand/"><i class="fa-fw fas fa-hand"></i><span> 雕塑</span></a></li><li><a class="site-page child" href="/mask/"><i class="fa-fw fas fa-balance-scale"></i><span> 戏剧</span></a></li><li><a class="site-page child" href="/city/"><i class="fa-fw fas fa-city"></i><span> 建筑</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 电影</span></a></li><li><a class="site-page child" href="/sport/"><i class="fa-fw fas fa-basketball"></i><span> 体育</span></a></li><li><a class="site-page child" href="/hospital/"><i class="fa-fw fa fa-star"></i><span> 动漫</span></a></li><li><a class="site-page child" href="/game/"><i class="fa-fw fa fa-game"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-compass"></i><span> 其他信息</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-paper-plane"></i><span> --关于--</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/22.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">当你抬头仰望星辰时，月辉亲昵双颊</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 殿首</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-moon"></i><span> 吾の博客</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-clock"></i><span> 故往尘飞、吾心犹然</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-earth"></i><span> 自然科学</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/nature/"><i class="fa-fw fas fa-sun"></i><span> 舒适の自然</span></a></li><li><a class="site-page child" href="/animal/"><i class="fa-fw fas fa-dog"></i><span> 可爱の动物</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-computer"></i><span> 社会科学</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/science/"><i class="fa-fw fas fa-ruler"></i><span> 理性科学</span></a></li><li><a class="site-page child" href="/history/"><i class="fa-fw fas fa-history"></i><span> 历史</span></a></li><li><a class="site-page child" href="/philosophy/"><i class="fa-fw fas fa-brain"></i><span> 哲学</span></a></li><li><a class="site-page child" href="/psychology/"><i class="fa-fw fas fa-heartbeat"></i><span> 心理</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-coffee"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/book/"><i class="fa-fw fas fa-book"></i><span> 文学</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/images/"><i class="fa-fw fas fa-images"></i><span> 绘画</span></a></li><li><a class="site-page child" href="/hand/"><i class="fa-fw fas fa-hand"></i><span> 雕塑</span></a></li><li><a class="site-page child" href="/mask/"><i class="fa-fw fas fa-balance-scale"></i><span> 戏剧</span></a></li><li><a class="site-page child" href="/city/"><i class="fa-fw fas fa-city"></i><span> 建筑</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 电影</span></a></li><li><a class="site-page child" href="/sport/"><i class="fa-fw fas fa-basketball"></i><span> 体育</span></a></li><li><a class="site-page child" href="/hospital/"><i class="fa-fw fa fa-star"></i><span> 动漫</span></a></li><li><a class="site-page child" href="/game/"><i class="fa-fw fa fa-game"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-compass"></i><span> 其他信息</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-paper-plane"></i><span> --关于--</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">JavaEE</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-02-18T05:02:38.000Z" title="发表于 2023-02-18 13:02:38">2023-02-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-03-08T21:54:16.865Z" title="更新于 2024-03-09 05:54:16">2024-03-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java/">Java</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java/JavaEE/">JavaEE</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">28.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>131分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="1-SpringBoot"><a href="#1-SpringBoot" class="headerlink" title="1.SpringBoot"></a>1.SpringBoot</h1><h2 id="1-Rest风格"><a href="#1-Rest风格" class="headerlink" title="1.Rest风格"></a>1.Rest风格</h2><h3 id="1-1Rest"><a href="#1-1Rest" class="headerlink" title="1.1Rest"></a>1.1Rest</h3><h4 id="1-1-1-Rest简介"><a href="#1-1-1-Rest简介" class="headerlink" title="1.1.1 Rest简介"></a>1.1.1 Rest简介</h4><ul>
<li>Rest 表现形式状态转换<br><strong>传统风格</strong></li>
</ul>
<ul>
<li><p><a target="_blank" rel="noopener external nofollow noreferrer" href="http://localhost/user/getById?id=1">http://localhost/user/getById?id=1</a></p>
</li>
<li><p><a target="_blank" rel="noopener external nofollow noreferrer" href="http://localhost/user/saveUser">http://localhost/user/saveUser</a></p>
</li>
</ul>
<p><strong>Rest风格</strong></p>
<ul>
<li><p><a target="_blank" rel="noopener external nofollow noreferrer" href="http://localhost/user/1">http://localhost/user/1</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(查询单数，删除用户信息)</p>
</li>
<li><p><a target="_blank" rel="noopener external nofollow noreferrer" href="http://localhost/user">http://localhost/user</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(查询复数，添加，修改用户信息)</p>
</li>
</ul>
<p><strong>优点</strong></p>
<ul>
<li><p>隐藏资源访问行为</p>
</li>
<li><p>书写简化</p>
</li>
</ul>
<h4 id="1-1-2-地址栏传参模式—-参数配置"><a href="#1-1-2-地址栏传参模式—-参数配置" class="headerlink" title="1.1.2 地址栏传参模式—-参数配置"></a>1.1.2 地址栏传参模式—-参数配置</h4><ul>
<li>method = RequestMethod.GET&nbsp;   查询</li>
<li>method = RequestMethod.POST   保存</li>
<li>method = RequestMethod.DELETE 删除</li>
<li>method = RequestMethod.HEAD</li>
<li>method = RequestMethod.PUT    更新</li>
<li>method = RequestMethod.OPTIONS</li>
<li>method = RequestMethod.PATCH</li>
<li>method = RequestMethod.TRACE</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.controller;

import org.springframework.web.bind.annotation.*;

@Controller
public class UserController {

    @RequestMapping(value = "/users",method = RequestMethod.POST)
    @ResponseBody
    public String save(){
        System.out.println("user save...");
        return "{'module':'user save'}";
    }

    /**
     * {id}             代表请求格式，对应方法的传参值
     * @PathVariable    指定 id 的所取值,url地址传给方法
     */
    @RequestMapping(value = "/users/{id}",method = RequestMethod.DELETE)
    @ResponseBody
    public String delete(@PathVariable Integer id){
        System.out.println("user delete..."+id);
        return "{'module':'user delete'}";
    }

&nbsp;&nbsp;&nbsp;&nbsp;@RequestMapping(value = "/users",method = RequestMethod.PUT)
    @ResponseBody
    public String update(@RequestBody User user){
        System.out.println("user update..."+user);
        return "{'module':'user update'}";
    }

&nbsp;&nbsp;&nbsp;&nbsp;/*
    * @RequestMethod.GET  专门查询语句
    */
    @RequestMapping(value = "/users/{id}",method = RequestMethod.GET)
    @ResponseBody
    public String getById(@PathVariable Integer id){
        System.out.println("user getById..."+id);
        return "{'module':'user getById'}";
    }

    @RequestMapping(value = "/users",method = RequestMethod.GET)
    @ResponseBody
    public String getAll(){
        System.out.println("user getAll...");
        return "{'module':'user getAll'}";
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>总结：</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;区别</p>
<ul>
<li><p>@RequestParam 用于接受 url 地址传参或表单传参</p>
</li>
<li><p>@RequestBody 用于接受json数据</p>
</li>
<li><p>@PathVariable 用于接收路径参数，使用 {name} 描述路径参数</p>
</li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;应用</p>
<ul>
<li><p>后期开发，发送请求超过一个参数，以json格式，@RequestBody 应用为主</p>
</li>
<li><p>如果发送非json格式数据，选用@RequestParam 接收请求参数</p>
</li>
<li><p>采用RESTful进行开发，当参数较少时，采用@PathVariable 接收请求路径变量，传递 id 值</p>
</li>
</ul>
<h4 id="1-1-3-Rest快速开发"><a href="#1-1-3-Rest快速开发" class="headerlink" title="1.1.3 Rest快速开发"></a>1.1.3 Rest快速开发</h4><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.controller;

import org.springframework.web.bind.annotation.*;

@RestController
@ResponseBody
//@RestController
@RequestMapping("/users")
public class UserController {

    @PostMapping
    public String save(@RequestBody User user){
        System.out.println("user save...");
        return "{'module':'user save'}";
    }

    /**
     * {id}             代表请求格式，对应方法的传参值
     * @PathVariable    指定 id 路径 的 所取值
     */
    @DeleteMapping("/{id}")
    public String delete(@PathVariable Integer id){
        System.out.println("user delete..."+id);
        return "{'module':'user delete'}";
    }
    @PutMapping
    public String update(@RequestBody User user){
        System.out.println("user update..."+user);
        return "{'module':'user update'}";
    }

    /*
    * @RequestMethod.GET  专门查询语句
    */
    @GetMapping("/{id}")
    public String getById(@PathVariable Integer id){
        System.out.println("user getById..."+id);
        return "{'module':'user getById'}";
    }

    @GetMapping
    public String getAll(){
        System.out.println("user getAll...");
        return "{'module':'user getAll'}";
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>主要点：</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;简化</p>
<ul>
<li>@RestController&nbsp;&nbsp;等价 @ResponseBody &lt; &lt; ==== &gt; &gt; @RestController (目的：省略重复)</li>
<li>value = “/users” 省略：value 但不能省略传递的 {name} 值</li>
<li>method = RequestMethod. { } @…Mapping代替 单值 和 POJO值 的传值方式</li>
<li>@PathVariable 单值传输</li>
<li>@RequestBody POJO值传输</li>
</ul>
<h2 id="2-基础配置"><a href="#2-基础配置" class="headerlink" title="2.基础配置"></a>2.基础配置</h2><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.spring.io/spring-boot/docs/current/reference/html/">SpringBoot文档地址</a></p>
<h3 id="2-1-属性配置"><a href="#2-1-属性配置" class="headerlink" title="2.1 属性配置"></a>2.1 属性配置</h3><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.spring.io/spring-boot/docs/current/reference/html/application-properties.html#appendix.application-properties">SpringBoot Appilcation.properties文档地址</a></p>
<h4 id="2-1-1-Springboot-多种属性配置-文件优先级递减"><a href="#2-1-1-Springboot-多种属性配置-文件优先级递减" class="headerlink" title="2.1.1 Springboot 多种属性配置(文件优先级递减)"></a>2.1.1 Springboot 多种属性配置(文件优先级递减)</h4><ul>
<li>.properties<ul>
<li>server.port=80</li>
</ul>
</li>
<li>.yml<ul>
<li>server:<br>  port: 80</li>
</ul>
</li>
<li>.yaml<ul>
<li>   server:<br>   port: 80</li>
</ul>
</li>
</ul>
<h5 id="1-yml格式"><a href="#1-yml格式" class="headerlink" title="1.yml格式"></a>1.yml格式</h5><ol>
<li><p>多层级属性名</p>
<pre class="line-numbers language-none"><code class="language-none">a:
 b:
  C: 1145137<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
<li><p>数组属性名</p>
<pre class="line-numbers language-none"><code class="language-none">likes:
 - games
 - foods
 - books

# 缩略模式
likes:[games,foods,books]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>对象数组属性名</p>
<pre class="line-numbers language-none"><code class="language-none">users:
 - name: zhangsan
   age: 18
 - name: Jhon
   age: 16

# 缩略模式
users:[{name:zhangsan,age:18},{name:Jhon,age:16}]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h5 id="2-数据读取"><a href="#2-数据读取" class="headerlink" title="2.数据读取"></a>2.数据读取</h5><div class="tabs" id="user.java"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#user.java-1">user.java</button></li><li class="tab"><button type="button" data-href="#user.java-2">application.properties</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="user.java-1"><pre class="line-numbers language-none"><code class="language-none">@value("${users.name}")
private String name;

@value("${likes[1]}")
private String games;

@value("${users[1].name}")
private String name;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="user.java-2"><pre class="line-numbers language-none"><code class="language-none">baseDir: c:\windows

 # 使用 ${value} 引用数据
tempDir: ${baseDir}\temp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<p>属性值(value)用 “"转义字符 的会不显示<br>使用　“spring\boot\text.txt”</p>
<h5 id="3-封装数据"><a href="#3-封装数据" class="headerlink" title="3.封装数据"></a>3.封装数据</h5><ol>
<li><p>全配置封装</p>
<pre class="line-numbers language-none"><code class="language-none">//自动装配
@Autowired
private Environment environment;

environment.getProperty("users[0].name");<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>针对性封装</p>
<div class="tabs" id="application.yml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#application.yml-1">application.yml</button></li><li class="tab"><button type="button" data-href="#application.yml-2">MyDataSource.java</button></li><li class="tab"><button type="button" data-href="#application.yml-3">ServerImpl.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="application.yml-1"><pre class="line-numbers language-none"><code class="language-none">spring:
  datasource:
    url: jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false
    username: root
    password: 123456
    driver: com.mysql.jdbc.Driver<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.yml-2"><pre class="line-numbers language-none"><code class="language-none"># 1.创建类，封装数据
package top.wabisabifag.POJO;

import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.stereotype.Component;

# 2.Spring加载数据对象，告诉Spring加载信息
@Data
@Component
@ConfigurationProperties(prefix = "spring.datasource")
public class MyDataSource {
    private String url;
    private String username;
    private String password;
    private String driver;
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.yml-3"><pre class="line-numbers language-none"><code class="language-none"># 3.使用Spring获取的信息
@Autowired
private MyDataSource myDataSource;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div></li>
</ol>
<h4 id="2-1-2-修改服务器端口"><a href="#2-1-2-修改服务器端口" class="headerlink" title="2.1.2 修改服务器端口"></a>2.1.2 修改服务器端口</h4><pre class="line-numbers language-none"><code class="language-none"># 1.配置服务器端口
server.port=80

# 2.修改Spring启动的banner

# 关闭Spring Logo
spring.main.banner-mode=off
# 将text，png等文件转化为二维图
#spring.banner.image.location=1.png

# 3.控制日志

# 输出日志级别
#logging.level.root=debug
# 在出错时输出日志
logging.level.root=error<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h2 id="3-第三方技术整合"><a href="#3-第三方技术整合" class="headerlink" title="3.第三方技术整合"></a>3.第三方技术整合</h2><h3 id="1-JUnit"><a href="#1-JUnit" class="headerlink" title="1.JUnit"></a>1.JUnit</h3><div class="tabs" id="bookdaoimpl.java"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#bookdaoimpl.java-1">BookDaoImpl.java</button></li><li class="tab"><button type="button" data-href="#bookdaoimpl.java-2">测试</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="bookdaoimpl.java-1"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.dao.Impl;

import org.springframework.stereotype.Repository;
import top.wabisabifag.dao.BookDao;

/* 3.接受Spring管理 */
@Repository
public class BookDaoImpl implements BookDao {
    @Override
    public void save() {
        System.out.println("BookDao testing");
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="bookdaoimpl.java-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.test;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import top.wabisabifag.dao.BookDao;

/* 4.获取Spring管理声明 */
@SpringBootTest
public class SpringBootJUnitApplicationTests {
    /*1.注入测试对象*/
    @Autowired
    private BookDao bookDao;

    /*2.执行测试方法*/
    @Test
    void contextLoads(){
        bookDao.save();
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<ol>
<li><p>当test 测试路径无法对应java 源代码路径</p>
<p> @SpringBootTest(classes = BookDaoImpl.class)来申明源码</p>
</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">@SpringBootTest(classes = BookDaoImpl.class)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>@RunWith(设置运行器)
@ContextConfiguration(class = .... )		//配置引导类或配置类
</code></pre>
<ul>
<li>ContextConfiguration 用于在当前包下查找声明类</li>
</ul>
<h3 id="2-MybatisPlus"><a href="#2-MybatisPlus" class="headerlink" title="2.MybatisPlus"></a>2.MybatisPlus</h3><div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.yml</button></li><li class="tab"><button type="button" data-href="#pom.xml-3">BookDao.java</button></li><li class="tab"><button type="button" data-href="#pom.xml-4">MybatisPlusConfig.java</button></li><li class="tab"><button type="button" data-href="#pom.xml-5">测试</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;dependency&gt;
  &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
  &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;
  &lt;version&gt;3.4.2&lt;/version&gt;
&lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">#配置MP相关数据库名称
mybatis-plus:
  global-config:
    db-config:
      table-prefix: tb_<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.dao;

import com.baomidou.mybatisplus.core.mapper.BaseMapper;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Select;
import top.wabisabifag.POJO.Book;

@Mapper //  继承 BaseMapper
public interface BookDao extends BaseMapper {
    public void save();
    @Select("select * from smbms_user where userid = #{id} ")
    public Book getById(int id);
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-4"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.config;

import com.baomidou.mybatisplus.annotation.DbType;
import com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;
import com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;
import org.mybatis.spring.annotation.MapperScan;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
@MapperScan("top.wabisabifag.dao")
public class MybatisPlusConfig {
    // 配置分页设置类
    @Bean
    public MybatisPlusInterceptor mybatisPlusInterceptor() {
        MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();
        interceptor.addInnerInterceptor(new PaginationInnerInterceptor(DbType.MYSQL));
        return interceptor;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-5"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.test;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import top.wabisabifag.dao.BookDao;
import top.wabisabifag.dao.Impl.BookDaoImpl;

@SpringBootTest(classes = BookDaoImpl.class)
public class SpringBootJUnitApplicationTests {

    /*1.注入测试对象*/
    @Autowired
    private BookDao bookDao;

    /*2.执行测试方法*/
    @Test
    void contextLoads(){
        bookDao.save();
        bookDao.getById(1);
    }

    @Test
    void contextLoadsPlus(){
        System.out.println(bookDao.selectById(2));
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<h3 id="4-Lombok"><a href="#4-Lombok" class="headerlink" title="4.Lombok"></a>4.Lombok</h3><div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">实体类注解</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;dependency&gt;
  &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
  &lt;artifactId&gt;lombok&lt;/artifactId&gt;
&lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.domain;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;
import lombok.ToString;

@Data  //  @Getter @Setter
@NoArgsConstructor  // 无参构造
@AllArgsConstructor // 有参构造
@ToString   
public class User {
    private int id;
    private String userCode;
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
<p>主要:</p>
<ul>
<li>@Getter @Setter 等价于 @Data</li>
</ul>
<h3 id="5-Druid"><a href="#5-Druid" class="headerlink" title="5.Druid"></a>5.Druid</h3><pre class="line-numbers language-none"><code class="language-none">------pom 获取Druid依赖------
&lt;dependency&gt;
      &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
      &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt;
      &lt;version&gt;1.1.23&lt;/version&gt;
    &lt;/dependency&gt;

-------配置--------
通用配置:
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/smbms_db?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false
    username: root
    password: 123456
    driver-class-name: com.mysql.jdbc.Driver
    type: com.alibaba.druid.pool.DruidDataSource

整合配置:
spring:
  datasource:
    druid:
      url: jdbc:mysql://localhost:3306/smbms_db?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false
      username: root
      password: 123456
      driver-class-name: com.mysql.jdbc.Driver<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h2 id="2-SSMP整合案例"><a href="#2-SSMP整合案例" class="headerlink" title="2.SSMP整合案例"></a>2.SSMP整合案例</h2><ul>
<li>实体类开发                使用Lombok 快速制作实体类</li>
<li>Dao 开发                  整合MyBatisPlus ，制作数据层测试类</li>
<li>Service 开发              基于MyBatisPlus 进行增量开发，制作业务层测试类</li>
<li>Controller 开发           基于Restful 开发，使用PostMan 测试接口功能</li>
<li>Controller 开发           前后端开发协议制作</li>
<li>页面开发                  基于VUE，Element制作，前后端联，页面数据处理<ul>
<li>CRUD 分页，查询操作</li>
</ul>
</li>
<li>项目异常处理</li>
<li>按条件查询                页面功能调整，Controller修正功能，Service修正功能</li>
</ul>
<h3 id="SMMP源代码"><a href="#SMMP源代码" class="headerlink" title="SMMP源代码"></a>SMMP源代码</h3><p><a href="">源代码</a></p>
<h2 id="3-SpringBoot维护"><a href="#3-SpringBoot维护" class="headerlink" title="3.SpringBoot维护"></a>3.SpringBoot维护</h2><h3 id="1-工程运行"><a href="#1-工程运行" class="headerlink" title="1.工程运行"></a>1.工程运行</h3><h4 id="1-Windows-jar-包执行"><a href="#1-Windows-jar-包执行" class="headerlink" title="1.Windows jar 包执行"></a>1.Windows jar 包执行</h4><pre class="line-numbers language-none"><code class="language-none">1. 执行jar 包: java -jar packageName 
2. 查询端口: netstat -ano
3. 查询指定端口: netstat -ano |findstr "端口号"
4. 根据进程PID 查询进程名称: tasklist |findstr "进程号PID号"
5. 根据PID 杀死任务: tasklist /F /PID "进程PID号"
6. 根据进程名称杀死任务: taskkill -f -t -im "进程名称"     进程名称有多个相同的<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="2-Linux-jar-包执行"><a href="#2-Linux-jar-包执行" class="headerlink" title="2.Linux jar 包执行"></a>2.Linux jar 包执行</h4><pre class="line-numbers language-none"><code class="language-none">1. 启动后端: nohup java -jar jarPackageName &gt; server.log 2&gt;&amp;1 &amp;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="3-临时属性配置"><a href="#3-临时属性配置" class="headerlink" title="3.临时属性配置"></a>3.临时属性配置</h4><ol>
<li><p>执行jar 包: java -jar packageName –server.port=8080 –spring.datasouce.druid.password=root</p>
</li>
<li><pre class="line-numbers language-none"><code class="language-none">@SpringBootApplication
@MapperScan("top.wabisabifag.dao")/*使用@MapperScan可以指定要扫描的Mapper类的包的路径*/
@ComponentScan(basePackages={"top.wabisabifag"})
public class application {

    public static void main(String[] args) {

        // 线程安全问题
        // SpringApplication.run(application.class,args);

        // 不接受外部临时参数
        SpringApplication.run(application.class);
    }

}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>application.yml 的双配置</p>
</li>
</ol>
<p>文件位置:  1. web/springboot.jar/resources/application.yml<br>           2. web/springboot.jar/resources/config/application.yml<br>           3. web/application.yml<br>           4. web/config/application.yml</p>
<pre><code>重  复: 文件优先级配置高覆盖低的;
不重复: 互不干扰;

权限等级: 逐级上升(4 &gt; 3 &gt; 2 &gt; 1)
文件内config/ .yml  &gt; 文件外 .properties
</code></pre>
<h4 id="4-多环境开发"><a href="#4-多环境开发" class="headerlink" title="4.多环境开发"></a>4.多环境开发</h4><h5 id="1-YAML"><a href="#1-YAML" class="headerlink" title="1. YAML"></a>1. YAML</h5><pre class="line-numbers language-none"><code class="language-none"># 一、应用环境
spring:
  profiles:
    active: pro
---
# 二、设置环境
# 1. 公共环境


# 2. 自定义环境
spring:
  profiles: pro
server:
  port:80
---
spring:
  profiles: dev
server:
  port:81
---
spring:
  config:
    activate:
      on-profiles: test
server:
  port:82
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h6 id="YAML-弊端"><a href="#YAML-弊端" class="headerlink" title="YAML 弊端"></a>YAML 弊端</h6><p>1.— : 分割线是格式需求<br>2.容易暴露信息，安全有问题</p>
<h6 id="YAML-优化"><a href="#YAML-优化" class="headerlink" title="YAML 优化"></a>YAML 优化</h6><p>生成配置文件:<br>    application-dev.yml<br>    application-pro.yml<br>    application-test.yml<br>    可以独立配置文件定义环境;<br>    独立配置文件便于线上系统维护更新并保障系统安全性;</p>
<h5 id="2-properties"><a href="#2-properties" class="headerlink" title="2. properties"></a>2. properties</h5><ul>
<li>文件内容格式<pre class="line-numbers language-none"><code class="language-none">spring.profiles=pro
server.port=80
---
spring.profiles=dev
server.port=81
---
spring.profiles=test
spring.profiles=82<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li>生成配置文件:<br>  application-dev.properties<br>  application-pro.properties<br>  application-test.properties</li>
</ul>
<h5 id="3-独立的功能配置文件"><a href="#3-独立的功能配置文件" class="headerlink" title="3. 独立的功能配置文件"></a>3. 独立的功能配置文件</h5><ul>
<li>根据功能 对配置文件的信息拆分<ul>
<li>application-devDB.yml</li>
<li>application-devRedis.yml</li>
<li>application-devMVC.yml</li>
</ul>
</li>
<li>application.yml 中使用include 属性在激活指定环境 条件下，同时对多环境进行加载<ul>
<li>application.yml 后加载  <pre class="line-numbers language-none"><code class="language-none">spring:
  profiles:
    active: dev
    include: devDB,devRedis,devMVC<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
</ul>
<h6 id="优化-include-无法动态更改问题"><a href="#优化-include-无法动态更改问题" class="headerlink" title="优化 include 无法动态更改问题"></a>优化 include 无法动态更改问题</h6><pre><code>+ application.yml 前加载
</code></pre>
<p>SpringBoot 2.4.X 后:</p>
<pre class="line-numbers language-none"><code class="language-none">spring:
      profiles:
        active: dev
        group:
          "dev": devDB,devRedis,devMVC
          "pro": proDB,proRedis,proMVC
          "test": testDB,testRedis,testMVC<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h5 id="4-多环境开发控制-Maven"><a href="#4-多环境开发控制-Maven" class="headerlink" title="4. 多环境开发控制(Maven)"></a>4. 多环境开发控制(Maven)</h5><div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.yml</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--设置多环境--&gt;
&lt;profiles&gt;
  &lt;profile&gt;
      &lt;id&gt;env_dev&lt;/id&gt;
      &lt;properties&gt;
        &lt;profile.active&gt;dev&lt;/profile.active&gt;
      &lt;/properties&gt;
    &lt;!--设置默认启动--&gt;
      &lt;activation&gt;
        &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;
      &lt;/activation&gt;
  &lt;/profile&gt;

  &lt;profile&gt;
    &lt;id&gt;env_pro&lt;/id&gt;
    &lt;properties&gt;
      &lt;profile.active&gt;pro&lt;/profile.active&gt;
    &lt;/properties&gt;
  &lt;/profile&gt;
&lt;/profiles&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">spring:
      profiles:
        &lt;!-- 使用Maven 的环境配置的格式 "@....@" --&gt;
        active: @profile.active@
        group:
          "dev": devDB,devRedis,devMVC
          "pro": proDB,proRedis,proMVC
          "test": testDB,testRedis,testMVC<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<ul>
<li>ieda 对Maven 环境的更改无法生效，需要手动编译compile</li>
</ul>
<h4 id="5-日志"><a href="#5-日志" class="headerlink" title="5. 日志"></a>5. 日志</h4><h5 id="1-日志设置"><a href="#1-日志设置" class="headerlink" title="1. 日志设置"></a>1. 日志设置</h5><ol>
<li>代码中使用日志工具记录日志<pre class="line-numbers language-none"><code class="language-none">@RestController
@RequestMapping("/users")
@CrossOrigin
public class UserController {
    private static final Logger log = (Logger) LoggerFactory.getLogger(UserController.class);

    @GetMapping("/{id}")
    public User getById(@PathVariable Integer id){
        // application.yml   debug:true
        log.debug("debug...");
        log.info("info...");
        log.warning("warn...");
        log.error();
        log.fatal();
        return userService.getById(id);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li>设置日志级别<pre class="line-numbers language-none"><code class="language-none"># 开启debug模式，输出调试信息，常用于检查系统运行状况
debug: true

# 设置日志级别 root表示根节点，整体应用日志级别
logging:
  level:
    root:
      error
      # 设置某包的日志级别
      top.wabisabifag.controller: debug
      # 设置分组，对某个祖设置日志级别
      enable:warn<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h5 id="2-日志工具-动态和继承"><a href="#2-日志工具-动态和继承" class="headerlink" title="2. 日志工具 (动态和继承)"></a>2. 日志工具 (动态和继承)</h5><ol>
<li><p>设置日志对象</p>
<pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.controller.Logger;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import top.wabisabifag.controller.UserController;

public class LoggerClass {
    private Class clazz = null;
    public static  Logger log;
    public LoggerClass(){
        clazz = this.getClass();
        log = LoggerFactory.getLogger(UserController.class);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>日志工具引入控制层</p>
<pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.controller.Logger;

import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.*;

@Slf4j      // 开启日志
@RestController
@RequestMapping("/users")
@CrossOrigin
public class UserController3 extends LoggerClass {
      @GetMapping("/{id}")
    public String getById(@PathVariable Integer id){
        log.debug("debug...");
        log.info("info...");
        log.warning("warn...");
        log.error("error...");
        log.fatal();
        return "springboot is running... 2";
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h5 id="3-日志输出格式"><a href="#3-日志输出格式" class="headerlink" title="3. 日志输出格式"></a>3. 日志输出格式</h5><ol>
<li>控制台日志输出<pre class="line-numbers language-none"><code class="language-none"># 日志配置
logging:
  level:
    root:
      error
  pattern:
    console: "%d %clr(5p) --- [%16t] %clr(%-40.40c){red} :%m %n"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<ul>
<li>d 日期 </li>
<li>p 信息的级别 </li>
<li>%clr(%5p)  颜色设置</li>
<li>%5p  占据的长度  </li>
<li>[%16 t] 运行的文件</li>
<li>%-40 左对齐</li>
<li>.40c 截断后，容纳40长度</li>
<li>m 消息 </li>
<li>n 换行</li>
</ul>
<ol start="2">
<li>日志记录<pre class="line-numbers language-none"><code class="language-none"># 日志配置
logging:
  level:
    root:
      error
  # 控制台日志输出
  pattern:
    console: "%d %clr(5p) --- [%16t] %clr(%-40.40c){red} :%m %n"
  # 日志文件记录
  file:
    name: server.log
  # 日志分期记录
  logback:
    rollingpolicy:
      max-file-size: 3KB
      file-name-pattern: server.%d{yyyy-MM-dd}.%i.log
      # 输出格式： server.2023-09-20.0.log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h2 id="4-SpringBoot应用开发"><a href="#4-SpringBoot应用开发" class="headerlink" title="4.SpringBoot应用开发"></a>4.SpringBoot应用开发</h2><h3 id="1-热部署"><a href="#1-热部署" class="headerlink" title="1. 热部署"></a>1. 热部署</h3><h4 id="1-热部署依赖"><a href="#1-热部署依赖" class="headerlink" title="1. 热部署依赖"></a>1. 热部署依赖</h4><pre class="line-numbers language-none"><code class="language-none">&lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
    &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>手动配置:在IEDA激活热部署: Ctrl + F9  </li>
<li>自动配置：生命周期compile</li>
</ul>
<h4 id="2-热部署范围"><a href="#2-热部署范围" class="headerlink" title="2. 热部署范围"></a>2. 热部署范围</h4><pre class="line-numbers language-none"><code class="language-none">spring:
  datasource:
    druid:
      url: jdbc:mysql://localhost:3306/smbms
      username: root
      password: 123456
      driver-class-name: com.mysql.jdbc.Driver
  # 设置不参与热部署的文件与文件夹
  # 默认不重启：
  #   /META-INF/maven  /META-INF/resources /resources  /static /public /templates
  devtools:
    restart:
      # 排除
     exclude: static/**,public/**,config/application.yml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="3-关闭热部署"><a href="#3-关闭热部署" class="headerlink" title="3. 关闭热部署"></a>3. 关闭热部署</h4><p>热部署功能只适用于 开发环境</p>
<h5 id="1-设置文件层级控制"><a href="#1-设置文件层级控制" class="headerlink" title="1.设置文件层级控制"></a>1.设置文件层级控制</h5><pre class="line-numbers language-none"><code class="language-none">spring:
  datasource:
    druid:
      url: jdbc:mysql://localhost:3306/smbms
      username: root
      password: 123456
      driver-class-name: com.mysql.jdbc.Driver
  # 设置不参与热部署的文件与文件夹
  # 默认不重启：
  #   /META-INF/maven  /META-INF/resources /resources  /static /public /templates
  devtools:
    restart:
      # 排除
     exclude: static/**,public/**,config/application.yml
      # 开关   受到权限层级影响
     enable: true<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="2-系统层级覆盖控制"><a href="#2-系统层级覆盖控制" class="headerlink" title="2. 系统层级覆盖控制"></a>2. 系统层级覆盖控制</h5><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class SSMPApplication {
    public static void main(String[] args) {
        // 系统层级覆盖热部署功能
        System.setProperty("spring.devtools.restart.enabled","false");
        SpringApplication.run(SSMPApplication.class);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-Swagger生成WebAPI文档"><a href="#2-Swagger生成WebAPI文档" class="headerlink" title="2. Swagger生成WebAPI文档"></a>2. Swagger生成WebAPI文档</h3><p>Swagger类似Postman，提供文档传输的可视化页面</p>
<h4 id="1-部署应用Swagger"><a href="#1-部署应用Swagger" class="headerlink" title="1.部署应用Swagger"></a>1.部署应用Swagger</h4><p><a href="../JavaEE/javaBase-9.jpg">Swagger的Controller层显示注解</a></p>
<div class="tabs" id="pox.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pox.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pox.xml-2">application.yml</button></li><li class="tab"><button type="button" data-href="#pox.xml-3">Swagger2Config</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pox.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--Swagger生成Web API文档--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;io.springfox&lt;/groupId&gt;
      &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;
      &lt;version&gt;3.0.0&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;io.springfox&lt;/groupId&gt;
      &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;
      &lt;version&gt;3.0.0&lt;/version&gt;
    &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pox.xml-2"><pre class="line-numbers language-none"><code class="language-none">spring:
  mvc:
    pathmatch:
      matching-strategy: ant_path_matcher<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pox.xml-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.ApiInfo;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2;

@Configuration
@EnableSwagger2
public class Swagger2Config {
    /*
    *  可视化测试页面：http://localhost:8080/swagger-ui.html
    */
    @Bean
    public Docket createRestApi(){
        return new Docket(DocumentationType.SWAGGER_2)
                .apiInfo(apiInfo())
                .select()
                .apis(RequestHandlerSelectors.basePackage("top.wabisabifag"))
                .paths(PathSelectors.any()).build();
    }

    // API 文档页面显示信息
    private ApiInfo apiInfo(){
        return new ApiInfoBuilder()
                .title("演示项目API")
                .build();
    }
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<p>Swagger的文档页面地址: <a target="_blank" rel="noopener external nofollow noreferrer" href="http://localhost:8080/swagger-ui.html">http://localhost:8080/swagger-ui.html</a></p>
<h3 id="2-第三方Bean-属性绑定-configuration"><a href="#2-第三方Bean-属性绑定-configuration" class="headerlink" title="2. 第三方Bean 属性绑定(configuration)"></a>2. 第三方Bean 属性绑定(configuration)</h3><h4 id="1-Bean-属性绑定"><a href="#1-Bean-属性绑定" class="headerlink" title="1. Bean 属性绑定"></a>1. Bean 属性绑定</h4><div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.yml</button></li><li class="tab"><button type="button" data-href="#pom.xml-3">ServertConfig.java</button></li><li class="tab"><button type="button" data-href="#pom.xml-4">SpringBootConfigurationApplication.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;dependency&gt;
      &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
      &lt;artifactId&gt;lombok&lt;/artifactId&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
  &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
  &lt;artifactId&gt;druid&lt;/artifactId&gt;
  &lt;version&gt;1.1.23&lt;/version&gt;
&lt;/dependency&gt;

&lt;!--springboot第三方配置绑定--&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;
&lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">servers:
  ipAddress: 192.168.0.1
  port: 2345
  timeout: -1

datasource:
  driverClassName: com.mysql.jdbc.Driver<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.config;

import lombok.Data;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.stereotype.Component;

//@Component  // 受Spring接管 加载为Bean 和 @EnableConfigurationProperties 冲突
@Data
@ConfigurationProperties(prefix = "servers")  // 映射配置设置
public class ServertConfig {
    private String ipAddress;
    private int port;
    private long timeout;
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-4"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag;

import com.alibaba.druid.pool.DruidDataSource;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.ConfigurableApplicationContext;
import org.springframework.context.annotation.Bean;
import top.wabisabifag.config.ServertConfig;

@SpringBootApplication
/* 自动加载配置类为Bean 和 @Component  冲突
 开启属性绑定 并 设定对应的类 */
@EnableConfigurationProperties(ServertConfig.class) 
public class SpringBootConfigurationApplication {

    /* 第三方配置类 Bean 已经加载 但是没有配置属性值

    可配置自定义 和 第三方 的 配置属性值绑定
     1.报错:  注解没有配置   加载 spring-boot-configuration-processor 依赖
     2.宽松绑定:  配置文件驼峰命名时，此处不用遵从命名规范  */

    @Bean
    @ConfigurationProperties(prefix = "datasource")
    public DruidDataSource dataSource(){
        DruidDataSource dataSource = new DruidDataSource();
        //dataSource.setDriverClassName("com.mysql.jdbc.Driver");
        return dataSource;
    }

    public static void main(String[] args) {
        ConfigurableApplicationContext ctx = SpringApplication.run(SpringBootConfigurationApplication.class,args);

        // ../config/ServerConfig 类
        ServertConfig bean = ctx.getBean(ServertConfig.class);
        System.out.println(bean);

        // 配置值
        DruidDataSource dataSource = ctx.getBean(DruidDataSource.class);
        // 获取懒加载的配置属性
        System.out.println(dataSource);

        // 设置的值 普通类对象
        System.out.println(dataSource.getDriverClassName());

    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>




<h4 id="2-宽松绑定"><a href="#2-宽松绑定" class="headerlink" title="2. 宽松绑定"></a>2. 宽松绑定</h4><ul>
<li>@ConfigurationProperties 适配多种命名模式</li>
</ul>
<ul>
<li>驼峰:             ipAddress</li>
<li>underLine         ip_adderess </li>
<li>矢量 (烤肉串)      ip-address  (主要适应应用)</li>
<li>常亮              IP_ADDRESS</li>
</ul>
<ul>
<li>@Value 数据绑定支持 驼峰<pre class="line-numbers language-none"><code class="language-none">@SpringBootTest
class application{

  @Value("${servers.ipAddress}")
  private String msg;

  @Test 
  void contextLoads(){
    System.out.println(msg);
  }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="3-常量计量单位应用-jdk版本-8"><a href="#3-常量计量单位应用-jdk版本-8" class="headerlink" title="3. 常量计量单位应用(jdk版本:8)"></a>3. 常量计量单位应用(jdk版本:8)</h3><div class="tabs" id="application.yml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#application.yml-1">application.yml</button></li><li class="tab"><button type="button" data-href="#application.yml-2">ServertConfig.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="application.yml-1"><pre class="line-numbers language-none"><code class="language-none">servers:
  ipAddress: 192.168.0.1
  port: 2345
  timeout: -1
  # 数据存储时间，服务器超时时间： 毫秒
  serverTimeOut: 3
  # 数据存储单位： Byte
  dataSize: 10<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.yml-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.config;

import lombok.Data;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.convert.DataSizeUnit;
import org.springframework.boot.convert.DurationUnit;
import org.springframework.stereotype.Component;
import org.springframework.util.unit.DataSize;
import org.springframework.util.unit.DataUnit;

import java.time.Duration;
import java.time.temporal.ChronoUnit;

//受Spring接管 加载为Bean 和 @EnableConfigurationProperties 冲突
//@Component  
@Data
@ConfigurationProperties(prefix = "servers")  // 映射配置设置
public class ServertConfig {
    private String ipAddress;
    private int port;
    private long timeout;

    @DurationUnit(ChronoUnit.HOURS) // 时间单位自定义
    private Duration serverTimeOut;

    @DataSizeUnit(DataUnit.GIGABYTES) // 数据存储单位自定义
    private DataSize dataSize;
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>


<h3 id="4-数据校验"><a href="#4-数据校验" class="headerlink" title="4. 数据校验"></a>4. 数据校验</h3><div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">ServertConfig.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--数据校验  JSR303规范 接口--&gt;
   &lt;dependency&gt;
     &lt;groupId&gt;javax.validation&lt;/groupId&gt;
     &lt;artifactId&gt;validation-api&lt;/artifactId&gt;
   &lt;/dependency&gt;
 &lt;!--校验框架 实现--&gt;
   &lt;dependency&gt;
     &lt;groupId&gt;org.hibernate.validator&lt;/groupId&gt;
     &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;
   &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.config;

import lombok.Data;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.convert.DataSizeUnit;
import org.springframework.boot.convert.DurationUnit;
import org.springframework.stereotype.Component;
import org.springframework.util.unit.DataSize;
import org.springframework.util.unit.DataUnit;
import org.springframework.validation.annotation.Validated;

import javax.validation.constraints.Max;
import javax.validation.constraints.Min;
import javax.validation.constraints.NotEmpty;
import java.time.Duration;
import java.time.temporal.ChronoUnit;


@Data
@ConfigurationProperties(prefix = "servers")  // 映射配置设置
@Validated      //2. 对Bean属性注入校验
public class ServertConfig {

    private String ipAddress;

    // 3. 设置规则
    @Max(value = 8888,message = "端口号不能超过 8888")
    @Min(value = 888,message = "端口号不能超过 888")
    //@NotEmpty
    private int port;

    private long timeout;

    @DurationUnit(ChronoUnit.HOURS)// 时间单位自定义
    private Duration serverTimeOut;

    @DataSizeUnit(DataUnit.GIGABYTES)// 数据存储单位自定义
    private DataSize dataSize;
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>



<h3 id="5-进制数据转换"><a href="#5-进制数据转换" class="headerlink" title="5. 进制数据转换"></a>5. 进制数据转换</h3><ul>
<li>报错: 密码错误</li>
</ul>
<div class="tabs" id="application.yml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#application.yml-1">application.yml</button></li><li class="tab"><button type="button" data-href="#application.yml-2">application.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="application.yml-1"><pre class="line-numbers language-none"><code class="language-none">datasource:
  driverClassName: com.mysql.jdbc.Driver
  password: 0127<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.yml-2"><pre class="line-numbers language-none"><code class="language-none">@SpringBootTest
class application{

  @Value("${datasource.password}")
  private String password;

  @Test 
  void contextLoads(){
    System.out.println(password);  // 输出值: 87
  }

}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<ul>
<li>原因:</li>
</ul>
<ul>
<li><ol>
<li>String 类型接收的 password</li>
</ol>
</li>
<li><ol start="2">
<li>datasource.password: 0127 。 为0 开头的8进制 且只有数字，没有用”” 束缚。 编译为十进制为:87</li>
</ol>
</li>
</ul>
<h3 id="6-测试"><a href="#6-测试" class="headerlink" title="6. 测试"></a>6. 测试</h3><h4 id="1-加载测试专用属性"><a href="#1-加载测试专用属性" class="headerlink" title="1. 加载测试专用属性"></a>1. 加载测试专用属性</h4><div class="tabs" id="application.yml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#application.yml-1">application.yml</button></li><li class="tab"><button type="button" data-href="#application.yml-2">PropertiesAndArgsTest.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="application.yml-1"><pre class="line-numbers language-none"><code class="language-none">test:
  prop: testValue<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.yml-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag;

import org.junit.Test;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.test.context.SpringBootTest;

//@SpringBootTest(properties = {"test.prop=testValue1"}) // 添加临时的数组属性
@SpringBootTest(properties = {"test.prop=testValue1"},args = {"--test.prop=testValue2"})
public class PropertiesAndArgsTest {
    @Value("${test.prop}")
    private String msg;

    @Test
    public void testProperties(){
        /* 2.7.x 层级权限 properties &gt; args
           2.5.x 层级权限 properties &lt; args
        */
        System.out.println(msg);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<h5 id="1-局部配置导入"><a href="#1-局部配置导入" class="headerlink" title="1. 局部配置导入"></a>1. 局部配置导入</h5><div class="tabs" id="msgconfig.java"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#msgconfig.java-1">MsgConfig.java</button></li><li class="tab"><button type="button" data-href="#msgconfig.java-2">ConfigurationTest.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="msgconfig.java-1"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class MsgConfig {

    @Bean
    public String msg(){
        return "bean msg";
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="msgconfig.java-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag;

import org.junit.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.context.annotation.Import;
import top.wabisabifag.config.MsgConfig;

@SpringBootTest
@Import({MsgConfig.class})   // 加载当前测试类专用的配置
public class ConfigurationTest {

    @Autowired
    private String msg;

    @Test
    public void testConfiguration(){
        System.out.println(msg);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<ul>
<li>加载测试临时属性应用于小范围测试环境</li>
</ul>
<h4 id="2-Web-环境模拟测试"><a href="#2-Web-环境模拟测试" class="headerlink" title="2. Web 环境模拟测试"></a>2. Web 环境模拟测试</h4><div class="tabs" id="bookcontroller.java"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#bookcontroller.java-1">BookController.java</button></li><li class="tab"><button type="button" data-href="#bookcontroller.java-2">WebTest.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="bookcontroller.java-1"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.controller;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping("/books")
public class BookController {
    @GetMapping
    public String getById(){
        System.out.println("getById is running ...");
        return "springboot";
    }
    
    /*json 数据的响应体*/
    @GetMapping
    @ResponseBody
    public String finall(){
        return "{\"name\" : Web测试成功}";
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="bookcontroller.java-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag;

import org.junit.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.mock.web.MockServletContext;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.ResultActions;
import org.springframework.test.web.servlet.ResultMatcher;
import org.springframework.test.web.servlet.request.MockHttpServletRequestBuilder;
import org.springframework.test.web.servlet.request.MockMvcRequestBuilders;
import org.springframework.test.web.servlet.result.ContentResultMatchers;
import org.springframework.test.web.servlet.result.HeaderResultMatchers;
import org.springframework.test.web.servlet.result.MockMvcResultMatchers;
import org.springframework.test.web.servlet.result.StatusResultMatchers;

// 模拟端口启动Web 环境===&gt; 随机端口
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT,classes = {MockServletContext.class })
// 虚拟调用MVC 注解
@AutoConfigureMockMvc
public class WebTest {
    // 引入MockMvc类型对象
    @Autowired
    private MockMvc mvc;

    // 调用 MockMvc 执行Controller 层功能
    @Test
    public void testWeb() throws Exception {

        MockHttpServletRequestBuilder builder = MockMvcRequestBuilders.get("/books");
        // 执行对应请求
        ResultActions actions = mvc.perform(builder);
    }

    @Test
    public void testStatus() throws Exception {
        /*http://localhost:8080/books 创建虚拟请求，当前访问  /books */
        MockHttpServletRequestBuilder builder = MockMvcRequestBuilders.get("/books");
        /*这里需要抛出异常    获取返回值*/
        ResultActions actions = mvc.perform(builder);

        /*1 .status()响应状态 匹配*/
        // 定义本次调用的预期值
        StatusResultMatchers status = MockMvcResultMatchers.status();
        // 预计本次调用时成功的状态: 200
        ResultMatcher ok = status.isOk();
        // 添加预期值到本次调用过程中进行匹配
        actions.andExpect(ok);

        /*2 .content()响应体 匹配*/
        ContentResultMatchers content = MockMvcResultMatchers.content();
            /* 1. content.string*/
        ResultMatcher stringData = content.string("Web测试成功");
        actions.andExpect(stringData);
            /* 2. content.json*/
        ResultMatcher jsonData = content.json("{\"name\":Web测试成功}");// controller return 的结果
        actions.andExpect(jsonData);

        /*3 .header()响应头 匹配*/
        HeaderResultMatchers header = MockMvcResultMatchers.header();
        ResultMatcher contentType = header.string("Content-Type", "text/plain;charset=UTF-8");
        actions.andExpect(contentType);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<h4 id="3-业务层数据测试事物回滚"><a href="#3-业务层数据测试事物回滚" class="headerlink" title="3. 业务层数据测试事物回滚"></a>3. 业务层数据测试事物回滚</h4><div class="tabs" id="application.yaml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#application.yaml-1">application.yaml</button></li><li class="tab"><button type="button" data-href="#application.yaml-2">Book.java</button></li><li class="tab"><button type="button" data-href="#application.yaml-3">BookDao.java</button></li><li class="tab"><button type="button" data-href="#application.yaml-4">BookService.java</button></li><li class="tab"><button type="button" data-href="#application.yaml-5">BookServiceImpl.java</button></li><li class="tab"><button type="button" data-href="#application.yaml-6">BookDaoTest.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="application.yaml-1"><pre class="line-numbers language-none"><code class="language-none">#在application.properties/或者application.yml文件中没有添加数据库配置信息.
#      url: jdbc:mysql://localhost:3306/smbms?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false

spring:
  datasource:
    druid:
      url: jdbc:mysql://localhost:3306/smbms
      username: root
      password: 123456
      driver-class-name: com.mysql.jdbc.Driver

#配置MP相关数据库名称
mybatis-plus:
  configuration:
    # 日志
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      table-prefix: smbms_
      id-type: auto<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.yaml-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.domain;

import lombok.AllArgsConstructor;
import lombok.Data;

@Data
@AllArgsConstructor
public class Book {
    private int id;
    private String name;
    private String type;
    private String description;

}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.yaml-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.dao;

import com.baomidou.mybatisplus.core.mapper.BaseMapper;
import org.apache.ibatis.annotations.Mapper;
import top.wabisabifag.domain.Book;

@Mapper
public interface BookDao extends BaseMapper&lt;Book&gt; {
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.yaml-4"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service;

import top.wabisabifag.domain.Book;

public interface BookService {
    public boolean save(Book book);
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.yaml-5"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import top.wabisabifag.dao.BookDao;
import top.wabisabifag.domain.Book;
@Service
public class BookServiceImpl {
    @Autowired
    private BookDao bookDao;

    public boolean save(Book book){
        return bookDao.insert(book) &gt; 0;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.yaml-6"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag;

import org.junit.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.annotation.Rollback;
import org.springframework.transaction.annotation.Transactional;
import top.wabisabifag.domain.Book;
import top.wabisabifag.service.BookService;

@SpringBootTest
@Transactional    // 事务注解: 停止事务提交，自动回滚   [内涵 @Rollback(true)]
//@Rollback(false)   测试时，提交事物更改值
public class BookDaoTest {
    @Autowired
    private BookService bookService;

    @Test
    public void testSave(){
        Book book = new Book(1,"name","type","description");
        bookService.save(book);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<ul>
<li>不做数据留痕，不做垃圾数据，脏数据保存</li>
</ul>
<h4 id="4-测试用例数据设定"><a href="#4-测试用例数据设定" class="headerlink" title="4. 测试用例数据设定"></a>4. 测试用例数据设定</h4><h5 id="1-测试用例设定随机数据"><a href="#1-测试用例设定随机数据" class="headerlink" title="1.  测试用例设定随机数据"></a>1.  测试用例设定随机数据</h5><div class="tabs" id="application.yml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#application.yml-1">application.yml</button></li><li class="tab"><button type="button" data-href="#application.yml-2">BookCase.java</button></li><li class="tab"><button type="button" data-href="#application.yml-3">BookDaoTest.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="application.yml-1"><pre class="line-numbers language-none"><code class="language-none">#在application.properties/或者application.yml文件中没有添加数据库配置信息.
#      url: jdbc:mysql://localhost:3306/smbms?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false
spring:
  datasource:
    druid:
      url: jdbc:mysql://localhost:3306/smbms
      username: root
      password: 123456
      driver-class-name: com.mysql.jdbc.Driver

#配置MP相关数据库名称
mybatis-plus:
  configuration:
    # 日志
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      table-prefix: smbms_
      id-type: auto
# 测试用例设定随机数据
testcase:
  book:
    id: ${random.int(0,10)} # 自定义随机范围
    name: Wabisabifag${random.value}   # 数据可拼接
    uuid: ${random.uuid}
    publishTome: ${random.long}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.yml-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.domain;

import lombok.Data;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.stereotype.Component;

@Component
@Data
@ConfigurationProperties(prefix = "testcase.book")
public class BookCase {
    private int id;
    private String name;
    private String uuid;
    private long publishTime;
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.yml-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag;

import org.junit.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import top.wabisabifag.domain.BookCase;

@SpringBootTest
public class BookDaoTest {

    @Autowired
    private BookCase bookCase;

    public void testBookCase(){
        System.out.println(bookCase);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>



<h3 id="7-数据层解决方案"><a href="#7-数据层解决方案" class="headerlink" title="7. 数据层解决方案"></a>7. 数据层解决方案</h3><h4 id="1-SQL"><a href="#1-SQL" class="headerlink" title="1. SQL"></a>1. SQL</h4><p>数据层解决方案:</p>
<p>数据源       持久化         数据库</p>
<p>Druid       MyBatis-Plus    MySql</p>
<p>Hikari      MyBatis           H2</p>
<pre><code>        JDBCTemplate
</code></pre>
<h5 id="1-数据源配置-DruidDataSource"><a href="#1-数据源配置-DruidDataSource" class="headerlink" title="1. 数据源配置(DruidDataSource)"></a>1. 数据源配置(DruidDataSource)</h5><ul>
<li>SpringBoot提供的3种内嵌的数据源对象</li>
</ul>
<ul>
<li>HiKariCP</li>
<li>Tomcat 提供 DataSource</li>
<li>Commons DBCP<pre class="line-numbers language-none"><code class="language-none">spring:
  datasource:
    url: jdbc:mysql://localhost:3306/smbms
      # 进一步配置  hikari、 tomcat 、dbcp2  数据实现
      hikari:
        username: root
        password: 123456
        driver-class-name: com.mysql.jdbc.Driver
        maximum-pool-size: 50  # 最大连接池数量<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h5 id="2-数据持久化-jdbcTemplate"><a href="#2-数据持久化-jdbcTemplate" class="headerlink" title="2. 数据持久化(jdbcTemplate)"></a>2. 数据持久化(jdbcTemplate)</h5><h6 id="1-JDBCTemplate-配置"><a href="#1-JDBCTemplate-配置" class="headerlink" title="1. JDBCTemplate 配置"></a>1. JDBCTemplate 配置</h6><pre class="line-numbers language-none"><code class="language-none">spring:
  jdbc:
    template:
      query-timeout: -1   # 查询超时时间
      max-rows: 500       # 最大行数
      fetch-size: -1      # 批处理数量<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="3-数据库-MySQL"><a href="#3-数据库-MySQL" class="headerlink" title="3. 数据库(MySQL)"></a>3. 数据库(MySQL)</h5><ul>
<li>SpringBoot提供的3种内嵌的数据库</li>
<li>内存级别数据库: 基于Java开发，可以在内存中启动运行，方便测试</li>
</ul>
<ul>
<li>H2</li>
<li>HSQL</li>
<li>Derby</li>
</ul>
<div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.yml</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--H2 数据库依赖--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.h2database&lt;/groupId&gt;
      &lt;artifactId&gt;h2&lt;/artifactId&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starte-data-jpa&lt;/artifactId&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starte-web-jpa&lt;/artifactId&gt;
    &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">#在application.properties/或者application.yml文件中没有添加数据库配置信息.
spring:
  # h2 数据库配置
  h2:
    console:
      path: /h2
      # 仅用于开发阶段 安全风险巨大
      enabled: true
  # H2 数据库初始化时需要配置数据源
  # 格式同页面提供的数据源样式
  datasource:
    druid:
      url: jdbc:h2:~/test
      username: root
      password: 123456
      # 可以省略, 设置后必须保证可访问
      driver-class-name: org.h2.Driver

# 配置服务器端口
server:
  port:
    80
  servlet:
    context-path: /<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<h6 id="1-访问H2-数据库服务页面"><a href="#1-访问H2-数据库服务页面" class="headerlink" title="1. 访问H2 数据库服务页面"></a>1. 访问H2 数据库服务页面</h6><ul>
<li>localhost://h2</li>
</ul>
<h4 id="2-NoSQL"><a href="#2-NoSQL" class="headerlink" title="2. NoSQL"></a>2. NoSQL</h4><ul>
<li>主要常见的NoSQL 解决方案 (常在Linux 系统中部署安装)</li>
</ul>
<h5 id="1-Redis"><a href="#1-Redis" class="headerlink" title="1. Redis"></a>1. Redis</h5><ul>
<li><a href="https://github.com/tporadowski/redis/releases">Redis</a> 是一款 Key-Value 存储结构的内存级 NoSQL 数据库<ul>
<li>支持多种数据存储格式</li>
<li>支持持久化</li>
<li>支持集群</li>
</ul>
</li>
</ul>
<h6 id="1-Redis基础操作"><a href="#1-Redis基础操作" class="headerlink" title="1. Redis基础操作"></a>1. Redis基础操作</h6><ul>
<li><p>启动安装</p>
  <pre class="line-numbers language-none"><code class="language-none"># 服务端启动命令   声明参数
redis-sercer.exe   redis.windows.conf
(如果服务端无法启动，先执行客服端启动命令。这里shutdown就是为了关闭这个版本的redis默认创建的服务，服务可以在任务管理中找到)

# 客服端启动命令
redis-cli.exe
shutdown    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>Redis 存储获取 值</p>
  <pre class="line-numbers language-none"><code class="language-none"># 存储  key      value
  set   name     wabisabifag

# 获取
  get   name

# 查询所有数值
  keys  *

# 清屏
  clear

# 设置多个嵌套值
hset keya a1 aa1
hset keya a2 aa2
hget keya a1         # "aa1"
hget keya a2         # "aa2"
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h6 id="2-Redis整合"><a href="#2-Redis整合" class="headerlink" title="2. Redis整合"></a>2. Redis整合</h6><div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.yml</button></li><li class="tab"><button type="button" data-href="#pom.xml-3">Application.java</button></li><li class="tab"><button type="button" data-href="#pom.xml-4">MyRedisConfig.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;dependencies&gt;
        &lt;!--Nosql整合数据库--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
        &lt;/dependency&gt;

&lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">spring:
  redis:
    host: localhost
    port: 6379<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.data.redis.core.ValueOperations;

@SpringBootTest
public class Application {

   // 以对象作为操作的基本单元

    @Autowired
    // 客服端 : RedisTemplate 以对象作为Key 和 Value，内部对数据进行序列化 操作
    private RedisTemplate redisTemplate;

    @Autowired
    private StringRedisTemplate stringRedisTemplate; // 以字符串 操作的基本单元

    @Test
    public void setRedisTemplate(){
        ValueOperations ops = redisTemplate.opsForValue();
        ops.set("age",42);
    }
    @Test
    public void getRedisTemplate(){
        ValueOperations ops = redisTemplate.opsForValue();
        Object age = ops.get("age");
        System.out.println(age);     //  空值
    }

    @Test
    public void getStringRedisTemplate(){
        ValueOperations&lt;String,String&gt; ops = stringRedisTemplate.opsForValue();
        String age = ops.get("age");
        System.out.println(age);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-4"><pre class="line-numbers language-none"><code class="language-none">import java.text.SimpleDateFormat;
import java.util.TimeZone;

@Configuration
public class MyRedisConfig {
    @Resource
    private RedisConnectionFactory factory;

    @Bean
    public RedisTemplate redisTemplate(){
        RedisTemplate&lt;String,Object&gt; redisTemplate = new RedisTemplate&lt;&gt;();
        redisTemplate.setConnectionFactory(factory);
        redisTemplate.setKeySerializer(new StringRedisSerializer());

        // String 类型序列化 json
        Jackson2JsonRedisSerializer&lt;Object&gt; serializer = new Jackson2JsonRedisSerializer&lt;&gt;(Object.class);
        redisTemplate.setValueSerializer(serializer);

        ObjectMapper om = new ObjectMapper();
        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);
        om.setDateFormat(new SimpleDateFormat("yyyy-MM-dd HH:mm:ss"));
                om.setTimeZone(TimeZone.getDefault());
        om.configure(MapperFeature.USE_ANNOTATIONS, false);
        om.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);
        om.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, false);
        om.activateDefaultTyping(LaissezFaireSubTypeValidator.instance
                ,ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY);
        om.setSerializationInclusion(JsonInclude.Include.NON_NULL);
        serializer.setObjectMapper(om);

        return redisTemplate;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<ul>
<li>客服端 : RedisTemplate 以对象作为Key 和 Value，内部对数据进行序列化 操作</li>
</ul>
<h6 id="3-jedis-客户端实现技术切换"><a href="#3-jedis-客户端实现技术切换" class="headerlink" title="3. jedis 客户端实现技术切换"></a>3. jedis 客户端实现技术切换</h6><div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.yml</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--jedis--&gt;
       &lt;dependency&gt;
           &lt;groupId&gt;redis.clients&lt;/groupId&gt;
           &lt;artifactId&gt;jedis&lt;/artifactId&gt;
       &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">spring:
  redis:
    host: localhost
    port: 6379
    client-type: jedis
    
    lettuce:
      pool:
        max-active: 16
        
    jedis:
      pool:
        max-active: 16<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<ul>
<li><p>lettcus 与 jedis 区别</p>
<ul>
<li><p>jedis 连接 Redis 服务器是直连模式，当线程模式下使用 jedis 会存在线程安全问题，解决方案通过配置连接池使每个连接专用，这样整体性能就大受影响。</p>
</li>
<li><p>lettcus 基于 Netty 框架进行与 Redis 服务器连接，底层设计采用 StatefulRedisConnection。StatefulRedisConnection 自身是线程安全的，可以保障并发访问安全问题，所以一个连接可以被多线程复用。当然 lettcus 也支持多连接实例一起工作。</p>
</li>
</ul>
</li>
</ul>
<h5 id="2-Mongo"><a href="#2-Mongo" class="headerlink" title="2. Mongo"></a>2. Mongo</h5><h6 id="1-MongoDB-特性"><a href="#1-MongoDB-特性" class="headerlink" title="1. MongoDB 特性"></a>1. MongoDB 特性</h6><ul>
<li>MongoDB 开源，高性能，无模式的文档型数据库</li>
</ul>
<h6 id="2-Mysql-Redis-弊端"><a href="#2-Mysql-Redis-弊端" class="headerlink" title="2. Mysql Redis 弊端"></a>2. Mysql Redis 弊端</h6><ul>
<li><p>Mysql</p>
<ul>
<li>有 结构化数据, 较低的响应需求</li>
</ul>
</li>
<li><p>Redis</p>
<ul>
<li>无 结构化数据, 较高的响应需求</li>
</ul>
</li>
</ul>
<h6 id="3-数据分析"><a href="#3-数据分析" class="headerlink" title="3. 数据分析"></a>3. 数据分析</h6><ul>
<li>用户数据: 永久性存储，修改频度极低</li>
<li>游戏数据: 永久性存储和临时性存储结合，修改频度较高</li>
<li>直播数据: 永久性存储和临时性存储结合，修改频度极高</li>
<li>物联网数据: 临时性存储, 修改频率飞速</li>
</ul>
<h6 id="4-Mongo-运行"><a href="#4-Mongo-运行" class="headerlink" title="4. Mongo 运行"></a>4. Mongo 运行</h6><pre class="line-numbers language-none"><code class="language-none"># 手动创建 ..\data\db 文件夹
mongod --dbpath=..\data\db

# 运行客服端   自定义参数
mongo --host=127.0.0.1 --port=27017<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/../JavaEE/2.png" alt="MongoDB基础"></p>
<h6 id="5-Mongo-整合"><a href="#5-Mongo-整合" class="headerlink" title="5. Mongo 整合"></a>5. Mongo 整合</h6><div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.yml</button></li><li class="tab"><button type="button" data-href="#pom.xml-3">Application.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--MongoDB 整合--&gt;
       &lt;dependency&gt;
           &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
           &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;/artifactId&gt;
           &lt;version&gt;3.1.2&lt;/version&gt;
       &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">spring:
  datasource:
    mongodb:
      uri: mongodb://localhost/wabisabifag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.data.mongodb.core.MongoTemplate;

import java.awt.print.Book;

@SpringBootTest
public class Application {
    @Autowired
    private MongoTemplate mongoTemplate;

    @Test
    public void setMongoTemplate(){
        Book book = new Book(1,"spring","spring","spring");
        mongoTemplate.save(book);
    }    
    
    @Test 
    public void find(){
        List&lt;Book&gt; all = mongoTemplate.findAll(Book.class);
        System.out.println(all);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>


<h5 id="3-ES"><a href="#3-ES" class="headerlink" title="3. ES"></a>3. ES</h5><ul>
<li><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.elastic.co/cn/downloads/elasticsearch">Elasticsearch</a> 是一个分布式全文搜索引擎</p>
</li>
<li><p>端口号: 9200</p>
</li>
</ul>
<h6 id="1-索引操作"><a href="#1-索引操作" class="headerlink" title="1. 索引操作"></a>1. 索引操作</h6><ul>
<li>幂等性，指的是相同参数下，一次请求和多次请求的结果是相等的<ul>
<li>get,put,delete请求都是幂等的</li>
</ul>
</li>
</ul>
<ol>
<li><a href="https://github.com/medcl/elasticsearch-analysis-ik">IK分词器 (Elasticsearch 放入插件文件夹)</a></li>
</ol>
<h6 id="2-文档操作"><a href="#2-文档操作" class="headerlink" title="2. 文档操作"></a>2. 文档操作</h6><p>以下内容在 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.postman.com/downloads/">postman</a> 中执行</p>
<ol>
<li>数据生成</li>
</ol>
<ul>
<li>post 生成指定id     <a target="_blank" rel="noopener external nofollow noreferrer" href="http://localhost:9200/bools/_create">http://localhost:9200/bools/_create</a></li>
<li>post 生成随机id     <a target="_blank" rel="noopener external nofollow noreferrer" href="http://localhost:9200/bools/_doc">http://localhost:9200/bools/_doc</a></li>
<li>post 生成指定id     <a target="_blank" rel="noopener external nofollow noreferrer" href="http://localhost:9200/bools/_doc/1">http://localhost:9200/bools/_doc/1</a><ul>
<li>body   {“id”:1,”name”:”spring”,”type”:”spring”,”description”:”spring”}</li>
</ul>
</li>
</ul>
<ol start="2">
<li>数据 id 查询</li>
</ol>
<ul>
<li>get 查询指定id      <a target="_blank" rel="noopener external nofollow noreferrer" href="http://localhost:9200/bools/_doc/1">http://localhost:9200/bools/_doc/1</a></li>
<li>get 查询所有id      <a target="_blank" rel="noopener external nofollow noreferrer" href="http://localhost:9200/bools/_search">http://localhost:9200/bools/_search</a></li>
</ul>
<ol start="3">
<li>数据 条件 查询</li>
</ol>
<ul>
<li>get 查询指定条件     <a target="_blank" rel="noopener external nofollow noreferrer" href="http://localhost:9200/bools/_search?q=name:spring">http://localhost:9200/bools/_search?q=name:spring</a></li>
</ul>
<ol start="4">
<li>数据 id 删除</li>
</ol>
<ul>
<li>delete 删除指定id    <a target="_blank" rel="noopener external nofollow noreferrer" href="http://localhost:9200/bools/_doc/1">http://localhost:9200/bools/_doc/1</a></li>
</ul>
<ol start="5">
<li>数据 id 修改</li>
</ol>
<ul>
<li>put 修改指定id 全部数据       <a target="_blank" rel="noopener external nofollow noreferrer" href="http://localhost:9200/bools/_doc/1">http://localhost:9200/bools/_doc/1</a></li>
<li>post 修改指定id 指定数据      <a target="_blank" rel="noopener external nofollow noreferrer" href="http://localhost:9200/bools/_update/1">http://localhost:9200/bools/_update/1</a><ul>
<li>body   {“doc”:{“name”:”springboot”} }</li>
</ul>
</li>
</ul>
<h6 id="3-Elasticsearch-整合"><a href="#3-Elasticsearch-整合" class="headerlink" title="3. Elasticsearch 整合"></a>3. Elasticsearch 整合</h6><ol>
<li>Low level</li>
</ol>
<div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.yml</button></li><li class="tab"><button type="button" data-href="#pom.xml-3">Application.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--elasticsearch 整合--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-data-elasticsearch&lt;/artifactId&gt;
        &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">spring:
  datasource:
    druid:
      url: jdbc:mysql://localhost:3306/smbms
      username: root
      password: 123456
      driver-class-name: com.mysql.jdbc.Driver
  elasticsearch:
    rest:
      uris: http://localhost:9200

mybatis-plus:
  configuration:
    # 日志
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      table-prefix: smbms_
      id-type: auto<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.data.elasticsearch.core.ElasticsearchRestTemplate;

import java.awt.print.Book;
import java.util.List;

@SpringBootTest
public class Application {

    @Autowired
    private ElasticsearchRestTemplate template;

    @Test
    public void fn(){
        template.get(new Book(1,"a","a","a"));
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>


<ol start="2">
<li>Hight level (方法过时，已经有新的整合内容 ===》》 application.yml 配置参数)</li>
</ol>
<div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">Application.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--elasticsearch 整合--&gt;
    &lt;dependency&gt;
          &lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt;
          &lt;artifactId&gt;elasticsearch-rest-high-level-client&lt;/artifactId&gt;
    &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag;

import org.apache.http.HttpHost;
import org.elasticsearch.client.RequestOptions;
import org.elasticsearch.client.RestClient;
import org.elasticsearch.client.RestClientBuilder;
import org.elasticsearch.client.RestHighLevelClient;
import org.elasticsearch.client.indices.CreateIndexRequest;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.data.elasticsearch.core.ElasticsearchRestTemplate;

import java.awt.print.Book;
import java.io.IOException;
import java.util.List;

@SpringBootTest
public class Application {

    @Autowired
    private RestHighLevelClient client;

    @BeforeEach
    void setUp(){
        this.client = new RestHighLevelClient(RestClient.builder(HttpHost.create("http://localhost:9200")));
    }
    
    @AfterEach
    void tearDown() throws IOException{
        this.client.close();
    }

    @Test
    public void testCreateClient(){

        &lt;!-- // 创建客服端
        HttpHost host = HttpHost.create("http://localhost:9200");
        RestClientBuilder builder = RestClient.builder(host);
        client = new RestHighLevelClient(builder);

        // 发送请求 名叫books的索引
        CreateIndexRequest request = new CreateIndexRequest("books");
        client.indices().create(request, RequestOptions.DEFAULT);

        client.close(); --&gt;
        
        CreateIndexRequest request = new CreateIndexRequest("books");
        client.indices().create(request, RequestOptions.DEFAULT);
        
    }
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>


<h6 id="4-分词器-和-创建索引属性"><a href="#4-分词器-和-创建索引属性" class="headerlink" title="4. 分词器 和 创建索引属性"></a>4. 分词器 和 创建索引属性</h6><div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">Application.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--String 转换为 json--&gt;
       &lt;dependency&gt;
           &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
           &lt;artifactId&gt;fastjson&lt;/artifactId&gt;
           &lt;version&gt;1.2.78&lt;/version&gt;
       &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">@SpringBootTest
public class Application {

    /* 创建索引*/
    @Test
    public void testCreateIndex() throws IOException{
        CreateIndexRequest request = new CreateIndexRequest("books");
      
        client.indices().create(request,RequestOptions.DEFAULT);
    }
    /* 创建索引 By IK*/
    @Test
    public void testCreateIndexByIK() throws IOException{
        CreateIndexRequest request = new CreateIndexRequest("books");
        String json = "";
        // 设置请求中的参数
        request.source(json, XContentType.JSON);
        client.indices().create(request,RequestOptions.DEFAULT);
    }

    /* 添加文档 */
    @Test
    public void testCreateDoc() throws IOException{
        /* 1.查询单个id */
        Book book = bookDao.selectByID(1);
        IndexRequest request = new IndexRequest("books").id(book.getId().toString());
        /* fastjson 依赖: 对象转化为 json*/
        String json = JSON.toJSONString(book);
        request.source(json,XContentType.JSON);
        client.index(request,RequestOptions.DEFAULT);

        /* 2. 查询所有id*/
        List&lt;Book&gt; bookList = bookDao.selectList(null);
        /* 批处理请求 */
        BulkRequest request = new BulkRequest();

        for (Book book : bookList) {
            IndexRequest request = new IndexRequest("books").id(book.getId().toString());
            String json = JSON.toJSONString(book);
            request.source(json,XContentType.JSON);
            request.add(request);
        }

        client.bulk(request,RequestOptions.DEFAULT);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>


<h3 id="8-整合第三方技术"><a href="#8-整合第三方技术" class="headerlink" title="8. 整合第三方技术"></a>8. 整合第三方技术</h3><h4 id="1-缓存-部分过时，以最新为主，自行理解"><a href="#1-缓存-部分过时，以最新为主，自行理解" class="headerlink" title="1. 缓存 (部分过时，以最新为主，自行理解)"></a>1. 缓存 (部分过时，以最新为主，自行理解)</h4><ul>
<li>一种介质于数据永久存储介质可数据应用之间的数据临时存储介质</li>
<li>缓存可减少低速数据速过程的次数，提高系统性能。如：磁盘IO，</li>
<li>提高永久性存储介质的数据读取效率，提供临时数据存储空间</li>
<li>SpringBoot 提供其他缓存技术整合，统一接口，方便缓存技术开发管理<ul>
<li>Generic</li>
<li>JCache</li>
</ul>
<ul>
<li>Ehcache</li>
</ul>
<ul>
<li>Hazelcast</li>
<li>infinispan</li>
<li>Couchbase</li>
</ul>
<ul>
<li>Redis</li>
</ul>
<ul>
<li>Caffenine</li>
<li>Simple  (内存级 默认)</li>
</ul>
<ul>
<li>memcached</li>
</ul>
<ul>
<li>jetcache  (阿里)</li>
<li>j2cache</li>
</ul>
</li>
</ul>
<h5 id="1-模拟缓存"><a href="#1-模拟缓存" class="headerlink" title="1. 模拟缓存"></a>1. 模拟缓存</h5><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import top.wabisabifag.dao.BookDao;
import top.wabisabifag.domain.Book;

import java.util.HashMap;

@Service
public class BookServiceImpl {
    @Autowired
    private BookDao bookDao;
    /* 对应缓存 */
    private HashMap&lt;Integer,Book&gt; cache = new HashMap&lt;Integer, Book&gt;();
    
    public Book getById(Integer id){
        /* 缓存中没有本次查询数据，访问数据库*/
        Book book = cache.get(id);
        if(book == null){
            Book queryBook = bookDao.selectById(id);
            cache.put(id,queryBook);
            return queryBook;
        }
        return cache.get(id);
    }


    public boolean save(Book book){
        return bookDao.insert(book) &gt; 0;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="2-模拟验证"><a href="#2-模拟验证" class="headerlink" title="2. 模拟验证"></a>2. 模拟验证</h5><div class="tabs" id="msgserviceimpl.java"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#msgserviceimpl.java-1">MsgServiceImpl.java</button></li><li class="tab"><button type="button" data-href="#msgserviceimpl.java-2">MsgControll.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="msgserviceimpl.java-1"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl;

import top.wabisabifag.service.MsgService;

import java.util.HashMap;

public class MsgServiceImpl implements MsgService {
    private HashMap&lt;String,String&gt; cache = new HashMap&lt;String,String&gt;();

    @Override
    public String get(String tele) {
        /* 获取后6位数据*/
        String code = tele.substring(tele.length() - 6);
        cache.put(tele,code);
        return code;
    }

    @Override
    public boolean check(String tele, String code) {
        String queryCode = cache.get(tele);
        return code.equals(queryCode);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="msgserviceimpl.java-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.config;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;
import top.wabisabifag.service.MsgService;

@RestController
@RequestMapping("/msg")
public class MsgControll {
    @Autowired
    private MsgService msgService;

    @GetMapping("{tele}")
    public String get(@PathVariable String tele){
        return  msgService.get(tele);
    }

    @GetMapping
    public boolean check(String tele,String code){
        return msgService.check(tele, code);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>


<h5 id="3-SpringBoot-缓存"><a href="#3-SpringBoot-缓存" class="headerlink" title="3. SpringBoot 缓存"></a>3. SpringBoot 缓存</h5><div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.java</button></li><li class="tab"><button type="button" data-href="#pom.xml-3">BookServiceImpl.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none"> &lt;!--SpringBoot 缓存--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starter-cache&lt;/artifactId&gt;
      &lt;version&gt;1.2.78&lt;/version&gt;
    &lt;/dependency&gt;
&lt;!--Nosql整合数据库--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;
    &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag;

import org.mybatis.spring.annotation.MapperScan;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.context.annotation.ComponentScan;

@SpringBootApplication
@MapperScan("top.wabisabifag.dao") /*使用@MapperScan可以指定要扫描的Mapper类的包的路径*/
@ComponentScan(basePackages={"top.wabisabifag"})
@EnableCaching       /* 开启缓存*/
public class application {
    public static void main(String[] args) {
        // 线程安全问题
        SpringApplication.run(application.class,args);
        // 不接受外部临时参数
        SpringApplication.run(application.class);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.cache.annotation.Cacheable;
import org.springframework.stereotype.Service;
import top.wabisabifag.dao.BookDao;
import top.wabisabifag.domain.Book;

import java.util.HashMap;

@Service
public class BookServiceImpl {
  
    @Autowired
    private BookDao bookDao;

    @Override
    @Cacheable(value = "cacheSpace",key = "#id")
    public Book getById(Integer id){
        return bookDao.selectById(id);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>



<h5 id="4-模拟短信验证-Simple"><a href="#4-模拟短信验证-Simple" class="headerlink" title="4. 模拟短信验证(Simple)"></a>4. 模拟短信验证(Simple)</h5><div class="tabs" id="smscode.java"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#smscode.java-1">SMSCode.java</button></li><li class="tab"><button type="button" data-href="#smscode.java-2">SMSCodeService.java</button></li><li class="tab"><button type="button" data-href="#smscode.java-3">SMSCodeServiceImpl.java</button></li><li class="tab"><button type="button" data-href="#smscode.java-4">SMSCodeController.java</button></li><li class="tab"><button type="button" data-href="#smscode.java-5">CodeUtils.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="smscode.java-1"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.domain;

import lombok.Data;

@Data
public class SMSCode {
    private String tele;
    private String Code;
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="smscode.java-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service;

import top.wabisabifag.domain.SMSCode;

public interface SMSCodeService {
    public String sendCodeToSMS(String tele);
    public boolean checkCode(SMSCode smsCode);
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="smscode.java-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.cache.annotation.CachePut;
import org.springframework.cache.annotation.Cacheable;
import org.springframework.stereotype.Service;
import top.wabisabifag.domain.SMSCode;
import top.wabisabifag.service.SMSCodeService;
import top.wabisabifag.utils.CodeUtils;

@Service
public class SMSCodeServiceImpl implements SMSCodeService {

    @Autowired
    private CodeUtils codeUtils;

    @Override
    /*@Cacheable(value = "smsCode",key = "#tele") // 可以存放和读取，不适用于验证码重新获取*/
    @CachePut(value = "smsCode",key = "#tele")
    public String sendCodeToSMS(String tele) {
        String code = codeUtils.generator(tele);
        return code;
    }

    @Override
    public boolean checkCode(SMSCode smsCode) {
        String code = smsCode.getCode();
        String cacheCode = codeUtils.get(smsCode.getTele());
        return code.equals(cacheCode);
    }

}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="smscode.java-4"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.config;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import top.wabisabifag.domain.SMSCode;
import top.wabisabifag.service.SMSCodeService;

@RestController
@RequestMapping("/sms")
public class SMSCodeController {

    @Autowired
    private SMSCodeService service;

    @GetMapping
    public String getCode(String tele){
        String code = service.sendCodeToSMS(tele);
        return code;
    }

    @PostMapping
    public boolean checkCode(SMSCode smsCode){
        return service.checkCode(smsCode);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="smscode.java-5"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.utils;

import org.springframework.cache.annotation.Cacheable;
import org.springframework.stereotype.Component;

@Component  /* 设置为bean，对方注解调用*/
public class CodeUtils {

    private String[] patch={"00000","0000","000","00","0",""};
    public String generator(String tele){
        /* 加密码 */
        int encryption = 20230929;
        int hash = tele.hashCode();
        long nowTime = System.currentTimeMillis();

        long result = hash ^ encryption;
        result = result ^ nowTime;

        /*
         *  问题
         *  1. 负数问题
         *  2. 前置位为 0 。如: 001233，输出: 1233问题
         */
        long code = result % 1000000;

        /* 防止负数*/
        code = code&lt;0 ? -code:code;

        /* 补零 */
        String codeString = code + "";
        int len = codeString.length();

        return patch[len-1]+codeString;
    }
    /* 该方法不放置于 ServiceImpl，就算有注解也被认为普通方法
    *   bean方法不能自我调用
    */
    @Cacheable(value = "smsCode",key = "#tele")
    public String get(String tele){
        return null;
    }

   /* *//* 功能验证*//*
    public static void main(String[] args) {
        System.out.println(new CodeUtils().generator("18866668888") );;
    }*/
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>



<h5 id="5-Ehcache-Redis-memcached-缓存统一接口配置"><a href="#5-Ehcache-Redis-memcached-缓存统一接口配置" class="headerlink" title="5. Ehcache Redis memcached 缓存统一接口配置"></a>5. Ehcache Redis memcached 缓存统一接口配置</h5><h6 id="1-Ehcache-Redis"><a href="#1-Ehcache-Redis" class="headerlink" title="1. Ehcache Redis"></a>1. Ehcache Redis</h6><div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-3">ehcache.xml</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--Ehcache 缓存--&gt;
   &lt;dependency&gt;
     &lt;groupId&gt;net.sf.ehcache&lt;/groupId&gt;
     &lt;artifactId&gt;ehcache&lt;/artifactId&gt;
   &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">// 统一接口
spring:
  # 配置缓存类型
  cache:

    # ehcache (文档配置)
    #type: ehcache
    #ehcache: ehcache.xml

    # redis  (yml配置)
    type: redis
    redis:
      host: localhost
      port: 6379
      use-key-prefix: true  # 是否使用前缀
      cache-null-values: false  # 是否缓存空值
      key-prefix: sms_    # 指定前缀
      time-to-live: # 活动时间

  datasource:
    druid:
      url: jdbc:mysql://localhost:3306/smbms
      username: root
      password: 123456
      driver-class-name: com.mysql.jdbc.Driver
  elasticsearch:
    rest:
      uris: http://localhost:9200<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-3"><pre class="line-numbers language-none"><code class="language-none">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:noNamespaceSchemaLocation="http://ehcache.org/ehcache.xsd"
        updateCheck="false" name="defaultCache"&gt;

    &lt;!--
       diskStore：为缓存路径，ehcache分为内存和磁盘两级，此属性定义磁盘的缓存位置,可以自定义目录，确保用户有权限即可。参数解释如下：
       user.home – 用户主目录
       user.dir  – 用户当前工作目录
       java.io.tmpdir – 默认临时文件路径
     --&gt;
    &lt;!--    &lt;diskStore path="java.io.tmpdir"/&gt; --&gt;
    &lt;diskStore path="C:/Users/admin/ehcache/"/&gt;

    &lt;!-- maxElementsInMemory：内存中最大缓存对象数，根据服务器资源配置 --&gt;
    &lt;!-- eternal： 默认为false,设置true表示对象永不过期，此时会忽略timeToIdleSeconds和timeToLiveSeconds属性， --&gt;
    &lt;!-- maxElementsOnDisk：硬盘中最大缓存对象数，若是0表示无穷大 --&gt;
    &lt;!-- overflowToDisk：true表示当内存缓存的对象数目达到了maxElementsInMemory界限后，会把溢出的对象写到硬盘缓存中。
    注意：如果缓存的对象要写入到硬盘中的话，则该对象必须实现了Serializable接口才行。--&gt;
    &lt;!-- diskSpoolBufferSizeMB：磁盘缓存区大小，默认为30MB。每个Cache都应该有自己的一个缓存区。--&gt;
    &lt;!-- diskPersistent：是否缓存虚拟机重启期数据  --&gt;
    &lt;!-- diskExpiryThreadIntervalSeconds：磁盘失效线程运行时间间隔，默认为120秒 --&gt;

    &lt;!-- timeToIdleSeconds： 设定允许对象处于空闲状态的最长时间，单位（秒）。自对象最近一次被访问后，
    空闲时间超过了timeToIdleSeconds属性值，这个对象就会过期，如果该属性值为0，则对象无限期地处于空闲状态
    EHCache将把它从缓存中清空。只有当eternal属性为false，该属性才有效。
    --&gt;

    &lt;!-- timeToLiveSeconds：设定允许对象存在于缓存中的最长时间，单位（秒）。自对象被存放到缓存中后，
    在缓存中的时间超过了timeToLiveSeconds属性值，这个对象就会过期，如果该属性值为0，则对象无限期地存在于缓存中。
    EHCache将把它从缓存中清除。只有当eternal属性为false，该属性才有效。timeToLiveSeconds必须大于timeToIdleSeconds属性，才有意义 --&gt;

    &lt;!-- memoryStoreEvictionPolicy：当达到maxElementsInMemory限制时，Ehcache将会根据指定的策略去清理内存。
    可选策略有：LRU（最近最少使用，默认策略）、FIFO（先进先出）、LFU（最少访问次数）。--&gt;

    &lt;!-- 默认缓存 --&gt;
    &lt;defaultCache
            maxElementsInMemory="10000"
            eternal="false"
            overflowToDisk="false"
            diskSpoolBufferSizeMB="50"
            timeToIdleSeconds="300"
            timeToLiveSeconds="600"
            maxElementsOnDisk="10000000"
            diskExpiryThreadIntervalSeconds="120"
            memoryStoreEvictionPolicy="LRU"&gt;

        &lt;persistence strategy="localTempSwap"/&gt;

    &lt;/defaultCache&gt;

    &lt;cache name="employee_all"
           maxElementsInMemory="100"
           eternal="false"
           overflowToDisk="true"
           timeToIdleSeconds="300"
           timeToLiveSeconds="600"
           memoryStoreEvictionPolicy="LRU"/&gt;

    &lt;cache name="employee_info"
           maxElementsInMemory="1000"
           eternal="false"
           overflowToDisk="true"
           timeToIdleSeconds="300"
           timeToLiveSeconds="600"
           memoryStoreEvictionPolicy="LRU"/&gt;

    &lt;!--设置缓存空间--&gt;
     &lt;cache name="smsCode"
           maxElementsInMemory="1000"
           eternal="false"
           overflowToDisk="true"
           timeToIdleSeconds="60"
           timeToLiveSeconds="60"
           memoryStoreEvictionPolicy="LRU"/&gt;

&lt;/ehcache&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>



<h6 id="2-memcached-缓存整合"><a href="#2-memcached-缓存整合" class="headerlink" title="2. memcached 缓存整合"></a>2. memcached 缓存整合</h6><ol>
<li>memcached 特性</li>
</ol>
<ul>
<li>memcached Client for Java: 最早期客服端，稳定，用户群广</li>
<li>SpyMemcached: 效率高</li>
<li>Xmemcached: 并发处理好</li>
<li>暂未被SpringBoot 整合，硬编码方式实现客服端初始化管理</li>
</ul>
<ol start="2">
<li>memcached 安装</li>
</ol>
<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.memcached.org/downloads">memcached</a></li>
<li>管理员权限 操作命令行:<ul>
<li>安装: memcached.exe -d install</li>
<li>启动: emcached.exe -d start</li>
<li>关闭: emcached.exe -d stop</li>
</ul>
</li>
</ul>
<div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">XMemcachedConfig.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-3">SMSCodeServiceImpl.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-4">application.yml</button></li><li class="tab"><button type="button" data-href="#pom.xml-5">pom.xml 5</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--memcached 缓存--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.googlecode&lt;/groupId&gt;
      &lt;artifactId&gt;xmemcached&lt;/artifactId&gt;
      &lt;version&gt;2.4.7&lt;/version&gt;
    &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">ppackage top.wabisabifag.config;

import org.springframework.context.annotation.Bean;

import java.io.IOException;

public class XMemcachedConfig {
    @Bean
    public MemcachedClient getMemcachedClient() throws IOException {
        MemcachedClientBuilder memcachedClientBuilder = new XMemcachedClientBuilder("localhost:11211");
        MemcachedClient memcachedClient = memcachedClientBuilder.build();
        return memcachedClient;
    }
}


&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;优&gt;&gt;&gt;&gt;&gt;化&gt;&gt;&gt;&gt;&gt;配&gt;&gt;&gt;&gt;&gt;&gt;置&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;

package top.wabisabifag.config;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import java.io.IOException;
@Configuration
public class XMemcachedConfig {
    @Autowired
    private XMemcachedProperties memcachedProperties;

    @Bean
    public MemcachedClient getMemcachedClient() throws IOException {
        MemcachedClientBuilder memcachedClientBuilder = new XMemcachedClientBuilder(memcachedProperties.getServers());
        memcachedProperties.setPoolSize(memcachedProperties.getPoolSize());
        memcachedProperties.setOpTimeout(memcachedProperties.getOpTimeout());
        MemcachedClient memcachedClient = memcachedClientBuilder.build();
        return memcachedClient;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.cache.annotation.CachePut;
import org.springframework.cache.annotation.Cacheable;
import org.springframework.stereotype.Service;
import top.wabisabifag.domain.SMSCode;
import top.wabisabifag.service.SMSCodeService;
import top.wabisabifag.utils.CodeUtils;

@Service
public class SMSCodeServiceImpl implements SMSCodeService {
    @Autowired
    private MemcachedClient memcachedClient;
    @Override
    public String sendCodeToSMS(String tele) {
        String code = codeUtils.generator(tele);
                      // key   有效时间   值
        memcachedClient.set(tele,0,code);
        return code;
    }

    @Override
    public boolean checkCode(SMSCode smsCode) {
        String code = memcachedClient.get(smsCode.getTele()).toString();
        return smsCode.getCode().equals(code);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-4"><pre class="line-numbers language-none"><code class="language-none">spring:
  # 配置缓存类型
  cache:
    # memcached
    servers: localhost:11211
    poolSize: 10
    opTimeout:  3000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-5"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.config;

import lombok.Data;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.stereotype.Component;

@Component
@ConfigurationProperties(prefix = "memcached")
@Data
public class XMemcachedProperties {
    private String servers;
    private int poolSize;
    private long opTimeout;
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>


<h5 id="6-jetCache"><a href="#6-jetCache" class="headerlink" title="6. jetCache"></a>6. jetCache</h5><h6 id="1-jetCache-特性"><a href="#1-jetCache-特性" class="headerlink" title="1. jetCache 特性"></a>1. jetCache 特性</h6><ul>
<li>jetCache 对 SpringCache 进行封装，原有基础上实现多级缓存，缓存统计，自动刷新，异步调用，数据报表等功能。</li>
<li>jetCache 设定本地缓存 和 远程缓存 的多级缓存解决方案<ul>
<li>本地缓存<ul>
<li>LinkedHashMap</li>
<li>Caffeine</li>
</ul>
</li>
<li>远程缓存<ul>
<li>Redis</li>
<li>Tair<br><img src="/../JavaEE/3.png" alt="jetCache yml配置文件值定意义"></li>
</ul>
</li>
</ul>
</li>
</ul>
<h6 id="2-整体部署-基础"><a href="#2-整体部署-基础" class="headerlink" title="2. 整体部署(基础)"></a>2. 整体部署(基础)</h6><div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.yml</button></li><li class="tab"><button type="button" data-href="#pom.xml-3">application.java</button></li><li class="tab"><button type="button" data-href="#pom.xml-4">Redis 远程方案</button></li><li class="tab"><button type="button" data-href="#pom.xml-5">本地方案</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--jetCache 阿里缓存整合方案--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.alicp.jetcache&lt;/groupId&gt;
      &lt;artifactId&gt;jetcache-starter-redis&lt;/artifactId&gt;
      &lt;version&gt;2.4.7&lt;/version&gt;
    &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">  # jetcache 阿里缓存配置
jetcache:
  # 每过 一段时间 在控制台上显示一段数据
  statIntervalMinutes: 15
  # 远程访问的 area 的名称 是否进入 缓存名中
  areaInCacheName: false
  # 本地
  local:
    default:
      type: linkedhashmap
      # 为方便对象转换为字符粗串：key必须为字符串
      keyConvertor: fastjson
      # 缓存的数据量
      limit: 100
  # 远程
  remote:
    default:
      type: redis
      host: localhost
      port: 6379
      # 为方便对象转换为字符粗串：key必须为字符串
      # jetCache 的方法缓存 注解方式时需要
      keyConvertor: fastjson
      valueEncoder: java
      valueDecoder: java
      # 初始化连接池
      poolConfig:
        minIdle: 5
        maxIdle: 20
        maxTotal: 50
    sms:
      type: redis
      host: localhost
      port: 6379
      poolConfig:
        maxTotal: 50<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag;

import org.mybatis.spring.annotation.MapperScan;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.context.annotation.ComponentScan;

@SpringBootApplication
/* jetCache 开关: 启用注解方式开启缓存*/
@EnableCreateCacheAnnotation
public class application {
    public static void main(String[] args) {

        // 线程安全问题
        SpringApplication.run(application.class,args);

        // 不接受外部临时参数
        SpringApplication.run(application.class);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-4"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.cache.annotation.CachePut;
import org.springframework.cache.annotation.Cacheable;
import org.springframework.stereotype.Service;
import top.wabisabifag.domain.SMSCode;
import top.wabisabifag.service.SMSCodeService;
import top.wabisabifag.utils.CodeUtils;

import java.util.concurrent.TimeUnit;

@Service
public class SMSCodeServiceImpl implements SMSCodeService {

    @Autowired
    private CodeUtils codeUtils;

    # 通过 area="sms"  调用远程缓存的自定义前缀
    @CreateCache(area="sms",name="jetCache",expire=3600,timeUnit= TimeUnit.SECONDS)
    private Cache&lt;String,String&gt; jetCache;
    @Override
    public String sendCodeToSMS(String tele) {
        String code = codeUtils.generator(tele);
        jetCache.put(tele,code);
        return code;
    }

    @Override
    public boolean checkCode(SMSCode smsCode) {
        String code = jetCache.get(smsCode.getTele());
        return smsCode.getCode().equals(code);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-5"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.cache.annotation.CachePut;
import org.springframework.cache.annotation.Cacheable;
import org.springframework.stereotype.Service;
import top.wabisabifag.domain.SMSCode;
import top.wabisabifag.service.SMSCodeService;
import top.wabisabifag.utils.CodeUtils;

import java.util.concurrent.TimeUnit;

@Service
public class SMSCodeServiceImpl implements SMSCodeService {

    @Autowired
    private CodeUtils codeUtils;

    # 设定缓存类型: 仅用 本地缓存
    @CreateCache(name="jetCache",expire=3600,timeUnit= TimeUnit.SECONDS,cacheType= CacheType.LOCAL)
    private Cache&lt;String,String&gt; jetCache;
    @Override
    public String sendCodeToSMS(String tele) {
        String code = codeUtils.generator(tele);
        jetCache.put(tele,code);
        return code;
    }

    @Override
    public boolean checkCode(SMSCode smsCode) {
        String code = jetCache.get(smsCode.getTele());
        return smsCode.getCode().equals(code);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>


<h6 id="3-jetCache-方法缓存-改动基础"><a href="#3-jetCache-方法缓存-改动基础" class="headerlink" title="3. jetCache 方法缓存(改动基础)"></a>3. jetCache 方法缓存(改动基础)</h6><div class="tabs" id="application.java"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#application.java-1">application.java</button></li><li class="tab"><button type="button" data-href="#application.java-2">Book.java</button></li><li class="tab"><button type="button" data-href="#application.java-3">jetCache远程方案</button></li><li class="tab"><button type="button" data-href="#application.java-4">jetCache本地方案</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="application.java-1"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag;

import org.mybatis.spring.annotation.MapperScan;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.context.annotation.ComponentScan;

@SpringBootApplication
/* jetCache 开关: 启用注解方式开启缓存*/
@EnableCreateCacheAnnotation

/* 开启注解缓存: 包名覆盖 */
@EnableMethodCache(basePackages = "top.wabisabifag")
public class application {
    public static void main(String[] args) {
        // 线程安全问题
        SpringApplication.run(application.class,args);
        // 不接受外部临时参数
        SpringApplication.run(application.class);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.java-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.domain;

import lombok.AllArgsConstructor;
import lombok.Data;

import java.io.Serializable;

@Data
@AllArgsConstructor
/* jetCache 缓存 Java 的对象时
    映入 Redis 库不支持。（ 序列化和反序列化问题*/
public class Book implements Serializable {
    private int id;
    private String name;
    private String type;
    private String description;
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.java-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.cache.annotation.Cacheable;
import org.springframework.stereotype.Service;
import top.wabisabifag.dao.BookDao;
import top.wabisabifag.domain.Book;

import java.util.HashMap;

@Service
public class BookServiceImpl {

    @Autowired
    private BookDao bookDao;

    /* 对应缓存 */
    private HashMap&lt;Integer,Book&gt; cache = new HashMap&lt;Integer, Book&gt;();

    @Override
    //@Cacheable(value = "cacheSpace",key = "#id")
    @Cached(name="book",key="#id",expire=3600)
    public Book getById(Integer id){
        return bookDao.selectById(id);
    }
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.java-4"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.cache.annotation.Cacheable;
import org.springframework.stereotype.Service;
import top.wabisabifag.dao.BookDao;
import top.wabisabifag.domain.Book;

import java.util.HashMap;

@Service
public class BookServiceImpl {

    @Autowired
    private BookDao bookDao;

    /* 对应缓存 */
    private HashMap&lt;Integer,Book&gt; cache = new HashMap&lt;Integer, Book&gt;();

    @Override
    /* 注入缓存注解*/
    @Cached(name="book",key="#id",expire=3600)
     /* 刷新: 内存和数据库内容不同步*/
    @CacheRefresh(refresh=10)
    public Book getById(Integer id){
        return bookDao.selectById(id);
    }

    @Override
    /* 更新缓存注解*/
    @CacheUpdate(name="book_",key="#book.id",value="#book")
    public boolean update(Book book){
        return bookDao.updateById(book)&gt;0;
    }

    @Override
    /* 删除缓存注解*/
    @CacheInvalidate(name="book_",key="#id",value="#book")
    public boolean update(Book book){
        return bookDao.updateById(book)&gt;0;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>



<h5 id="7-j2cache"><a href="#7-j2cache" class="headerlink" title="7. j2cache"></a>7. j2cache</h5><h6 id="1-j2cache-特性"><a href="#1-j2cache-特性" class="headerlink" title="1. j2cache 特性"></a>1. j2cache 特性</h6><ul>
<li>j2cache 是一个缓存整合框架，可提供缓存的整合方案，使用各种缓存搭配使用。(自身不提供缓存功能</li>
</ul>
<h6 id="2-j2cache-主要整合-Redis-Ehcache"><a href="#2-j2cache-主要整合-Redis-Ehcache" class="headerlink" title="2. j2cache (主要整合 Redis Ehcache)"></a>2. j2cache (主要整合 Redis Ehcache)</h6><div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.yml</button></li><li class="tab"><button type="button" data-href="#pom.xml-3">j2cache.properties</button></li><li class="tab"><button type="button" data-href="#pom.xml-4">ehcache.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-5">SMSCodeServiceImpl.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--j2Cache 核心--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;net-oschina.j2cache&lt;/groupId&gt;
      &lt;artifactId&gt;j2cache-core&lt;/artifactId&gt;
      &lt;version&gt;2.8.4-release&lt;/version&gt;
    &lt;/dependency&gt;

&lt;!--jetCache SpringBoot整合--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;net-oschina.j2cache&lt;/groupId&gt;
      &lt;artifactId&gt;j2cache-spring-boot2-starter&lt;/artifactId&gt;
      &lt;version&gt;2.8.0-release&lt;/version&gt;
    &lt;/dependency&gt;

&lt;!--Ehcache 缓存--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;net.sf.ehcache&lt;/groupId&gt;
      &lt;artifactId&gt;ehcache&lt;/artifactId&gt;
    &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">  # j2cache 整合
j2cache:
  # j2cache 配置文件名
  config-location: j2cache.properties<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-3"><pre class="line-numbers language-none"><code class="language-none"># 1级缓存
j2cache.L1.provider_class= ehcache
ehcache.configXml = ehcache.xml

# 是否开启二级缓存
j2cache.l2-cache-open = ture

# 1级缓存中的数据如何到达2级缓存:
#   广播方式，可以使用redis 提供的消息订阅模式，也可以使用jgroups多播实现
j2cache.broadcast = net.oschina.j2cache.cache.support.redis.SpringRedisPubSubPolicy

# 2级缓存
j2cache.L2.provider_class = net.oschina.j2cache.cache.support.redis.SpringRedisProvider
j2cache.L2.config_section = redis
redis.hosts = localhost:6379

redis.mode = single
redis.namespace =j2cache

##J2Cache configuration
##########################################
## Cache Broadcast Method
## values:
## jgroups -&gt; use jgroups's multicast
## redis -&gt; use redis publish/subscribe mechanism (using jedis)
## lettuce -&gt; use redis publish/subscribe mechanism (using lettuce, Recommend)
## rabbitmq -&gt; use RabbitMQ publisher/consumer mechanism
## rocketmq -&gt; use RocketMQ publisher/consumer mechanism
## none -&gt; don't notify the other nodes in cluster
## xx.xxxx.xxxx.Xxxxx your own cache broadcast policy classname that implement net.oschina.j2cache.cluster.ClusterPolicy
##########################################
#j2cache.broadcast = redis
#
## jgroups properties
#jgroups.channel.name = j2cache
#jgroups.configXml = /network.xml
#
## RabbitMQ properties
#rabbitmq.exchange = j2cache
#rabbitmq.host = localhost
#rabbitmq.port = 5672
#rabbitmq.username = guest
#rabbitmq.password = guest
#
## RocketMQ properties
#rocketmq.name = j2cache
#rocketmq.topic = j2cache
## use ; to split multi hosts
#rocketmq.hosts = 127.0.0.1:9876
#
##########################################
## Level 1&amp;2 provider
## values:
## none -&gt; disable this level cache
## ehcache -&gt; use ehcache2 as level 1 cache
## ehcache3 -&gt; use ehcache3 as level 1 cache
## caffeine -&gt; use caffeine as level 1 cache(only in memory)
## redis -&gt; use redis as level 2 cache (using jedis)
## lettuce -&gt; use redis as level 2 cache (using lettuce)
## readonly-redis -&gt; use redis as level 2 cache ,but never write data to it. if use this provider, you must uncomment `j2cache.L2.config_section` to make the redis configurations available.
## memcached -&gt; use memcached as level 2 cache (xmemcached),
## [classname] -&gt; use custom provider
##########################################
#
#j2cache.L1.provider_class = caffeine
#j2cache.L2.provider_class = redis
#
## When L2 provider isn't `redis`, using `L2.config_section = redis` to read redis configurations
## j2cache.L2.config_section = redis
#
## Enable/Disable ttl in redis cache data (if disabled, the object in redis will never expire, default:true)
## NOTICE: redis hash mode (redis.storage = hash) do not support this feature)
#j2cache.sync_ttl_to_redis = true
#
## Whether to cache null objects by default (default false)
#j2cache.default_cache_null_object = true
#
##########################################
## Cache Serialization Provider
## values:
## fst -&gt; using fast-serialization (recommend)
## kryo -&gt; using kryo serialization
## json -&gt; using fst's json serialization (testing)
## fastjson -&gt; using fastjson serialization (embed non-static class not support)
## java -&gt; java standard
## fse -&gt; using fse serialization
## [classname implements Serializer]
##########################################
#
#j2cache.serialization = json
##json.map.person = net.oschina.j2cache.demo.Person
#
##########################################
## Ehcache configuration
##########################################
#
## ehcache.configXml = /ehcache.xml
#
## ehcache3.configXml = /ehcache3.xml
## ehcache3.defaultHeapSize = 1000
#
##########################################
## Caffeine configuration
## caffeine.region.[name] = size, xxxx[s|m|h|d]
##
##########################################
#caffeine.properties = /caffeine.properties
#
##########################################
## Redis connection configuration
##########################################
#
##########################################
## Redis Cluster Mode
##
## single -&gt; single redis server
## sentinel -&gt; master-slaves servers
## cluster -&gt; cluster servers (数据库配置无效，使用 database = 0)
## sharded -&gt; sharded servers  (密码、数据库必须在 hosts 中指定，且连接池配置无效); redis://user:password@127.0.0.1:6379/0）
##
##########################################
#
#redis.mode = single
#
##redis storage mode (generic|hash)
#redis.storage = generic
#
### redis pub/sub channel name
#redis.channel = j2cache
### redis pub/sub server (using redis.hosts when empty)
#redis.channel.host =
#
##cluster name just for sharded
#redis.cluster_name = j2cache
#
### redis cache namespace optional, default[empty]
#redis.namespace =
#
### redis command scan parameter count, default[1000]
##redis.scanCount = 1000
#
### connection
## Separate multiple redis nodes with commas, such as 192.168.0.10:6379,192.168.0.11:6379,192.168.0.12:6379
#
#redis.hosts = 127.0.0.1:6379
#redis.timeout = 2000
#redis.password =
#redis.database = 0
#redis.ssl = false
#
### redis pool properties
#redis.maxTotal = 100
#redis.maxIdle = 10
#redis.maxWaitMillis = 5000
#redis.minEvictableIdleTimeMillis = 60000
#redis.minIdle = 1
#redis.numTestsPerEvictionRun = 10
#redis.lifo = false
#redis.softMinEvictableIdleTimeMillis = 10
#redis.testOnBorrow = true
#redis.testOnReturn = false
#redis.testWhileIdle = true
#redis.timeBetweenEvictionRunsMillis = 300000
#redis.blockWhenExhausted = false
#redis.jmxEnabled = false
#
##########################################
## Lettuce scheme
##
## redis -&gt; single redis server
## rediss -&gt; single redis server with ssl
## redis-sentinel -&gt; redis sentinel
## redis-cluster -&gt; cluster servers
##
##########################################
#
##########################################
## Lettuce Mode
##
## single -&gt; single redis server
## sentinel -&gt; master-slaves servers
## cluster -&gt; cluster servers (数据库配置无效，使用 database = 0)
## sharded -&gt; sharded servers  (密码、数据库必须在 hosts 中指定，且连接池配置无效 ; redis://user:password@127.0.0.1:6379/0）
##
##########################################
#
### redis command scan parameter count, default[1000]
##lettuce.scanCount = 1000
#lettuce.mode = single
#lettuce.namespace =
#lettuce.storage = hash
#lettuce.channel = j2cache
#lettuce.scheme = redis
#lettuce.hosts = 127.0.0.1:6379
#lettuce.password =
#lettuce.database = 0
#lettuce.sentinelMasterId =
#lettuce.maxTotal = 100
#lettuce.maxIdle = 10
#lettuce.minIdle = 10
## timeout in milliseconds
#lettuce.timeout = 10000
## redis cluster topology refresh interval in milliseconds
#lettuce.clusterTopologyRefresh = 3000
#
##########################################
## memcached server configurations
## refer to https://gitee.com/mirrors/XMemcached
##########################################
#
#memcached.servers = 127.0.0.1:11211
#memcached.username =
#memcached.password =
#memcached.connectionPoolSize = 10
#memcached.connectTimeout = 1000
#memcached.failureMode = false
#memcached.healSessionInterval = 1000
#memcached.maxQueuedNoReplyOperations = 100
#memcached.opTimeout = 100
#memcached.sanitizeKeys = false<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-4"><pre class="line-numbers language-none"><code class="language-none">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:noNamespaceSchemaLocation="http://ehcache.org/ehcache.xsd"
        updateCheck="false" name="defaultCache"&gt;

    &lt;!--
       diskStore：为缓存路径，ehcache分为内存和磁盘两级，此属性定义磁盘的缓存位置,可以自定义目录，确保用户有权限即可。参数解释如下：
       user.home – 用户主目录
       user.dir  – 用户当前工作目录
       java.io.tmpdir – 默认临时文件路径
     --&gt;
    &lt;!--    &lt;diskStore path="java.io.tmpdir"/&gt; --&gt;
    &lt;diskStore path="C:/Users/admin/ehcache/"/&gt;

    &lt;!-- maxElementsInMemory：内存中最大缓存对象数，根据服务器资源配置 --&gt;
    &lt;!-- eternal： 默认为false,设置true表示对象永不过期，此时会忽略timeToIdleSeconds和timeToLiveSeconds属性， --&gt;
    &lt;!-- maxElementsOnDisk：硬盘中最大缓存对象数，若是0表示无穷大 --&gt;
    &lt;!-- overflowToDisk：true表示当内存缓存的对象数目达到了maxElementsInMemory界限后，会把溢出的对象写到硬盘缓存中。
    注意：如果缓存的对象要写入到硬盘中的话，则该对象必须实现了Serializable接口才行。--&gt;
    &lt;!-- diskSpoolBufferSizeMB：磁盘缓存区大小，默认为30MB。每个Cache都应该有自己的一个缓存区。--&gt;
    &lt;!-- diskPersistent：是否缓存虚拟机重启期数据  --&gt;
    &lt;!-- diskExpiryThreadIntervalSeconds：磁盘失效线程运行时间间隔，默认为120秒 --&gt;

    &lt;!-- timeToIdleSeconds： 设定允许对象处于空闲状态的最长时间，单位（秒）。自对象最近一次被访问后，
    空闲时间超过了timeToIdleSeconds属性值，这个对象就会过期，如果该属性值为0，则对象无限期地处于空闲状态
    EHCache将把它从缓存中清空。只有当eternal属性为false，该属性才有效。
    --&gt;

    &lt;!-- timeToLiveSeconds：设定允许对象存在于缓存中的最长时间，单位（秒）。自对象被存放到缓存中后，
    在缓存中的时间超过了timeToLiveSeconds属性值，这个对象就会过期，如果该属性值为0，则对象无限期地存在于缓存中。
    EHCache将把它从缓存中清除。只有当eternal属性为false，该属性才有效。timeToLiveSeconds必须大于timeToIdleSeconds属性，才有意义 --&gt;

    &lt;!-- memoryStoreEvictionPolicy：当达到maxElementsInMemory限制时，Ehcache将会根据指定的策略去清理内存。
    可选策略有：LRU（最近最少使用，默认策略）、FIFO（先进先出）、LFU（最少访问次数）。--&gt;

    &lt;!-- 默认缓存 --&gt;
    &lt;defaultCache
            maxElementsInMemory="10000"
            eternal="false"
            overflowToDisk="false"
            diskSpoolBufferSizeMB="50"
            timeToIdleSeconds="300"
            timeToLiveSeconds="600"
            maxElementsOnDisk="10000000"
            diskExpiryThreadIntervalSeconds="120"
            memoryStoreEvictionPolicy="LRU"&gt;

        &lt;persistence strategy="localTempSwap"/&gt;

    &lt;/defaultCache&gt;

    &lt;cache name="employee_all"
           maxElementsInMemory="100"
           eternal="false"
           overflowToDisk="true"
           timeToIdleSeconds="300"
           timeToLiveSeconds="600"
           memoryStoreEvictionPolicy="LRU"/&gt;

    &lt;cache name="employee_info"
           maxElementsInMemory="1000"
           eternal="false"
           overflowToDisk="true"
           timeToIdleSeconds="300"
           timeToLiveSeconds="600"
           memoryStoreEvictionPolicy="LRU"/&gt;
    &lt;!--设置缓存空间--&gt;
    &lt;cache name="smsCode"
           maxElementsInMemory="1000"
           eternal="false"
           overflowToDisk="true"
           timeToIdleSeconds="300"
           timeToLiveSeconds="600"
           memoryStoreEvictionPolicy="LRU"/&gt;

&lt;/ehcache&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-5"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.autoconfigure.cache.CacheType;
import org.springframework.cache.annotation.CachePut;
import org.springframework.cache.annotation.Cacheable;
import org.springframework.stereotype.Service;
import top.wabisabifag.domain.SMSCode;
import top.wabisabifag.service.SMSCodeService;
import top.wabisabifag.utils.CodeUtils;

import java.util.concurrent.TimeUnit;

@Service
public class SMSCodeServiceImpl implements SMSCodeService {

    @Autowired
    private CodeUtils codeUtils;

    @Autowired
    /* 定义缓存对象*/
    private CacheChannel cacheChannel;

    @Override
    public String sendCodeToSMS(String tele) {
        String code = codeUtils.generator(tele);
        /* 放入内缓存对象中*/
        cacheChannel.set("sms",tele,code);
        return code;
    }

    @Override
    public boolean checkCode(SMSCode smsCode) {
        /* 获取内缓存对象数据*/
        String code = cacheChannel.get("sms",smsCode.getTele()).asString();
        return smsCode.getCode().equals(code);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>



<h4 id="2-任务"><a href="#2-任务" class="headerlink" title="2. 任务"></a>2. 任务</h4><ul>
<li><p>定时任务</p>
<ul>
<li>年度报表</li>
<li>缓存统计报告</li>
</ul>
</li>
<li><p>定时任务框架技术</p>
<ul>
<li>Quartz</li>
<li>Spring Task</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag;

import java.util.Timer;
import java.util.TimerTask;

public class TimeTaskApp {
    public static void main(String[] args) {
        /* 创建定时器对象*/
        Timer timer = new Timer();
        /* 创建定时任务*/
        TimerTask task = new TimerTask() {
            @Override
            public void run() {
                System.out.println("timer task run...");
            }
        };
        /* 每过 2秒 执行定时任务*/
        timer.schedule(task,0,2000);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="1-SpringBoot-整合-Quartz"><a href="#1-SpringBoot-整合-Quartz" class="headerlink" title="1. SpringBoot 整合 Quartz"></a>1. SpringBoot 整合 Quartz</h5><h6 id="1-概念"><a href="#1-概念" class="headerlink" title="1. 概念"></a>1. 概念</h6><ul>
<li>工作(Job):  用于定义具体的工作</li>
<li>工作明细(JobDetail):  用于描述定时工作相关的信息</li>
<li>触发器(Trugger):  用于描述触发工作的规则，通常使用cron 表达式定义调度规则</li>
<li>调度器(Scheduler):  描述工作明细与触发器的对应关系</li>
</ul>
<h6 id="2-Quartz"><a href="#2-Quartz" class="headerlink" title="2. Quartz"></a>2. Quartz</h6><div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">MyQuartzjava</button></li><li class="tab"><button type="button" data-href="#pom.xml-3">QuartzConfig.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--Quartz 整合--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starter-quartz&lt;/artifactId&gt;
      &lt;scop&gt;test&lt;/scop&gt;
    &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.quartz;

import org.springframework.scheduling.quartz.QuartzJobBean;

public class MyQuartz extends QuartzJobBean {
    @Override
    protected void executeInternal(JobExecutionContext jobExecutionContext) throws JobExecutionException {

    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import top.wabisabifag.quartz.MyQuartz;

@Configuration
public class QuartzConfig {

    @Bean
    /* 描述*/
    public JobDetail printJobDetail(){
        /* 绑定具体的工作  */
        return JobBuilder.newJob(MyQuartz.class)
                          .storeDurably().build; //持久化对象
    }

    @Bean
    public Trigger printJobTrigger(){
        /* 设定任务执行的周期:  分 时 日 月 */
        ScheduleBuilder scheduleBuilder = CronScheduleBuilder.cronSchedule("0 * * * * ?");

        /* 绑定对应的工作明细*/
        return TriggerBuilder
                            .newTrigger().forJob(printJobTrigger()) // 新建触发器 绑定任务
                            .withSchedule(schedBuilder).build();// 构建执行周期 绑定任务执行周期 
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>


<h5 id="2-Spring-Task"><a href="#2-Spring-Task" class="headerlink" title="2. Spring Task"></a>2. Spring Task</h5><div class="tabs" id="application.java"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#application.java-1">application.java</button></li><li class="tab"><button type="button" data-href="#application.java-2">MyBean.java</button></li><li class="tab"><button type="button" data-href="#application.java-3">application.yml</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="application.java-1"><pre class="line-numbers language-none"><code class="language-none">@SpringBootApplication
/* 开启定时任务功能*/
@EnableScheduling       
public class application {
    public static void main(String[] args) {
        // 线程安全问题
        SpringApplication.run(application.class,args);
        // 不接受外部临时参数
        SpringApplication.run(application.class);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.java-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.quartz;

import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Component;

@Component
public class MyBean {
    @Scheduled(cron = "0/1 * * * * ?")
    public void print(){
        //  获取线程名称
        System.out.println(Thread.currentThread().getName()+":spring task run 。。。");
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.java-3"><pre class="line-numbers language-none"><code class="language-none">spring:
    # 定时任务配置
  task:
    scheduling:
      # 任务调度线程池大小 默认 1
    pool:
      size: 1
    # 调度线程名称前缀 默认 scheduling-
    thread-name-prefix: ssm_
    shutdown:
      # 线程池关闭时等待所有任务完成
      await-termination: false
      # 调度线程 关闭前最大等待时间，确保最后一定关闭
      await-termination=period: 10s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>



<h5 id="3-SpringBoot-整合-JavaMail"><a href="#3-SpringBoot-整合-JavaMail" class="headerlink" title="3. SpringBoot 整合 JavaMail"></a>3. SpringBoot 整合 JavaMail</h5><ul>
<li>SMTP(Simple Mail Transfer Protocol): 简单的邮件传输协议，用于发送电子邮件的传输协议</li>
<li>POP3(Post Office Protocol -Version 3): 用于接收电子邮件的标准协议</li>
<li>IMAP(Internat Mail Access Protocol): 互联网消息协议，POP3 替代协议</li>
</ul>
<h6 id="1-JavaMail-基础"><a href="#1-JavaMail-基础" class="headerlink" title="1. JavaMail(基础)"></a>1. JavaMail(基础)</h6><div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.yml</button></li><li class="tab"><button type="button" data-href="#pom.xml-3">SendMailTest.java</button></li><li class="tab"><button type="button" data-href="#pom.xml-4">基础发送</button></li><li class="tab"><button type="button" data-href="#pom.xml-5">优化多格式内容发送</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--JavaMail 整合--&gt;
   &lt;dependency&gt;
     &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
     &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;
   &lt;/dependency&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">spring:
    # JavaMail 邮件
  mail:
    host: smtp.qq.com
    username: 12345678@qq.com
    # QQ邮箱 =&gt; 设置 =&gt; 账户 =&gt; POP3服务开启： 获取授权码 (付费功能)
    password: zsaf45coca<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag;

import org.junit.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import top.wabisabifag.service.SendMailService;

@SpringBootTest
public class SendMailTest {

    @Autowired
    private SendMailService sendMailService;

    @Test
    public void contextLoads(){
        sendMailService.sendMail();
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-4"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.mail.SimpleMailMessage;
import org.springframework.mail.javamail.JavaMailSender;
import org.springframework.stereotype.Service;
import top.wabisabifag.service.SendMailService;
@Service
public class SendMaillServiceImpl implements SendMailService {

    @Autowired
    private JavaMailSender javaMailSender;

    private String from = "12345678@qq.com"; /* 发送人*/
    private String to = "12345678@126.com"; /* 接收人*/
    private String subject = "测试邮件"; /* 标题*/
    private String context = "测试邮件正文内容"; /* 正文*/

    @Override
    public void sendMail() {

        SimpleMailMessage message = new SimpleMailMessage();

        /* 替代发送者的邮箱账号，接收者信息有具体的信息*/
        message.setFrom(from+"(好友:张伟)");
        message.setTo(to);
        message.setSubject(subject);
        message.setText(context);

        javaMailSender.send(message);

    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-5"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.mail.SimpleMailMessage;
import org.springframework.mail.javamail.JavaMailSender;
import org.springframework.mail.javamail.MimeMailMessage;
import org.springframework.mail.javamail.MimeMessageHelper;
import org.springframework.stereotype.Service;
import top.wabisabifag.service.SendMailService;

import java.io.File;

@Service
public class SendMaillServiceImpl implements SendMailService {

    @Autowired
    private JavaMailSender javaMailSender;

    private String from = "12345678@qq.com"; /* 发送人*/
    private String to = "12345678@126.com"; /* 接收人*/
    private String subject = "测试邮件"; /* 标题*/
    private String context = "&lt;a href='http://www.wabisabifag.top'&gt;测试邮件正文内容&lt;/a&gt;"; /* 正文*/

    @Override
    public void sendMail() {
        try{

            MimeMessage message = javaMailSender.createMimeMessage();

            /* 1.添加附件功能: true*/
            MimeMessageHelper helper = new MimeMessageHelper(message,true);
            helper.setFrom(from+"(好友:张伟)");
            helper.setTo(to);
            helper.setSubject(subject);

            /* 4.文档内容支持 HTML 格式*/
            helper.setText(context,true);

            /* 2.添加 附件*/
            File file = new File("D:\\wabisabifag.jar");
            File file2 = new File("D:\\学习资料.zip");

            /* 3.附件名修改方式*/
            helper.addAttachment(file.getName(),file);
            helper.addAttachment("发给张总的素材.zip",file2);

            javaMailSender.send(message);

        }catch (Exception e){
            e.printStackTrace();
        }
    }
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>



<h4 id="3-消息"><a href="#3-消息" class="headerlink" title="3. 消息"></a>3. 消息</h4><ul>
<li>生产者 消费者</li>
<li>消息队列<ul>
<li>浏览器 ===&gt;&gt; 业务系统 ===&gt;&gt; MQ ===&gt;&gt; 子业务系统</li>
</ul>
</li>
</ul>
<h5 id="1-同步消息"><a href="#1-同步消息" class="headerlink" title="1. 同步消息"></a>1. 同步消息</h5><h5 id="2-异步消息"><a href="#2-异步消息" class="headerlink" title="2. 异步消息"></a>2. 异步消息</h5><h6 id="1-JMS"><a href="#1-JMS" class="headerlink" title="1. JMS"></a>1. JMS</h6><p>JMS(Java Message Service): 一个规范，等同于JDBC 规范，提供消息服务的API接口</p>
<ol>
<li><p>JMS 消息模型</p>
<ul>
<li>peer-2-peer: 点对点模型，消息发送到一个队列中，队列保存消息只能被一个消费者消费，或超时</li>
<li>publish-subscribe: 发布订阅模型，消息被多消费者消费，生产者和消费者完全独立</li>
</ul>
</li>
<li><p>JMS 消息种类</p>
<ul>
<li>TextMessage</li>
<li>MapMessage</li>
<li>BytesMessage (主要使用)</li>
<li>StreamMessage</li>
<li>ObjectMessage</li>
<li>Message (只有消息和属性)</li>
</ul>
</li>
<li><p>JMS 实现:</p>
<ul>
<li>ActiveMQ</li>
<li>Redis</li>
<li>HornetMQ</li>
<li>RabbitMQ</li>
</ul>
</li>
</ol>
<h6 id="2-AMQP"><a href="#2-AMQP" class="headerlink" title="2. AMQP"></a>2. AMQP</h6><p>AMQP(advanced message queuing protocol): 一种协议(高级消息队列协议，消息代理规范)。会犯网络交换的数据格式，兼容JMS</p>
<ul>
<li>特性<ul>
<li>跨平台和语言</li>
<li>服务器供应商</li>
<li>生产者</li>
</ul>
</li>
</ul>
<ol>
<li><p>AMQP 消息模型</p>
<ul>
<li>direct exchange</li>
<li>fanout exchange</li>
<li>topic exchange (主要)</li>
<li>headers exchange</li>
<li>system exchange</li>
</ul>
</li>
<li><p>AMQP 消息种类</p>
<ul>
<li>byte[]</li>
</ul>
</li>
<li><p>AMQP 实现:</p>
<ul>
<li>RabbitMQ</li>
<li>StormMQ</li>
<li>RockeMQ</li>
</ul>
</li>
</ol>
<h6 id="3-MQTT"><a href="#3-MQTT" class="headerlink" title="3. MQTT"></a>3. MQTT</h6><p>MQTT(Message Queueing Telemetry Transport) 消息队列遥测传输，专为小设备设计，物联网(IOT)生态系统主要成分之一</p>
<h6 id="4-Kafka"><a href="#4-Kafka" class="headerlink" title="4. Kafka"></a>4. Kafka</h6><p>Kafka 一种高吞吐量的分布式发布订阅消息系统，提供实时消息功能</p>
<h5 id="3-消息案例-—-模拟订单短信通知"><a href="#3-消息案例-—-模拟订单短信通知" class="headerlink" title="3. 消息案例 — 模拟订单短信通知"></a>3. 消息案例 — 模拟订单短信通知</h5><div class="tabs" id="orderserviceimpl.java"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#orderserviceimpl.java-1">OrderServiceImpl.java</button></li><li class="tab"><button type="button" data-href="#orderserviceimpl.java-2">MessageServiceImpl.java</button></li><li class="tab"><button type="button" data-href="#orderserviceimpl.java-3">OrderController.java</button></li><li class="tab"><button type="button" data-href="#orderserviceimpl.java-4">MessageController.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="orderserviceimpl.java-1"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import top.wabisabifag.service.MessageService;
import top.wabisabifag.service.OrderService;
@Service
public class OrderServiceImpl implements OrderService {

    @Autowired
    private MessageService messageService;

    @Override
    public void order(String id) {
        /* 服务调用 处理各种业务*/
        System.out.println("订单处理处理中。。。");
        /* 短信消息处理*/
        messageService.sendMessage(id);

        System.out.println("订单处理完成");
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="orderserviceimpl.java-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl;

import org.springframework.stereotype.Service;
import top.wabisabifag.service.MessageService;

import java.util.ArrayList;

@Service
public class MessageServiceImpl implements MessageService {
    private ArrayList&lt;String&gt; msgList = new ArrayList&lt;&gt;();

    @Override
    public void sendMessage(String id) {
        System.out.println("待发送短信的订单已纳入处理队列: id"+id);
        msgList.add(id);
    }

    @Override
    public String doMessage() {
        String id = msgList.remove(0);
        System.out.println("已完成短信发送业务：id"+id);
        return null;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="orderserviceimpl.java-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.controller;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import top.wabisabifag.service.OrderService;

@RestController
@RequestMapping("/orders")
public class OrderController {

    @Autowired
    private OrderService orderService;

    @PostMapping("{id}")
    public void Order(@PathVariable String id){
        orderService.order(id);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="orderserviceimpl.java-4"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.controller;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import top.wabisabifag.service.MessageService;

@RestController
@RequestMapping("/msg")
public class MessageController {
    @Autowired
    private MessageService messageService;

    @GetMapping
    public String doMessage(){
        String id = messageService.doMessage();
        return id;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>


<h6 id="1-ActiveMQ"><a href="#1-ActiveMQ" class="headerlink" title="1. ActiveMQ"></a>1. ActiveMQ</h6><ol>
<li><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://activemq.apache.org/components/classic/download/">ActiveMQ 下载地址</a></p>
</li>
<li><p>安装运行</p>
</li>
</ol>
<ul>
<li>批处理运行: ../bin/win64/activemq.bat </li>
<li>安装: ../bin/win64/InstallService.bat</li>
<li>后台管理界面: 127.0.0.1:8161/   (password: admin)</li>
<li>服务端口: 127.0.0.1:61616/</li>
</ul>
<ol start="3">
<li>Spring 整合 ActiveMQ</li>
</ol>
<div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.yml</button></li><li class="tab"><button type="button" data-href="#pom.xml-3">MessageServiceActivemqImpl.java</button></li><li class="tab"><button type="button" data-href="#pom.xml-4">监听消费</button></li><li class="tab"><button type="button" data-href="#pom.xml-5">传递队列消息</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--ActiveMQ 整合--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starter-activemq&lt;/artifactId&gt;
    &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">spring:
  # ActiveMQ 消息
  activemq:
    broker-url: top://localhost:61616
  jms:
    # 发布订阅模型：true 点对点模型：false 
    pub-sub-domain: true
    template:
    default-destination: wabisabifag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl.activemq;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import top.wabisabifag.service.MessageService;
@Service
public class MessageServiceActivemqImpl implements MessageService {

    @Autowired
    private JmsMessagingTemplate messagingTemplate;

    @Override
    public void sendMessage(String id) {
        System.out.println("待发送短信的订单已纳入处理队列: id"+id);
        /* 设置队列名字 */
        messagingTemplate.convertAndSend("order.queu.id",id);
    }

    @Override
    public String doMessage() {
        String id = messagingTemplate.receiveAndConvert(String.class);
        System.out.println("已完成短信发送业务：id"+id);
        return null;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-4"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl.activemq.listener;

import org.springframework.stereotype.Component;

@Component
public class MessageListener {
    @JsmListener(destination = "order.queue.id")
    public void recevi(String id){
        System.out.println("已完成短信发送业务：id"+id);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-5"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl.activemq.listener;

import org.springframework.stereotype.Component;

@Component
public class MessageListener {
    @JsmListener(destination = "order.queue.id")
    @SendTo("order.other.queue.id")
    public String recevi(String id){
        System.out.println("已完成短信发送业务：id"+id);
        return "new:"+ id;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>



<h6 id="2-RabbitMQ"><a href="#2-RabbitMQ" class="headerlink" title="2. RabbitMQ"></a>2. RabbitMQ</h6><ol>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://rabbitmq.com/install-windows.html">RabbitMQ </a>基于Erlang 语言编写，需要安装 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.erlang.org.downloads/">Erlang</a> 并重启电脑</li>
<li>配置环境 ERLANG_HOME</li>
<li>管理员权限 ..\bin\rabbitmq-service.bat start</li>
<li>插件</li>
</ol>
<ul>
<li>查看 rabbitmq-plugins.bat list </li>
<li>开启 rabbitmq-plugins.bat enable rabbitmq_management</li>
</ul>
<ol start="5">
<li>访问服务</li>
</ol>
<ul>
<li>管理后台端口 localhost:156772  (password: guest)</li>
<li>服务端口 localhost:5672</li>
</ul>
<ol start="6">
<li>direct exchange 直连交换机(消息模型)</li>
</ol>
<div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.yml</button></li><li class="tab"><button type="button" data-href="#pom.xml-3">定义消息队列</button></li><li class="tab"><button type="button" data-href="#pom.xml-4">生产与消费消息</button></li><li class="tab"><button type="button" data-href="#pom.xml-5">消息监听器</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-<!--RabbitMQ" data-language="<!--RabbitMQ"><div class="caption"><span>direct exchange (消息模型)--&gt;</span></div><code class="language-<!--RabbitMQ">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;
&lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none">spring:
    # RabbitMQ
    rabbitmq:
      host: localhost
      # 服务端口       管理：15672
      port: 5672<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl.rabbitmq.direct.config;

import org.elasticsearch.common.inject.internal.BindingBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import javax.naming.Binding;
import java.util.Queue;

@Configuration
public class RabbitConfigDirect {
    @Bean       /* 消息队列*/
    public Queue directQueue(){
                /*  1.是否持久化  2.当前消息队列是否连接专用  3.是否删除*/
        return new Queue("direct_queue",true,false,false);
    }

    @Bean       /* 消息队列*/
    public Queue directQueue2(){
        return new Queue("direct_queue2");
    }
    @Bean       /* 交换机*/
    public DirectExchange directExchange(){
        return new DirectExchange("directExchange");
    }

    @Bean       /* 绑定消息队列和交换机*/
    public Binding bindingDirect(){
        return BindingBuilder.bind(directQueue()).to(directExchange()).with("direct");
    }

    @Bean       /* 绑定消息队列和交换机*/
    public Binding bindingDirect2(){
        return BindingBuilder.bind(directQueue2()).to(directExchange()).with("direct2");
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-4"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl.rabbitmq.direct;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import top.wabisabifag.service.MessageService;
@Service
public class MessageServiceRabbitmqDirectImpl implements MessageService {

    @Autowired
    private  AmqpTemplate amqpTemplate;

    @Override
    public void sendMessage(String id) {
        System.out.println("待发送短信的订单已纳入处理队列(rabbitmq direct)：id"+id);
        /* 明确消息模型*/
        amqpTemplate.convertAndSend("directExchange","direct",id);
    }

    @Override
    public String doMessage() {
        return null;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-5"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl.rabbitmq.direct.listener;

import org.springframework.stereotype.Component;

@Component
public class MessageListener {
    @RabbitListener(queue="direct_queue")
    public void recive(String id){
        System.out.println("待发送短信的订单已纳入处理队列(rabbitmq direct)：id"+id);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>



<ol start="7">
<li>topic exchange  主题交换机(消息模型)</li>
</ol>
<div class="tabs" id="rabbitconfigtopic.java"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#rabbitconfigtopic.java-1">RabbitConfigTopic.java</button></li><li class="tab"><button type="button" data-href="#rabbitconfigtopic.java-2">MessageListener.java</button></li><li class="tab"><button type="button" data-href="#rabbitconfigtopic.java-3">MessageServiceRabbitmqTopicImpl.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="rabbitconfigtopic.java-1"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl.rabbitmq.topic.config;

import org.elasticsearch.common.inject.internal.BindingBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import javax.naming.Binding;
import java.util.Queue;

@Configuration
public class RabbitConfigTopic {
    @Bean       /* 消息队列*/
    public Queue topicQueue(){
                /*  1.是否持久化  2.当前消息队列是否连接专用  3.是否删除*/
        return new Queue("topic_queue",true,false,false);
    }

    @Bean       /* 消息队列*/
    public Queue topictQueue2(){
        return new Queue("topic_queue2");
    }
    @Bean       /* 交换机*/
    public TopicExchange topicExchange(){
        return new TopicExchange("topicExchange");
    }

    /* 一次队列消息多次匹配*/

    @Bean       /* 绑定消息队列和交换机*/
    public Binding bindingTopic(){
        return BindingBuilder.bind(topicQueue()).to(topicExchange()).with("topic.*.id");
    }

    @Bean       /* 绑定消息队列和交换机*/
    public Binding bindingTopic2(){
        return BindingBuilder.bind(topicQueue2()).to(topicExchange()).with("topic.order.*");
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="rabbitconfigtopic.java-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl.rabbitmq.topic.listener;

import org.springframework.stereotype.Component;

@Component
public class MessageListener {
    @RabbitListener(queue="topic_queue")
    public void recive(String id){
        System.out.println("待发送短信的订单已纳入处理队列(rabbitmq direct)：id"+id);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="rabbitconfigtopic.java-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl.rabbitmq.topic;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import top.wabisabifag.service.MessageService;
@Service
public class MessageServiceRabbitmqTopicImpl implements MessageService {

    @Autowired
    private  AmqpTemplate amqpTemplate;

    @Override
    public void sendMessage(String id) {
        System.out.println("待发送短信的订单已纳入处理队列(rabbitmq topic)：id"+id);
        /* 明确消息模型*/                              /*topic exchange 的特点*/
        /* 一次队列消息多次匹配*/
        amqpTemplate.convertAndSend("topicExchange","topic.order.id",id);
    }

    @Override
    public String doMessage() {
        return null;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>


<ul>
<li>特性: 一个生产者，可产生多个消息队列，然后消费者通过routingkey去匹配生产者的routingkey</li>
<li>绑定键匹配规则<br><img src="/../JavaEE/4.png" alt="绑定键匹配规则"></li>
</ul>
<h6 id="3-RocketMQ"><a href="#3-RocketMQ" class="headerlink" title="3. RocketMQ"></a>3. RocketMQ</h6><ol>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://rocketmq.apache.org/">RocketMQ 下载地址</a></li>
<li>环境配置</li>
</ol>
<ul>
<li>ROCKETMQ_HOME</li>
<li>PATH</li>
<li>NAMESRV_ADDR</li>
</ul>
<ol start="3">
<li>访问服务</li>
</ol>
<ul>
<li>服务端口: 9876</li>
<li>管理端口: 127.0.0.1:9876</li>
</ul>
<ol start="4">
<li>启动服务器</li>
</ol>
<ul>
<li>mqnamesrv.cmd</li>
<li>mqbroker.cmd</li>
</ul>
<ol start="5">
<li>RocketMq 整合</li>
</ol>
<div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.yml</button></li><li class="tab"><button type="button" data-href="#pom.xml-3">MessageServiceRocketmqImpl.java</button></li><li class="tab"><button type="button" data-href="#pom.xml-4">MessageListener.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--rocketmq--&gt;
   &lt;dependency&gt;
     &lt;groupId&gt;org.apache.rocketmq&lt;/groupId&gt;
     &lt;artifactId&gt;rockemq-spring-boot-starter&lt;/artifactId&gt;
     &lt;version&gt;2.2.1&lt;/version&gt;
   &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none"># rocketmq 消息
rocketmq:
  name-server: localhost:9876
  # 默认的生产者所属组
  producer:
    group: group_rocketmq<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl.rocketmq;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import top.wabisabifag.service.MessageService;

@Service
public class MessageServiceRocketmqImpl implements MessageService {

    @Autowired
    private RocketMQTemplate rocketMQTemplate;

    @Override
    public void sendMessage(String id) {
        System.out.println("待发送短信的订单已纳入处理队列(rabbitmq topic)：id"+id);
         //rocketMQTemplate.convertAndSend("order_id",id);
         
        /* 异步发送消息队列*/
        SendCallback callback = new SendCallback(){
            @Override
            public void onSuccess(SendResult sendResult){
                System.out.println("消息发送成功");
            }
            @Override
            public void onException(Throwable e){
                System.out.println("消息发送失败");
            }
        };
        rocketMQTemplate.convertAndSend("order_id",id);
    }

    @Override
    public String doMessage() {
        return null;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-4"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl.rocketmq.listener;

import org.springframework.stereotype.Component;

@Component
@RocketMQMessageListener(topic = "order_id",consumerGroup = "group_rocketmq")
public class MessageListener implements RocketMqListener{
    @Override
    public void onMessage(String id){
        System.out.println("待发送短信的订单已纳入处理队列(roketmq)：id"+id);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>`


<h6 id="4-Kafka-1"><a href="#4-Kafka-1" class="headerlink" title="4. Kafka"></a>4. Kafka</h6><ol>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://kafka.apache.org/downloads">Kafka</a></li>
<li>安装运行</li>
</ol>
<ul>
<li>启动zookeeper 注册器(默认端口:2181): zookeeper-server-start.bat ....\config\zookeeper.properties</li>
<li>启动kafka (默认端口:9092): kafka-server-start.bat ....\config\server.properties</li>
<li>创建topic: kafka-topic.bat –create –zookeeper localhost:2181 –replication-factor 1 –partition 1 –topic wabisabifag</li>
<li>查看topic: kafka-topics.bat –zookeeper 127.0.0.1:2181 –list</li>
<li>删除topic: kafka-topics.bat –delete –zookeeper localhost:2181 –topic wabisabifag</li>
<li>生产者功能测试: kafka-console-producer.bat –broker-list localhost:9092 –topic wabisabifag</li>
<li>消费者功能测试: kafka-console-consumer.bat –bootstrap-server localhost:9092 –topic wabisabifag –from-beginning</li>
</ul>
<ol start="3">
<li>Kafka 整合</li>
</ol>
<div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#-2">application.yml</button></li><li class="tab"><button type="button" data-href="#-3">MessageServiceKafkaImpl.java</button></li><li class="tab"><button type="button" data-href="#-4">4</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--Kafka--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.kafka&lt;/groupId&gt;
      &lt;artifactId&gt;spring-kafka&lt;/artifactId&gt;
    &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><pre class="line-numbers language-none"><code class="language-none">spring:
  # Kafka
  kafka:
    bootstrap-servers: localhost:9092
    consumer:
      group-id: order<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl.kafka;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import top.wabisabifag.service.MessageService;
@Service
public class MessageServiceKafkaImpl implements MessageService {

    @Autowired
    private KafkaTemplate&lt;String,String&gt; kafkaTemplate;

    @Override
    public void sendMessage(String id) {
        System.out.println("待发送短信的订单已纳入处理队列(Kafka)：id"+id);
        kafkaTemplate.send("wabisabifag",id);
    }

    @Override
    public String doMessage() {
        return null;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-4"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.service.impl.kafka.Listener;

import org.springframework.stereotype.Component;

@Component
public class MessageListener {

    // 监听 消费有页面存入 kafka 的缓存数据
    @KafkaListener(topics={"wabisabifag"})
    public void onMessage(ConsumerRecord&lt;String,String&gt; record){
        System.out.println("待发送短信的订单已纳入处理队列(Kafka)：id"+record.value());
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>


<h4 id="4-监控"><a href="#4-监控" class="headerlink" title="4. 监控"></a>4. 监控</h4><h5 id="1-监控的意义"><a href="#1-监控的意义" class="headerlink" title="1. 监控的意义"></a>1. 监控的意义</h5><ul>
<li>监控服务状态是否宕机</li>
<li>监控服务运行指标(内存，虚拟机，线程，请求等)</li>
<li>监控日志</li>
<li>管理服务</li>
</ul>
<h6 id="1-监控的实施方式"><a href="#1-监控的实施方式" class="headerlink" title="1. 监控的实施方式"></a>1. 监控的实施方式</h6><ul>
<li>显示监控信息的服务器: 用于获取服务信息，并显示对应的信息</li>
<li>运行的服务: 启动时，主动上报。告知监控服务器自己需要受到监控</li>
</ul>
<h5 id="2-可视化监控平台"><a href="#2-可视化监控平台" class="headerlink" title="2. 可视化监控平台"></a>2. 可视化监控平台</h5><ol>
<li>Java 提供一个jmx方式获取的监控平台:cmd命令行 输入: jconsole</li>
<li>也可以通过 http 的 web 程序获取</li>
</ol>
<h6 id="1-SpringBoot-Admin"><a href="#1-SpringBoot-Admin" class="headerlink" title="1. SpringBoot Admin"></a>1. SpringBoot Admin</h6><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://consolelog.gitee.io/docs-spring-boot-admin-docs-chinese/">SpringBoot Admin 文档</a> 监控管理SpringBoot 应用程序。客服端注册到服务端后，通过 HTTP 请求方式，服务端定期从客服端获取对应信息，通过UI界面战士对应信息</p>
<div class="tabs" id="pom.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pom.xml-1">pom.xml</button></li><li class="tab"><button type="button" data-href="#pom.xml-2">application.yml</button></li><li class="tab"><button type="button" data-href="#pom.xml-3">application.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pom.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--监控 服务端--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;de.codecentric&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-admin-starter-server&lt;/artifactId&gt;
      &lt;!--和SpringBoot版本对应--&gt;
      &lt;version&gt;2.4.5&lt;/version&gt;
    &lt;/dependency&gt;

&lt;!--监控 客服端--&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;de.codecentric&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-admin-starter-client&lt;/artifactId&gt;
      &lt;version&gt;2.4.5&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-2"><pre class="line-numbers language-none"><code class="language-none"># 向服务端 提交监控
spring:
  boot:
    admin:
      client:
        url: http://localhost:8080
  management:
    # 端点功能的开关控制 
    endpoint:
      # 必须对外开放的
      health:
        show-details: always
      # 不对外展示 端口
      info:
        enabled: false
    # 端点功能的暴露    
    endpoints:
      # 在web页面能获取的端口
      web:
        exposure:
          include: "*"
      # 启用所有端口
      enabled-by-default: true<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pom.xml-3"><pre class="line-numbers language-none"><code class="language-none">@SpringBootApplication
/* 开启监控*/
@EnableAdminServer
public class application {
    public static void main(String[] args) {
        // 线程安全问题
        SpringApplication.run(application.class,args);
        // 不接受外部临时参数
        SpringApplication.run(application.class);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<h5 id="3-监控原理"><a href="#3-监控原理" class="headerlink" title="3. 监控原理"></a>3. 监控原理</h5><ul>
<li>Actuator 提供SpringBoot 生产就绪功能，通过端点的配置与访问获取端点信息(spring-boot-admin-starter-client 提供spring-boot-admin-starter-actuator)</li>
<li>端点描述一组监控信息。SpringBoot 提供多个内置端点，也可以根据需要自定义端点信息</li>
<li>访问当前应用的所有端点信息: /actuator</li>
<li>访问端点详细信息: /actuator/端点名称</li>
</ul>
<p><img src="/../JavaEE/5.png" alt="监控原理1"><br><img src="/../JavaEE/6.png" alt="监控原理2"><br><img src="/../JavaEE/7.png" alt="监控原理3"></p>
<h5 id="4-自定义监控指标"><a href="#4-自定义监控指标" class="headerlink" title="4. 自定义监控指标"></a>4. 自定义监控指标</h5><ol>
<li><p>info 端点指标控制</p>
<div class="tabs" id="application.yml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#application.yml-1">application.yml</button></li><li class="tab"><button type="button" data-href="#application.yml-2">通过类注册为Bean，增加Info的自定义信息</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="application.yml-1"><pre class="line-numbers language-none"><code class="language-none">info:
  # 静态信息
  # 映射项目名称
  webName: @project.artifactId@
  version: @project.version@
  author: wabisabifag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="application.yml-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.actuator;

import org.springframework.stereotype.Component;

import java.util.HashMap;

@Component
public class InfoConfig implements InfoContributor{
    @Override
    public void contribute(Info.Builder builder){

        // withDetail() 单值加载
        builder.withDetail("runtime",System.currentTimeMillis());

        // withDetails() 多值加载
        Map infoMap = new HashMap();
        infoMap.put("buildTime","2006");
        builder.withDetails(infoMap);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
</li>
<li><p>health 端点指标控制</p>
<pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.actuator;

import org.springframework.stereotype.Component;

import java.util.HashMap;

@Component
public class HealthConfig extends AbstractHealthIndocator{
    @Override
    protected void doHealthCheck(Health.Builder builder) throws Exception{
        boolean condition = true;
        if (condition){
            // 设置 health 的状态
            builder.status(Status.UP); 
            /*builder.unknown();
            builder.outService();
            builder.down();*/

            builder.withDetail("runtime",System.currentTimeMillis());
            Map infoMap = new HashMap();
            infoMap.put("buildTime","2006");
            builder.withDetails(infoMap);   
        }else {
            builder.withDetail("上线了吗？","你做梦");
            builder.down();
        }
    }
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>metrics 端点指标控制</p>
<pre class="line-numbers language-none"><code class="language-none">@Service
public class BookServiceImpl extends ServiceImpl&lt;BookDao Book&gt; implements IBookService{
   
    private Counter counter;

    public BookServiceImpl(MeterRegistry meterRegistry){
        // 监控的名称
        cunter = meterRegistry.counter("用户付费操作次数:");
    }

    @Override
    public boolean delete(Integer id){
      // 原子递增
      counter.increment();
      return bookDao.deleteById(id) &gt; 0;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>自定义监控指标</p>
<pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.actuator;

import org.springframework.stereotype.Component;

import java.util.HashMap;

@Component
/* 声明端点名  id:访问名称     是否默认开启*/
@Endpoint(id="pay",enableByDefault=true)
public class PayEndpoint {

    /* 注解功能: 端点读取时调用该方法*/
    @ReadOperation
    public Object getPay(){
        // 调用业务操作 获取支付相关信息结果，return一个可转换为 json 数据的值
        Map payMap = new HashMap();
        payMap.put("vip 1","10");
        payMap.put("vip 2","100");
        payMap.put("vip 3","韭菜嘎嘎多");
        return payMap;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h1 id="2-Docker"><a href="#2-Docker" class="headerlink" title="2. Docker"></a>2. Docker</h1><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.docker.com/engine/install/centos/">Docker 官方安装文档</a> 是一个快速构建、运行、管理应用工具</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hub.docker.com/">Docker 官方维护的公共 镜像仓库</a><br><img src="/../JavaEE/9.png" alt="Docker 镜像原理图"></p>
<h2 id="1-传统-Linux-安装-MySQL-数据库"><a href="#1-传统-Linux-安装-MySQL-数据库" class="headerlink" title="1. 传统 Linux 安装 MySQL 数据库"></a>1. 传统 Linux 安装 MySQL 数据库</h2><h3 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1. 准备工作"></a>1. 准备工作</h3><h4 id="1-查看系统环境"><a href="#1-查看系统环境" class="headerlink" title="1. 查看系统环境"></a>1. 查看系统环境</h4><p>使用 lable lsb_release -a  命令查看Linux 系统版本，便于下载MySql安装包时选择对应的 OS version</p>
<h4 id="2-下载MySQL-安装包"><a href="#2-下载MySQL-安装包" class="headerlink" title="2. 下载MySQL 安装包"></a>2. 下载MySQL 安装包</h4><p>下载<a target="_blank" rel="noopener external nofollow noreferrer" href="https://dev.mysql.com/downloads/mysql/">MySQL</a>，选择 OS Version 以及 MySQL安装包</p>
<p>解压命令：tar -xf packageName -C /user/local/…</p>
<h3 id="2-安装"><a href="#2-安装" class="headerlink" title="2. 安装"></a>2. 安装</h3><h4 id="1-卸载默认数据库-MariaDB"><a href="#1-卸载默认数据库-MariaDB" class="headerlink" title="1. 卸载默认数据库 MariaDB"></a>1. 卸载默认数据库 MariaDB</h4><ol>
<li>查看已存在的数据库：<pre class="line-numbers language-none"><code class="language-none">yum list installed | grep mariadb &amp;&amp; yum list installed | grep mysql<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li>卸载：<pre class="line-numbers language-none"><code class="language-none">yum -y remove -mariadb-libs.x86_64<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li>按顺序安装以下几个文件：<pre class="line-numbers language-none"><code class="language-none">rpm -ivh mysql-community-common-8.0.29-1.el7.x86_64.rpm
rpm -ivh mysql-community-client-plugins-8.0.29-1.el7.x86_64.rpm
rpm -ivh mysql-community-libs-8.0.29-1.el7.x86_64.rpm
rpm -ivh mysql-community-libs-compat-8.0.29-1.el7.x86_64.rpm
rpm -ivh mysql-community-devel-8.0.29-1.el7.x86_64.rpm
rpm -ivh mysql-community-client-8.0.29-1.el7.x86_64.rpm
rpm -ivh mysql-community-icu-data-files-8.0.29-1.el7.x86_64.rpm
rpm -ivh mysql-community-server-8.0.29-1.el7.x86_64.rpm<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
在此安装过程中，遇到了如下问题：</li>
</ol>
<ul>
<li>mysql-community-devel 安装失败<ul>
<li>解决方法：</li>
<li>安装依赖 openssl-devel：yum install openssl-devel -y  </li>
<li>安装失败一般是由包依赖引起的，安装对应的依赖包即可</li>
</ul>
</li>
</ul>
<ol start="4">
<li><p>查看安装完成后的安装包<br>查看已完成的安装完:rpm -qa | grep mysql</p>
</li>
<li><p>初始化MySQL服务<br>修改数据库目录与文件（默认/var/lib/mysql下）的所有者为mysql用户：</p>
<pre class="line-numbers language-none"><code class="language-none">mysqld --initialize --user=mysql<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>
<p>该命令执行后会生成一个root的临时密码，在 /var/log/mysqld.log 文件中：</p>
<pre class="line-numbers language-none"><code class="language-none">grep "password" /var/log/mysqld.log<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="6">
<li><p>启动MySQL服务</p>
<pre class="line-numbers language-none"><code class="language-none">service mysqld start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>验证<br>输入刚才找到的临时密码登录命令行操作</p>
<pre class="line-numbers language-none"><code class="language-none">mysql -uroot -p<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>验证成功。</p>
</li>
</ol>
<h2 id="2-Docke-安装"><a href="#2-Docke-安装" class="headerlink" title="2.Docke 安装"></a>2.Docke 安装</h2><h3 id="1-配置Docker-的-yum-库"><a href="#1-配置Docker-的-yum-库" class="headerlink" title="1. 配置Docker 的 yum 库"></a>1. 配置Docker 的 yum 库</h3><p>安装yum工具：</p>
<pre class="line-numbers language-none"><code class="language-none">yum install -y yum-utils<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>安装完成执行命令，配置Docker 的 yum 源：</p>
<pre class="line-numbers language-none"><code class="language-none">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="2-安装-Docker"><a href="#2-安装-Docker" class="headerlink" title="2. 安装 Docker"></a>2. 安装 Docker</h3><pre class="line-numbers language-none"><code class="language-none">yum install -y docker-ce docker-ce-cli comtainerd.io docker-buildx-plugin docker-compose-plugin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>版本验证：<pre class="line-numbers language-none"><code class="language-none">docker -v

# 启动 docker
systemctl start docker
systemctl stop docker

# 设置开启自启动
systemctl restart docker

# 执行docker.ps 命令检验
docker ps

# 启动守护进程
docker images<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="3-配置镜像加速"><a href="#3-配置镜像加速" class="headerlink" title="3. 配置镜像加速"></a>3. 配置镜像加速</h3><p><img src="/../JavaEE/8.png" alt="阿里云提供的镜像加速"></p>
<h3 id="4-Docker-一键部署MySQL"><a href="#4-Docker-一键部署MySQL" class="headerlink" title="4. Docker 一键部署MySQL"></a>4. Docker 一键部署MySQL</h3><p>自动搜索下载应用镜像，创建一个隔离环境的容器<br>多个创建用 docker ps 可以检查多个运行应用</p>
<ol>
<li>一键部署MySQL 命令<pre class="line-numbers language-none"><code class="language-none">docker run -d --name wabisabifag -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123 -e TZ=Asia/Shanghai   -v /root/mysql/data:/var/lib/mysql  -v /root/mysql/init:/docker-entrypoint-initdb.d  -v /root/mysql/config:/etc/mysql/conf.d mysql:5.1.47<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>
<ul>
<li>docker run： 创建运行容器 -d 让容器在后台运行</li>
<li>–name: 唯一名称</li>
<li>-p：映射端口，宿主机端口：容器端口</li>
<li>-e：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://hub.docker.com/_/mysql">设置MySQL的 Key=Value环境变量</a></li>
<li>mysq：指定镜像名(不写默认最新)</li>
</ul>
<h2 id="3-常见命令"><a href="#3-常见命令" class="headerlink" title="3. 常见命令"></a>3. 常见命令</h2><p><img src="/../JavaEE/10.png" alt="Docker 常见镜像，容器操作"></p>
<pre class="line-numbers language-none"><code class="language-none"># 镜像仓库
docker pull       docker push

# 本地镜像
docker images     docker rmi  #删除镜像

# DOCKERFILE
docker build
docker save       docker load

# 容器 
docker run  #启动并创建文件
docker start      
docker stop
docker ps # 查看运行状态
docker rm # 删除容器
docker logs # 查看容器日志
docker exec # 容器修改<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.docker.com/reference/">官方具体命令查询</a></p>
<h2 id="4-查看DockerHub，拉取nginx-镜像，创建运行Nginx容器"><a href="#4-查看DockerHub，拉取nginx-镜像，创建运行Nginx容器" class="headerlink" title="4. 查看DockerHub，拉取nginx 镜像，创建运行Nginx容器"></a>4. 查看DockerHub，拉取nginx 镜像，创建运行Nginx容器</h2><ul>
<li><p>在DockerHub搜索<a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.docker.com/_/nginx">Nginx镜像</a>，查看镜像名称</p>
</li>
<li><p>拉去Nginx 镜像: docker pull nginx</p>
</li>
<li><p>查看本地镜像列表: docker images</p>
<ul>
<li>保存打包至本地：docker save -o nginx.tar nginx:latest</li>
<li>读取容器： docker load -i nginx.tar</li>
</ul>
</li>
<li><p>创建并运行Nginx 容器：docker run -d –name nginx -p 80:80 nginx</p>
</li>
<li><p>查看运行的容器: docker ps </p>
</li>
<li><p>查看所有容器：docker ps -a</p>
</li>
<li><p>停止容器： docker stop nginx</p>
</li>
<li><p>再启动容器：docker start nginx</p>
</li>
<li><p>进入Nginx容器：docker exec -it nginx bash /docker exec -it mysql mysql -uroot -p</p>
<ul>
<li>退出命令：exit</li>
</ul>
</li>
<li><p>删除容器(运行时强行删除)：docker rm mysql -f</p>
</li>
</ul>
<h2 id="5-命令别名"><a href="#5-命令别名" class="headerlink" title="5. 命令别名"></a>5. 命令别名</h2><pre class="line-numbers language-none"><code class="language-none">vi ~/.bashrc

# 简化执行命令
alias dps='docker ps -format "table{{.ID}}\t{{.Image}}\t{{.Ports}}\t{{.Status}}\t{{.Names}}"' 

source ~/.ashrc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="6-数据卷"><a href="#6-数据卷" class="headerlink" title="6.数据卷"></a>6.数据卷</h2><p><img src="/../JavaEE/11.png" alt="数据卷映射文件，宿主机修改内容自动同步"></p>
<h3 id="1-数据卷挂载"><a href="#1-数据卷挂载" class="headerlink" title="1. 数据卷挂载"></a>1. 数据卷挂载</h3><p>数据卷(volume)是一个虚拟目录，容器内目录与宿主机目录之间映射的桥梁</p>
<ul>
<li>创建Nginx容器，修改Nginx 容器内的html目录的index.html文件，查看变化(/user/share/nginx/htmml),挂在数据卷： <ul>
<li>docker run -d –name nginx -p 80:80 -v html:/user/share/nginx/htmml nginx</li>
<li>docker volume inspect html</li>
</ul>
</li>
<li>将静态资源部署到Nginx 的html目录</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none"># 命令                  说明         
docker volume create    创建数据卷
docker volume ls        查看所有数据卷
docker volume rm        删除指定数据卷
docker volume inspect   查看某个数据卷的详情
docker volume prune     清除数据卷<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="2-mysql容器的数据挂载"><a href="#2-mysql容器的数据挂载" class="headerlink" title="2. mysql容器的数据挂载"></a>2. mysql容器的数据挂载</h3><ul>
<li><p>查看mysql容器，数据卷挂载(自动创建的匿名卷,当容器删除时Volume文件依然存在,但重配置容器容易文件丢失,且文件复制繁琐,所以手动挂载)</p>
<ul>
<li>docker inspect mysql</li>
</ul>
</li>
<li><p>基于宿主机目录实现 MySQL 数据目录、配置文件、初始化脚本的挂载<br>  docker run -d <br>  –name wabisabifag \<br>  -p 3306:3306 <br>  -e MYSQL_ROOT_PASSWORD=123 <br>  -e TZ=Asia/Shanghai <br>  -v /root/mysql/data:/var/lib/mysql \<br>  -v /root/mysql/init:/docker-entrypoint-initdb.d \<br>  -v /root/mysql/config:/etc/mysql/conf.d \<br>  mysql:5.7</p>
<p>  –network  wabisabifag \</p>
</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">hm.cnf
[client]
default_character_set=utf8mb4
[mysql]
default_character_set=utf8mb4
[mysqld]
character_set_server=utf8mb4
collation_server=utf8mb4_unicode_ci
init_connect='SET NAMES utf8mb4'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/../JavaEE/12.png" alt="格式要求"></p>
<h2 id="7-自定义镜像"><a href="#7-自定义镜像" class="headerlink" title="7. 自定义镜像"></a>7. 自定义镜像</h2><h3 id="1-镜像结构"><a href="#1-镜像结构" class="headerlink" title="1. 镜像结构"></a>1. 镜像结构</h3><ol>
<li>层(Layer)<br>添加安装包，依赖，配置等，每次操作都形成新的一层(每个操作压缩一个包)</li>
<li>基础镜像(BaseImages)<br>应用依赖的系统函数库、环境、配置、文件等</li>
<li>入口(Entrypoint)<br>镜像运行入口，一般程序启动的脚本和参数</li>
</ol>
<h4 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h4><p>Dockerfile 是一个文件夹，其中包含一个个指令(Instruction)<br><img src="/../JavaEE/13.png" alt="Dockerfile 指令"></p>
<pre class="line-numbers language-none"><code class="language-none">docker build -t myImage:1.0 .<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li><p>-t： 镜像名(格式：repository:tag)</p>
</li>
<li><p>. ： 指定Dockerfile所在目录，如果就在当前目录，则指定为”.”</p>
</li>
</ul>
<div class="tabs" id="基于ubuntu基础镜像"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#基于ubuntu基础镜像-1">基于Ubuntu基础镜像</button></li><li class="tab"><button type="button" data-href="#基于ubuntu基础镜像-2">基于JDK基础镜像</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="基于ubuntu基础镜像-1"><pre class="line-numbers language-none"><code class="language-none"># 指定基础镜像
FROM ubuntu:16.04
# 配置环境变量，3DK的安装目录、容器内时区
ENV JAVA_DIR=/usr/local
# 拷贝jdk和java项目的包
COPY ./jdk8.tar.gz $JAVA_DIR/
COPY ./docker-demo.jar /tmp/app.jar
# 安装JDK
RUN cd $JAVA_DIR \ &amp;&amp; tar -xf ./jdk8.tar.gz \
&amp;&amp; mv ./jdkl.8.0_144 ./java8
#配置环境变量
ENV JAVA_HOME=$JAVA_DIR/java8
ENV PATH=$PATH:$JAVA_HOME/bin
#入口，java项目的启动命令
ENTRYPOINT ["java", "-jar", "/app.jar"]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="基于ubuntu基础镜像-2"><pre class="line-numbers language-none"><code class="language-none"># 基础镜像
FROM openjdk:11.0-jre-bister
# 拷贝jar贝
COPY docker-demo.jar /app.jar
# 入口
ENTRYTPOINT ["java", "-jar", "/app.jar"]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bilibili.com/video/BV1HP4118797/?p=10&amp;spm_id_from=pageDriver&amp;vd_source=88d198aeee6b1ee29878c8ac870074a9">详细配置步骤</a></p>
<h2 id="8-网络"><a href="#8-网络" class="headerlink" title="8. 网络"></a>8. 网络</h2><ul>
<li>默认情况所有容器以bridge方式连接到Docker的一个虚拟网桥上：<br><img src="/../JavaEE/14.png" alt="bridge方式连接"></li>
</ul>
<h3 id="1-容器互联"><a href="#1-容器互联" class="headerlink" title="1. 容器互联"></a>1. 容器互联</h3><ul>
<li>加入自定义网络容器才可以通过容器互相访问，Docker的网络操作命令如下：<br><img src="/../JavaEE/15.png" alt="Docker的网络操作命令"></li>
</ul>
<h2 id="9-DockerCompose"><a href="#9-DockerCompose" class="headerlink" title="9. DockerCompose"></a>9. DockerCompose</h2><p>Docker Compose 通过一个单独的docker-compose.yml模版文件(YAML格式)定义一组相关联的应用容器，帮助我们实现 多个相互关联的Docker容器的快速部署。</p>
<ul>
<li>一键部署</li>
<li>集群部署<br><img src="/../JavaEE/16.png" alt="docker-compose.yml模版文件"></li>
</ul>
<h3 id="1-docker-compose-命令格式"><a href="#1-docker-compose-命令格式" class="headerlink" title="1. docker compose 命令格式"></a>1. docker compose 命令格式</h3><p><img src="/../JavaEE/20.png" alt="docker-compose.yml模版文件"></p>
<ol>
<li>比较命令行和docker-compose.yml 文件<br><img src="/../JavaEE/17.png" alt="docker-compose.yml模版文件"></li>
</ol>
<h3 id="2-docker-compose-yml一键部署"><a href="#2-docker-compose-yml一键部署" class="headerlink" title="2. docker-compose.yml一键部署"></a>2. docker-compose.yml一键部署</h3><pre class="line-numbers language-none"><code class="language-none">docker compose up -d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/../JavaEE/18.png" alt="docker-compose.yml模版文件"></p>
<p><img src="/../JavaEE/19.png" alt="docker-compose.yml模版文件"></p>
<h1 id="3-Redis"><a href="#3-Redis" class="headerlink" title="3.Redis"></a>3.Redis</h1><h2 id="1-Redis-基础"><a href="#1-Redis-基础" class="headerlink" title="1.Redis 基础"></a>1.Redis 基础</h2><h3 id="1-初识Redis"><a href="#1-初识Redis" class="headerlink" title="1.初识Redis"></a>1.初识Redis</h3><h4 id="1-认识NoSQL"><a href="#1-认识NoSQL" class="headerlink" title="1.认识NoSQL"></a>1.认识NoSQL</h4><ul>
<li>SQL<ul>
<li>数据结构: 结构化</li>
<li>数据关联: 关系型<ul>
<li>外键表关联</li>
</ul>
</li>
<li>查询方式: SQL<ul>
<li>SELECT id FROM td_user WHERE id=1;</li>
</ul>
</li>
<li>事务特性: ACID(安全)</li>
<li>扩展性: 垂直</li>
<li>使用场景:<ul>
<li>数据结构固定</li>
<li>相关业务对数据安全性、一致性要求高</li>
</ul>
</li>
</ul>
</li>
<li>NoSQL<ul>
<li>数据结构: 非结构化<ul>
<li>key:value 键值对类型(Redis)</li>
<li>Document  文档类型(MongoDB)</li>
<li>Graph   图(Neo4j)</li>
<li>列类型(HBase)</li>
</ul>
</li>
<li>数据关联: 非关系型</li>
<li>查询方式: 非SQL<ul>
<li>Redis: get user:1</li>
<li>MongDB: db.users.find({_id:1})</li>
<li>elasticsearch GET <a target="_blank" rel="noopener external nofollow noreferrer" href="http://localhost:9200/users/1">http://localhost:9200/users/1</a></li>
</ul>
</li>
<li>事务特性: BASE</li>
<li>扩展性: 水平</li>
<li>使用场景:<ul>
<li>数据结构不固定</li>
<li>相关业务对数据安全性、一致性要求不高 </li>
<li>对性能要求高</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="2-认识Redis"><a href="#2-认识Redis" class="headerlink" title="2.认识Redis"></a>2.认识Redis</h4><p>Remote Dictionary Server(远程词典服务器)是一个基于内存的键值型单线程NoSQL数据库。</p>
<ul>
<li>特征：<ul>
<li>键值型，value支持多种不同数据结构，功能丰富</li>
<li>单线程，每个命令具备原子性</li>
<li>低延迟，速度快(基于内存、IO多路复用、良好的编码)</li>
<li>支持数据持久化</li>
<li>支持主从集群、分片集群</li>
<li>支持多语言客户端</li>
</ul>
</li>
</ul>
<h4 id="3-安装Redis"><a href="#3-安装Redis" class="headerlink" title="3.安装Redis"></a>3.安装Redis</h4><h5 id="1-Redis指定配置启动"><a href="#1-Redis指定配置启动" class="headerlink" title="1.Redis指定配置启动"></a>1.Redis指定配置启动</h5><pre class="line-numbers language-none"><code class="language-none">// 备份源文件
cp redis.conf redis.conf.bck

// 监听地址：127.0.0.1 本地访问  修改为 0.0.0.0 可以在任意IP访问
bind 0.0.0.0
# 守护进程，修改为 yes 后台运行
daemonize yes
# 密码，设置后访问 Redis 必须输入密码
requirepass 123456

# 设置数据库数量，默认16，编号0-15
database 1
# 最大使用内存
maxmemory 512mb
# 日志文件、默认为空，可指定日志文件名
logfile "redis.log"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="2-开机自启"><a href="#2-开机自启" class="headerlink" title="2.开机自启"></a>2.开机自启</h5><pre class="line-numbers language-none"><code class="language-none"># 新建系统服务文件
vi /etc/systemd/system/redis.service

########  文件
[Unit]
Description=redis-server
After=network.target

[Service]
Type=forking
ExecStart=/usr/local/bin/redis-server /usr/local/src/redis-6.2.6/redis.conf
PrivateTmp=true
[Install]
WantedBy=multi-user.target


# 重载系统服务
systemctl daemon-reload

# 启动Redis 
systemctl start redis

# 开机自启
systemctl enable redis<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="3-Redis客服端"><a href="#3-Redis客服端" class="headerlink" title="3.Redis客服端"></a>3.Redis客服端</h5><h6 id="1-命令行客户端"><a href="#1-命令行客户端" class="headerlink" title="1.命令行客户端"></a>1.命令行客户端</h6><p>redis-cli [options] [commonds]</p>
<ul>
<li>options<ul>
<li>-h 127.0.0.1: 指定连接的Redis节点的IP地址</li>
<li>-p 6379: 指定要连接的Redis节点的端口(不建议)<ul>
<li>在连接Redis后 通过: AUTH 123321 (与Redis服务端做心跳测试)</li>
</ul>
</li>
<li>-a 123456: 指定Redis访问密码</li>
</ul>
</li>
<li>commonds<ul>
<li>ping: 与Redis服务端做心跳测试。服务端正常返回 pong。不指定commond时，会进入 redis-cli的交互控制台</li>
</ul>
</li>
</ul>
<h6 id="2-图形化桌面客户端"><a href="#2-图形化桌面客户端" class="headerlink" title="2.图形化桌面客户端"></a>2.图形化桌面客户端</h6><ul>
<li>GitHub用户编写的<a href="https://github.com/uglide/RedisDesktopManager">Redis图形化桌面客户端</a>(未提供Windows安装包,需要付费使用)</li>
<li>提供免费的<a href="https://github.com/lework/RedisDesktopManager-Windows/releases">Redis图形化桌面客户端</a></li>
</ul>
<pre class="line-numbers language-none"><code class="language-none"># 更换Redis库名
select 0
# 存 取 数据操作
set  get<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-Redis常见命令"><a href="#2-Redis常见命令" class="headerlink" title="2.Redis常见命令"></a>2.Redis常见命令</h3><h4 id="1-5种常见数据结构"><a href="#1-5种常见数据结构" class="headerlink" title="1.5种常见数据结构"></a>1.5种常见数据结构</h4><h5 id="1-Redis数据结构"><a href="#1-Redis数据结构" class="headerlink" title="1.Redis数据结构"></a>1.Redis数据结构</h5><ul>
<li>基本类型<ul>
<li>String</li>
<li>Hash:<ul>
<li>{name:”jack”,age:21}</li>
</ul>
</li>
<li>List:<ul>
<li>[A -&gt; B -&gt;C]</li>
</ul>
</li>
<li>Set(无序,不可重复):<ul>
<li>{A,B,C}</li>
</ul>
</li>
<li>SortedSet:<ul>
<li>{A:1,B:2,C:3}</li>
</ul>
</li>
</ul>
</li>
<li>特殊类型<ul>
<li>GEO:<ul>
<li>{A:(120.3,30.5)}</li>
</ul>
</li>
<li>BitMap:<ul>
<li>0110110101110101011</li>
</ul>
</li>
<li>HyperLog:<ul>
<li>0110110101110101011</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://redis.io/commands">Redis 数据结构类型命令文档</a></p>
<h5 id="2-Redis通用命令-Keys"><a href="#2-Redis通用命令-Keys" class="headerlink" title="2.Redis通用命令(Keys)"></a>2.Redis通用命令(Keys)</h5><ul>
<li>KEYS 查看所有符合模版<ul>
<li>KEYS *  模糊查询</li>
</ul>
</li>
<li>DEL 删除一个或多个key值<ul>
<li>DEL *</li>
</ul>
</li>
<li>EXISTS 判断key存在</li>
<li>EXPIRE 设置key的有效期<ul>
<li>EXPIRE age 20</li>
</ul>
</li>
<li>TTL 查看key剩余有效期(-1：永久有效)<ul>
<li>TTL age</li>
</ul>
</li>
</ul>
<p>通过help [command] 查看命令具体使用方法</p>
<h5 id="3-String类型"><a href="#3-String类型" class="headerlink" title="3.String类型"></a>3.String类型</h5><ul>
<li>String类型分为三类<ul>
<li>String：字符串(&lt;512m)</li>
<li>int：可做自增自减操作</li>
<li>float：可做自增自减操作<br>底层都是字节数据形式存储，但是编码方式不同。<br>字符串类型的最大空间不超过512m</li>
</ul>
</li>
</ul>
<h6 id="1-String的常见命令有："><a href="#1-String的常见命令有：" class="headerlink" title="1.String的常见命令有："></a>1.String的常见命令有：</h6><ul>
<li><p>SET:添加或者修改已经存在的一个String类型的键值对</p>
</li>
<li><p>GET:根据key获取String类型的value</p>
</li>
<li><p>MSET:批量添加多个String类型的键值对</p>
</li>
<li><p>MGET:根据多个key获取多个String类型的value</p>
</li>
<li><p>INCR:让一个整型的key自增1</p>
</li>
<li><p>DECR:让一个整型的key自减1</p>
</li>
<li><p>INCRBY:让一个整型的key自增并指定步长，例如：incrby num 2让num值自增2</p>
</li>
<li><p>INCRBYFLOAT：让一个浮点类型的数字自增并指定步长</p>
</li>
<li><p>SETNX:新增一个String类型的键值对,前提是这个key不存在，否则不执行</p>
</li>
<li><p>SETEX:新增一个String类型的键值对,并且指定有效期</p>
</li>
</ul>
<h6 id="2-key的结构"><a href="#2-key的结构" class="headerlink" title="2.key的结构"></a>2.key的结构</h6><p>Redis允许多个单词形成层级结构，多个单词间用’:’，格式如下：</p>
<ul>
<li>项目名:业务名:类型:id<ul>
<li>user相关key： wabisabifag:user:1<ul>
<li>vaule: get  {“id”:1,”name”:”Jack”,”age”:21}</li>
</ul>
</li>
<li>video相关key:  wabisabifag:video:1<ul>
<li>value:  {“id”:1,”name”:”OPPO”,”price”:2100}<pre class="line-numbers language-none"><code class="language-none"># 注意 value 用 单引号
set wabisabifag:user:1 '{"id":1,"name":"Jack","age":21}'
GET wabisabifag:user:1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<img src="/../JavaEE/21.png" alt="Redis图形化界面显示层级关系图"></li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="4-Hash类型"><a href="#4-Hash类型" class="headerlink" title="4.Hash类型"></a>4.Hash类型</h5><p>Hash类型(散列),value是一个无序字典，类似java的HashMap结构。</p>
<ul>
<li>String结构对象序列化为JSON字符串后存储，当修改对象某个字段时不方便<br><img src="/../JavaEE/23.png" alt="String结构数据"></li>
<li>Hash结构可以将对象的每个字段独立存储，可针对单个字段做CRUD<br><img src="/../JavaEE/22.png" alt="Hash结构数据"></li>
</ul>
<h6 id="1-Hash的常见命令有："><a href="#1-Hash的常见命令有：" class="headerlink" title="1.Hash的常见命令有："></a>1.Hash的常见命令有：</h6><ul>
<li><p>HSET key field value:添加或者修改hash类型key的field的值</p>
</li>
<li><p>HGET key field:获取一个 hash 类型 key 的 field 的值</p>
</li>
<li><p>HMSET:批量添力口多个hash类型key的field的值 a</p>
</li>
<li><p>HMGET:批量获取多个hash类型key的field的值</p>
</li>
<li><p>HGETALL:获取一个hash类型的key中的所有的field和value</p>
</li>
<li><p>HKEYS:获取一个hash类型的key中的所有的field</p>
</li>
<li><p>HVALS:获取一个hash类型的key中的所有的value</p>
</li>
<li><p>HINCRBY:让一个hash类型key的字段值自增并指定步长</p>
<ul>
<li>HINCRBY wabisabi:user:1 age -2</li>
</ul>
</li>
<li><p>HSETNX:添加一个hash类型的key的field值，前提是这个field不存在</p>
</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">HMSET wabisabifag:user:1 name wabisabifag age 20 gender man<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/../JavaEE/24.png" alt="Hash结构数据层级存储"></p>
<h5 id="5-List类型"><a href="#5-List类型" class="headerlink" title="5.List类型"></a>5.List类型</h5><p>Redis的List类型是一个双向链表结构，可以双向检索</p>
<h6 id="1-List特征"><a href="#1-List特征" class="headerlink" title="1.List特征"></a>1.List特征</h6><ul>
<li>有序</li>
<li>元素可重复</li>
<li>插入和删除快</li>
<li>查询速度一般</li>
</ul>
<h6 id="2-List的常见命令"><a href="#2-List的常见命令" class="headerlink" title="2.List的常见命令"></a>2.List的常见命令</h6><ul>
<li><p>LPUSH key element… :向列表左侧插入一个或多个元素</p>
</li>
<li><p>LPOP key:移除并返回列表左侧的第一个元素，没有则返回nil</p>
</li>
<li><p>RPUSH key element… :向列表右侧插入一个或多个元素</p>
</li>
<li><p>RPOP key:移除并返回列表右侧的第一个元素</p>
</li>
<li><p>LRANGE key star end:返回一段角标范围内的所有元素</p>
</li>
<li><p>BLPOP和BRPOP：与LPOP和RPOP类似，只不过在没有元素时等待指定时间，而不是直接返回而</p>
</li>
</ul>
<p><img src="/../JavaEE/25.png" alt="List类型结构操作机制原理"></p>
<pre class="line-numbers language-none"><code class="language-none"># 阻塞式获取等待(user2不存在，等待时间100s)
BLPOP user2 100<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h6 id="3-模拟-栈-功能"><a href="#3-模拟-栈-功能" class="headerlink" title="3.模拟 栈 功能"></a>3.模拟 栈 功能</h6><ol>
<li>List结构模拟栈</li>
</ol>
<ul>
<li>入口和出口在同一边</li>
</ul>
<ol start="2">
<li>List结构模拟队列</li>
</ol>
<ul>
<li>入口和出口不在同一边</li>
</ul>
<ol start="3">
<li>List结构模拟阻塞队列</li>
</ol>
<ul>
<li>入口和出口不在同一边</li>
<li>出队时采用BLPOP或BRPOP</li>
</ul>
<h5 id="6-Set类型"><a href="#6-Set类型" class="headerlink" title="6.Set类型"></a>6.Set类型</h5><p>Redis的Set结构是一个value为null的HashMap，应为是一个hash表，因此具备HashSet类似特征(社交关系应用)</p>
<ul>
<li>无序</li>
<li>元素不可重复</li>
<li>查询快</li>
<li>支持交集、并集、差集等功能</li>
</ul>
<h6 id="1-Set的常见命令"><a href="#1-Set的常见命令" class="headerlink" title="1.Set的常见命令"></a>1.Set的常见命令</h6><ul>
<li><p>SADD key member…:向set中添加一个或多个元素</p>
</li>
<li><p>SREM key member…：移除set中的指定元素</p>
</li>
<li><p>SCARD key:返回set中元素的个数 </p>
</li>
<li><p>SMEMBERS:获取set中的所有元素          </p>
</li>
<li><p>SISMEMBER key member:判断一个元素是否存在于set中</p>
</li>
<li><p>SINTER keyl key2 …:求keyl与key2的交集</p>
</li>
<li><p>SDIFF keyl key2 …:求keyl 与key2的差集</p>
</li>
<li><p>SUNION keyl key2 求keyl和key2的并集</p>
</li>
</ul>
<p><img src="/../JavaEE/26.png" alt="Set类型结构操作机制原理"></p>
<h5 id="7-SortedSet类型"><a href="#7-SortedSet类型" class="headerlink" title="7.SortedSet类型"></a>7.SortedSet类型</h5><p>Redis的SortedSet是一个可排序的set集合</p>
<h6 id="1-SortedSet特性"><a href="#1-SortedSet特性" class="headerlink" title="1.SortedSet特性"></a>1.SortedSet特性</h6><p>SortedSet中的每一个元素都带一个score属性，基于score属性对元素排序，底层的实现是一个跳表(SkipList)加Hash表</p>
<h6 id="2-SortedSet的常见命令"><a href="#2-SortedSet的常见命令" class="headerlink" title="2.SortedSet的常见命令"></a>2.SortedSet的常见命令</h6><ul>
<li><p>ZADD key score member:添加一个或多个元素到sorted set,如果已经存在则更新其score值</p>
</li>
<li><p>ZREM key member:删除sorted set中的一个指定元素</p>
</li>
<li><p>ZSCORE key member:获取sorted set中的指定元素的score值</p>
</li>
<li><p>ZRANK key member:获取sorted set中的指定元素的排名</p>
</li>
<li><p>ZCARD key:获取sorted set中的元素个数</p>
</li>
<li><p>ZCOUNT key min max:统计score值在给定范围内的所有元素的个数</p>
</li>
<li><p>ZINCRBY key increment member:让sorted set中的指定元素自增，步长为指定的increment值</p>
</li>
<li><p>ZRANGE key min max:按照score排序后，获取指定排名范围内的元素</p>
</li>
<li><p>ZRANGEBYSCORE key min max:按照score排序后，获取指定score范围内的元素</p>
</li>
<li><p>ZDIFF、ZINTER. ZUNION：求差集、交集、并集<br>注意: 排名默认升序，降序排序格式 Z+rev+语法。例如: ZREVINCRBY key increment member</p>
</li>
</ul>
<h3 id="3-Redis的Java客户端"><a href="#3-Redis的Java客户端" class="headerlink" title="3.Redis的Java客户端"></a>3.Redis的Java客户端</h3><p>在Redis官网中提供各种语言<a target="_blank" rel="noopener external nofollow noreferrer" href="https://redis.io/clients">Redis的客户端</a></p>
<h4 id="1-Jedis客户端"><a href="#1-Jedis客户端" class="headerlink" title="1.Jedis客户端"></a>1.Jedis客户端</h4><p>Spring Data Redis 整合Jedis和lettuce</p>
<ul>
<li><a href="https://github.com/redis/jedis">Jedis</a>以Redis命令作为方法名称，学习成本低，简单实用。但是Jedis实例线程不安全，多线程环境下需要基于连接池使用</li>
<li>lettuce基于Netty实现，支持同步、异步、和响应式编程方式，线程安全。支持Redis的哨兵模式、集群模式和管道模式</li>
<li>Redisson是基于Redis实现的分布式、可伸缩的Java数据结构集合，包含Map、Queue、Lock、Semaphore、AtomicLong等功能</li>
</ul>
<h5 id="1-Springboot整合Jedis"><a href="#1-Springboot整合Jedis" class="headerlink" title="1.Springboot整合Jedis"></a>1.Springboot整合Jedis</h5><div class="tabs" id="引入依赖"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#引入依赖-1">引入依赖</button></li><li class="tab"><button type="button" data-href="#引入依赖-2">建立连接</button></li><li class="tab"><button type="button" data-href="#引入依赖-3">建立Pool连接池</button></li><li class="tab"><button type="button" data-href="#引入依赖-4">引入依赖 4</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="引入依赖-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--jedis--&gt;
  &lt;dependency&gt;
      &lt;groupId&gt;redis.clients&lt;/groupId&gt;
      artifactId&gt;jedis&lt;/artifactId&gt;
  &lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="引入依赖-2"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.test;

import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import redis.clients.jedis.Jedis;
import top.wabisabifag.util.JedisConnectionFactory;

public class JedisTest {
    private RedisProperties.Jedis jedis;

    @BeforeEach
    void setUp(){
        // 1.建立连接
        jedis = new RedisProperties.Jedis();
        // 2.设置密码
        jedis.auth("123456");
        // 3.选择库
        jedis.select(0);
    }

    @Test
    void testString(){
        // 存入数据
        String result = jedis.set("name","Tigger");
        System.out.println("result="+result);
        // 获取数据
        String name = jedis.get("name");
        System.out.println("name="+name);
    }

    @Test
    void testHash(){
        //插入Hash数据
        jedis.hset("user:1","name","jack");
        jedis.hset("user:1","age","20");
        // 获取
        Map&lt;String,String&gt; map=jedis.hgetAll("user:1");
    }

    @AfterEach
    void tearDown(){
        // 4. 关闭资源
        if (jedis!=null){
            jedis.close();
        }
    }

}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="引入依赖-3"><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.util;

import redis.clients.jedis.Jedis;
import redis.clients.jedis.JedisPool;
import redis.clients.jedis.JedisPoolConfig;

public class JedisConnectionFactory {
    private static final JedisPool jedisPool;

    static {
        // 配置连接池
        JedisPoolConfig poolConfig = new JedisPoolConfig();
        poolConfig.setMaxTotal(8);
        poolConfig.setMaxIdle(8);
        poolConfig.setMaxIdle(0);
        poolConfig.setMaxWaitMillis(100);

        // 创建连接池对象
        jedisPool = new JedisPool(poolConfig,
                "192.168.0.0.1",6379,100,"123456");
    }

    public static Jedis getJedis(){
        return jedisPool.getResource();
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="引入依赖-4"><p>package top.wabisabifag.test;</p>
<p>import org.junit.jupiter.api.AfterEach;<br>import org.junit.jupiter.api.BeforeEach;<br>import org.junit.jupiter.api.Test;<br>import redis.clients.jedis.Jedis;<br>import top.wabisabifag.util.JedisConnectionFactory;</p>
<p>import java.util.Map;</p>
<p>public class JedisTest {<br>    private Jedis jedis;</p>
<pre><code>@BeforeEach
void setUp(){
    // 1.建立连接
    jedis = JedisConnectionFactory.getJedis();
    // 2.设置密码
    jedis.auth("123456");
    // 3.选择库
    jedis.select(0);
}
@Test
void testString(){
    // 存入数据
    String result = jedis.set("name","Tigger");
    System.out.println("result="+result);
    // 获取数据
    String name = jedis.get("name");
    System.out.println("name="+name);
}
@Test
void testHash(){
    //插入Hash数据
    jedis.hset("user:1","name","jack");
    jedis.hset("user:1","age","20");
    // 获取
    Map&lt;String,String&gt; map=jedis.hgetAll("user:1");
}

@AfterEach
void tearDown(){
    // 4. 关闭资源
    if (jedis!=null){
        jedis.close();
    }
}
</code></pre>
<p>}</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<h4 id="2-SpringDataRedis-客户端"><a href="#2-SpringDataRedis-客户端" class="headerlink" title="2.SpringDataRedis 客户端"></a>2.SpringDataRedis 客户端</h4><p>SpringData是Spring中数据操作的模块，包含对各种数据库的集成，其中Redis的集成模块叫做<a target="_blank" rel="noopener external nofollow noreferrer" href="http://spring.io/project/spring-data-redis">SpringDataRedis</a></p>
<ul>
<li>提供了对不同Redis客户端的整耳（Lettuce和Jedis）</li>
<li>提供了 RedisTemplate 统一API 来操作 Redis</li>
<li>支持Redis的发布订阅模型</li>
<li>支持Redis哨兵和Redis集群</li>
<li>支持基于Lettuce的响应式编程</li>
<li>支持基于JDK、JSON、字符串、Spring对象的数据序列化及反序列化</li>
<li>支持基于Rudis的JDKCoUection实现</li>
</ul>
<h5 id="1-RedisTemplate工具类"><a href="#1-RedisTemplate工具类" class="headerlink" title="1.RedisTemplate工具类"></a>1.RedisTemplate工具类</h5><p>SpringDataRedis中提供了RedisTemplate工具类,其中封装了各种对Redis的操作。并且将不同数据类型的操作API封 装到了不同的类型中：<br>API              </p>
<ul>
<li><p>rednsTemplate.opsForValue() </p>
<ul>
<li>ValueOperations   操作String类型数据</li>
</ul>
</li>
<li><p>redisTemplate.opsForHash()   </p>
<ul>
<li>Hashoperations    操作Hash类型数据</li>
</ul>
</li>
<li><p>red-isTemplate.opsForList() </p>
<ul>
<li>Listoperations    操作List类型数据</li>
</ul>
</li>
<li><p>redisTemplate.opsForSet ()  </p>
<ul>
<li>SetOperations     操作Set类型数据</li>
</ul>
</li>
<li><p>redisTemplate.opsForZSet()  </p>
<ul>
<li>ZSetOperations    操作SortedSet类型数据</li>
</ul>
</li>
<li><p>redisTemplate     通用的命令</p>
</li>
</ul>
<h6 id="1-SpringBoot-配置序列化类"><a href="#1-SpringBoot-配置序列化类" class="headerlink" title="1.SpringBoot 配置序列化类"></a>1.SpringBoot 配置序列化类</h6><pre class="line-numbers language-none"><code class="language-none">package top.wabisabifag.config;

import com.fasterxml.jackson.annotation.JsonAutoDetect;
import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonTypeInfo;
import com.fasterxml.jackson.annotation.PropertyAccessor;
import com.fasterxml.jackson.databind.DeserializationFeature;
import com.fasterxml.jackson.databind.MapperFeature;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializationFeature;
import com.fasterxml.jackson.databind.jsontype.impl.LaissezFaireSubTypeValidator;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.connection.RedisConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;
import org.springframework.data.redis.serializer.StringRedisSerializer;

import javax.annotation.Resource;
import java.text.SimpleDateFormat;
import java.util.TimeZone;

@Configuration
public class MyRedisConfig {

    @Resource
    private RedisConnectionFactory factory;

    @Bean
    public RedisTemplate redisTemplate(){
        RedisTemplate&lt;String,Object&gt; redisTemplate = new RedisTemplate&lt;&gt;();
        redisTemplate.setConnectionFactory(factory);
        redisTemplate.setKeySerializer(new StringRedisSerializer());

        // String 类型序列化 json
        Jackson2JsonRedisSerializer&lt;Object&gt; serializer = new Jackson2JsonRedisSerializer&lt;&gt;(Object.class);
        redisTemplate.setValueSerializer(serializer);

        ObjectMapper om = new ObjectMapper();
        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);
        om.setDateFormat(new SimpleDateFormat("yyyy-MM-dd HH:mm:ss"));
                om.setTimeZone(TimeZone.getDefault());
        om.configure(MapperFeature.USE_ANNOTATIONS, false);
        om.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);
        om.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, false);
        om.activateDefaultTyping(LaissezFaireSubTypeValidator.instance
                ,ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY);
        om.setSerializationInclusion(JsonInclude.Include.NON_NULL);
        serializer.setObjectMapper(om);

        return redisTemplate;
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="2-SpringDataRedis整合"><a href="#2-SpringDataRedis整合" class="headerlink" title="2.SpringDataRedis整合"></a>2.SpringDataRedis整合</h5><div class="tabs" id="引入依赖"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#引入依赖-1">引入依赖</button></li><li class="tab"><button type="button" data-href="#引入依赖-2">配置文件</button></li><li class="tab"><button type="button" data-href="#引入依赖-3">注入API测试编写</button></li><li class="tab"><button type="button" data-href="#引入依赖-4">手动序列化</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="引入依赖-1"><pre class="line-numbers language-none"><code class="language-none">&lt;!--jedis--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;redis.clients&lt;/groupId&gt;
    &lt;artifactId&gt;jedis&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!--连接池依赖--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
    &lt;artifactId&gt;commons-pool2&lt;/artifactId&gt;
&lt;/dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="引入依赖-2"><pre class="line-numbers language-none"><code class="language-none">spring:
  redis:
    host: localhost
    port: 6379
    client-type: jedis
    password: 123456
    lettuce:
      pool:
        max-active: 16
        max-idle: 8
        min-idle: 0
        max-wait: 100
    jedis:
      pool:
        max-active: 16
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="引入依赖-3"><pre class="line-numbers language-none"><code class="language-none">@SpringBootTest
public class RedisTest{

    // 以对象 操作的基本单元
    // 客服端 : RedisTemplate 以对象作为Key 和 Value，内部对数据进行序列化 操作    
    @Autowired
    private RedisTemplate redisTemplate;

    @Test
    public void setRedisTemplate(){
        ValueOperations ops = redisTemplate.opsForValue();
        ops.set("age",42);
        Object age = redisTemplate.opsForValue().get("age");
        System.out.println(age);
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="引入依赖-4"><pre class="line-numbers language-none"><code class="language-none">@SpringBootTest
public class RedisTest{

    // 以对象 操作的基本单元
    // 客服端 : RedisTemplate 以对象作为Key 和 Value，内部对数据进行序列化 操作    
    @Autowired
    private StringRedisTemplate stringRedisTemplate;
    private static final ObjectMapper mapper = new ObjectMapper();
    @Test
    public void setAndGetRedisTemplate(){
      stringRedisTemplate.opsForValue().set("age",42);
      Object age = stringRedisTemplate.opsForValue().get("age");
       
      User user = new User("Jack",21);

      // 手动序列化
      String JSON = mapper.writeValueAsString(user);
      stringRedisTemplate.opsForValue().set("user:1",JSON);
      String jsonUser = stringRedisTemplate.opsForValue().get("user:1");
      
      User user1 = mapper.readValue(jsonUser,User.class);
      System.out.print("user1"+user1);


    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
<h2 id="4-Axios"><a href="#4-Axios" class="headerlink" title="4.Axios"></a>4.Axios</h2><p><a href="https://github.com/axios/axios">Axios</a>是开源的在浏览器和Node.js的异步通信框架，她的主要作用就是实现AJAX异步通信</p>
<h3 id="1-Axios特性"><a href="#1-Axios特性" class="headerlink" title="1.Axios特性"></a>1.Axios特性</h3><ul>
<li>从浏览器中创建 XMLHttpRequests</li>
<li>从 node.js 创建 http 请求</li>
<li>支持 Promise API</li>
<li>拦截请求和响应</li>
<li>转换请求数据和响应数据</li>
<li>取消请求</li>
<li>自动转换 JSON 数据</li>
<li>客服端支持防御 XSRF(跨站请求伪渣)</li>
</ul>
<h2 id="5-redis课程笔记"><a href="#5-redis课程笔记" class="headerlink" title="5.redis课程笔记"></a>5.redis课程笔记</h2><h3 id="2-Axios-使用"><a href="#2-Axios-使用" class="headerlink" title="2.Axios 使用"></a>2.Axios 使用</h3><h4 id="1-安装vue-axios"><a href="#1-安装vue-axios" class="headerlink" title="1.安装vue axios"></a>1.安装vue axios</h4><h5 id="1-下载-vue-axios"><a href="#1-下载-vue-axios" class="headerlink" title="1.下载 vue-axios"></a>1.下载 vue-axios</h5><pre class="line-numbers language-none"><code class="language-none">npm install --save axios vue-axios<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h5 id="2-在main-js-引入"><a href="#2-在main-js-引入" class="headerlink" title="2.在main.js 引入"></a>2.在main.js 引入</h5><pre class="line-numbers language-none"><code class="language-none">import Vue from 'vue'
import axios from 'axios'
import VueAxios from 'vue-axios'

Vue.use(VueAxios,axios)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="3-发送axios请求"><a href="#3-发送axios请求" class="headerlink" title="3.发送axios请求"></a>3.发送axios请求</h5><pre class="line-numbers language-none"><code class="language-none">import axios from "axios";
import Qs from 'qs'

 methods: {
        getData() {
            const _this = this;
            axios.get("http://localhost:8081/student/findAll").then(function (resp) {
                console.log(response);
                _this.tableData = resp.data;
            })
        }
 }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="4-SpringMVC-解决跨域问题"><a href="#4-SpringMVC-解决跨域问题" class="headerlink" title="4.SpringMVC 解决跨域问题"></a>4.SpringMVC 解决跨域问题</h5><pre class="line-numbers language-none"><code class="language-none">&lt;mvc:cors&gt;
  &lt;mvc:mapping path="/**"
    allowed-originPatterns="*"
    allowed-methods="GET,POST,PUT,DELETE,OPTIONS,PATCH"
    allow-credentials="true"
    allowed-headers="Content-Type,Access-Control-Allow-Headers,Authorization,X-Requestes-With" /&gt;
&lt;/mvc:cors&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h6 id="1-解决axios无法传递data中的参数问题"><a href="#1-解决axios无法传递data中的参数问题" class="headerlink" title="1.解决axios无法传递data中的参数问题"></a>1.解决axios无法传递data中的参数问题</h6><pre class="line-numbers language-none"><code class="language-none">默认情况下发送axios时请求头内容类型：
Content-Type:application/json;charset=UTF-8

实际服务端需要的：
Content-Type:application/x-www-form-urlencoded

因此，使用axios内置库中的方法进行内容类型的转换：
import Qs from 'qs'

this.axios({
  method: 'post',
  url: 'http://localhost:8081/reqist',
  transformRequest: [function(data){
    return Qs.stringify(data)
  }],
  data:{
    email: this.email
  }
}) 
  .then(function(response){
    alert(response.data.message)
  });<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>








<h1 id="9-MyBatis入门"><a href="#9-MyBatis入门" class="headerlink" title="9.MyBatis入门"></a>9.MyBatis入门</h1><h2 id="1-数据持久层框架"><a href="#1-数据持久层框架" class="headerlink" title="1.数据持久层框架"></a>1.数据持久层框架</h2><h3 id="1-数据持久层"><a href="#1-数据持久层" class="headerlink" title="1.数据持久层"></a>1.数据持久层</h3><p>数据持久化指的将内存中的数据保存到磁盘中加以“固化”，几乎所有的应用系统都需要数据持久化。<br>持久化的实现通过将数据存储在各种关系型数据库中完成。<br>因此在应用框架中，一个相对独立的逻辑层，专注于数据持久化逻辑的实现，该逻辑层通常被称为“数据持久层”。</p>
<h3 id="2-ORM"><a href="#2-ORM" class="headerlink" title="2.ORM"></a>2.ORM</h3><p>ORM一般指持久化数据和实现对象的映射。<br>ORM框架一般采用XML格式描述对象关系的映射细节，并且将其存放在专门的映射文件中。</p>
<h2 id="2-Mybatis框架"><a href="#2-Mybatis框架" class="headerlink" title="2.Mybatis框架"></a>2.Mybatis框架</h2><p>Mybatis可以使用简单的XML代码或注解，将原生类型，接口和Jav的POJO配置映射为数据库中的记录。</p>
<h3 id="MyBatis特点"><a href="#MyBatis特点" class="headerlink" title="MyBatis特点"></a>MyBatis特点</h3><h4 id="1-简单易学"><a href="#1-简单易学" class="headerlink" title="1.简单易学"></a>1.简单易学</h4><p>下载JAR包，配置SQL映射文件</p>
<h4 id="2-灵活"><a href="#2-灵活" class="headerlink" title="2.灵活"></a>2.灵活</h4><p>SQl语句写在XML文件中，便于统一管理和优化。<br>解除SQL语句与程序代码的耦合，提供数据持久层，将业务逻辑和数据访问逻辑分离，使得系统设计更清晰，易维护，容易单元测试。</p>
<h4 id="3-提供映射标签"><a href="#3-提供映射标签" class="headerlink" title="3.提供映射标签"></a>3.提供映射标签</h4><p>支持对象和数据库的ORM字段关系映射，支持对象关系组建维护，提供XML标签，支持动态SQL。<br>相比较Hibernate设计理念完全面向POJO，MyBatis更适合网络性业务的灵活变化。</p>
<h2 id="3-MyBatis工作原理"><a href="#3-MyBatis工作原理" class="headerlink" title="3.MyBatis工作原理"></a>3.MyBatis工作原理</h2><h3 id="1-MyBatis核心类"><a href="#1-MyBatis核心类" class="headerlink" title="1.MyBatis核心类"></a>1.MyBatis核心类</h3><h4 id="1-Configuration"><a href="#1-Configuration" class="headerlink" title="1.Configuration"></a>1.Configuration</h4><p>MyBatis的所有的配置信息都保存在Configuration对象中，XML配置文件中的大部分配置会存储在该类。<br>此外，提供设置配置信息的方法。Configuration可以从XML配置文件中获取属性值，也可以通过程序直接配置。</p>
<h4 id="2-SqlSessionFactory"><a href="#2-SqlSessionFactory" class="headerlink" title="2.SqlSessionFactory"></a>2.SqlSessionFactory</h4><p>每个居于MyBtis的项目都通过SQL Session Factory的实列为中心</p>
<h4 id="3-SqlSession"><a href="#3-SqlSession" class="headerlink" title="3.SqlSession"></a>3.SqlSession</h4><p>MyBatis的主要顶层API，SQL Session表示和数据库交互时的会话，完全包含面向数据库执行SQL语句所需要的所有方法。</p>
<h5 id="SqlSession的实现类"><a href="#SqlSession的实现类" class="headerlink" title="SqlSession的实现类"></a>SqlSession的实现类</h5><h6 id="1-DefaultSqlSession"><a href="#1-DefaultSqlSession" class="headerlink" title="1.DefaultSqlSession"></a>1.DefaultSqlSession</h6><h6 id="2-SqlSessionManager"><a href="#2-SqlSessionManager" class="headerlink" title="2.SqlSessionManager"></a>2.SqlSessionManager</h6><p>SqlSession通过内部存放的执行器（Executor）来对数据进行 CRUD 基础操作。<br>此外，每个线程都应该有自己的SQL Session实列，但SQL Session实列不是线程安全的，因此不能被共享，使用后需要关闭。</p>
<h4 id="4-Executor"><a href="#4-Executor" class="headerlink" title="4.Executor"></a>4.Executor</h4><p>Executor是MyBatis的执行器，调度的核心，负责SQL语句的生成和查询缓存的维护。</p>
<h4 id="5-MappedStatement"><a href="#5-MappedStatement" class="headerlink" title="5.MappedStatement"></a>5.MappedStatement</h4><p>Mapped Statement对应配置文件中的 &lt;select | update | delete | insert&gt;节点，描述的是一条SQL语句。</p>
<h3 id="2-MyBatis工作流程"><a href="#2-MyBatis工作流程" class="headerlink" title="2.MyBatis工作流程"></a>2.MyBatis工作流程</h3><p><img src="/../JavaEE/1.png" alt="Mybatis原理流程"></p>
<h2 id="4"><a href="#4" class="headerlink" title="4."></a>4.<a href="https://mybatis.net.cn/getting-started.html" rel="external nofollow noreferrer" title="" target="">Mybatis入门</a></h2><h3 id="1-SQL-1"><a href="#1-SQL-1" class="headerlink" title="1.SQL"></a>1.SQL</h3><h3 id="2-cn-edu-example-mybatis-mapper"><a href="#2-cn-edu-example-mybatis-mapper" class="headerlink" title="2.cn.edu.example.mybatis.mapper"></a>2.cn.edu.example.mybatis.mapper</h3><p>StudentMapper.xml</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;
&lt;!-- namespace 表示命名空间 --&gt;
&lt;mapper namespace="cn.edu.example.mybatis.mapper.StudentMapper"&gt;
 &lt;!-- 根据学号获取学生信息--&gt;
 &lt;select id="findStudentByStuno" parameterType="Integer"
  resultType="cn.edu.example.mybatis.po.Student"&gt;
  Select*from t_student where stuno=#{stuno}
  &lt;/select&gt;
&lt;/mapper&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-cn-edu-example-mybatis-po"><a href="#3-cn-edu-example-mybatis-po" class="headerlink" title="3.cn.edu.example.mybatis.po"></a>3.cn.edu.example.mybatis.po</h3><p>Student.java</p>
<pre class="line-numbers language-none"><code class="language-none">package cn.edu.example.mybatis.po;

public class Student {
 private Integer stuno;// 主键，学号
 private String stuname;// 学生姓名
 private Integer grade;// 年纪
 private String dept;// 专业
 private String classname;

 @Override
 public String toString() {
  return "Student [stuno=" + stuno + ", stuname=" + stuname + ", grade=" + grade + ", dept=" + dept
    + ", classname=" + classname + "]";
 }

 public Integer getStuno() {
  return stuno;
 }

 public void setStuno(Integer stuno) {
  this.stuno = stuno;
 }

 public String getStuname() {
  return stuname;
 }

 public void setStuname(String stuname) {
  this.stuname = stuname;
 }

 public Integer getGrade() {
  return grade;
 }

 public void setGrade(Integer grade) {
  this.grade = grade;
 }

 public String getDept() {
  return dept;
 }

 public void setDept(String dept) {
  this.dept = dept;
 }

 public String getClassname() {
  return classname;
 }

 public void setClassname(String classname) {
  this.classname = classname;
 }

}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-cn-edu-example-mybatis-test"><a href="#3-cn-edu-example-mybatis-test" class="headerlink" title="3.cn.edu.example.mybatis.test"></a>3.cn.edu.example.mybatis.test</h3><p>MyBatis.java</p>
<pre class="line-numbers language-none"><code class="language-none">package cn.edu.example.mybatis.test;

import java.io.Reader;
import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;
import cn.edu.example.mybatis.po.Student;

public class MybatisTest {
 private static SqlSessionFactory sqlSessionFactory = null;
 // 初始化SQL Session Factory对象
 static {
  try {
   // 使用Mybatic提供的Resources类加载MyBatis的XML配置文件
   Reader reader = Resources.getResourceAsReader("mybatis-config.xml");
   // 构建SqlSessionFactory对象 
   // SqlSessionFactory对象
   sqlSessionFactory = new SqlSessionFactoryBuilder().build(reader);
  } catch (Exception e) {
   e.printStackTrace();
  }
 }

 // 获取SQL Session对象的静态方法
 public static SqlSession getSession() {
  return sqlSessionFactory.openSession();
 }

 // 根据学号查询学生信息
 public void findStudentByStunoTest() {
  // 获取SQL Session
  SqlSession sqlSession = getSession();
  // Sqlsession 执行映射文件中定义的SQL语句，并返回映射结果
  Student stu = sqlSession.selectOne("cn.edu.example.mybatis.mapper." + "StudentMapper.findStudentByStuno",
    2018020222);

  // 输出结果
  System.out.println(stu.toString());
  // 关闭SQL Session
  sqlSession.close();
 }

 public static void main(String[] args) {
  MybatisTest test = new MybatisTest();
  test.findStudentByStunoTest();
 }

}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="4-mybatis-config-xml"><a href="#4-mybatis-config-xml" class="headerlink" title="4.mybatis-config.xml"></a>4.mybatis-config.xml</h3><pre class="line-numbers language-none"><code class="language-none">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;
&lt;configuration&gt;
 &lt;!-- 配置环境，默认的环境ID为mysql--&gt;
 &lt;environments default="mysql"&gt;
  &lt;!--配置环境ID为mysql的数据库环境 --&gt;
  &lt;environment id="mysql"&gt;
   &lt;transactionManager type="JDBC"/&gt;
   &lt;dataSource type="POOLED"&gt;
    &lt;property name="driver" value="com.mysql.cj.jdbc.Driver"/&gt;
    &lt;property name="url"
    value="jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC"/&gt;
    &lt;property name="username" value="root"/&gt;
    &lt;property name="password" value="love1314"/&gt;
   &lt;/dataSource&gt;
  &lt;/environment&gt;
 &lt;/environments&gt;
 &lt;!-- 配置映射器的位置--&gt;
 &lt;mappers&gt;
  &lt;mapper resource="cn/edu/example/mybatis/mapper/StudentMapper.xml"/&gt;
 &lt;/mappers&gt;
&lt;/configuration&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="5-输出"><a href="#5-输出" class="headerlink" title="5.输出"></a>5.输出</h3><p>Student [stuno=2018020222, stuname=����, grade=2018, dept=�����, classname=�����1802]</p>
<h1 id="10-Mybatis配置"><a href="#10-Mybatis配置" class="headerlink" title="10 Mybatis配置"></a>10 Mybatis配置</h1><h2 id="1-1-属性-properties"><a href="#1-1-属性-properties" class="headerlink" title="1.1 属性(properties)"></a>1.1 属性(properties)</h2><p>properties 都是可以在外部配置且可以动态替换的，既可以在Java属性文件中配置，又可以在properties元素的子元素来传递。</p>
<h2 id="1-2-设置-settings"><a href="#1-2-设置-settings" class="headerlink" title="1.2 设置(settings)"></a>1.2 设置(settings)</h2><p>常用项目名                       描述                                                            有效值              默认值<br>cacheEnabled                    全局地开启/关闭XML配置文件中的所有映射器已经配置的任何缓存          布尔值</p>
<p>multipleResultSetsEnabled       是/否允许单一语句返回多结果集</p>
<p>useColumnLabel                  使用列表标签代替别名。不同的驱动会有不同的表现，具体可参考相<br>                                关驱动文档，或通过测试这两种不同的模式来观察所用驱动的结果。</p>
<p>useGeneratedKeys                允许JDBC支持自动化生成主键，需要驱动支持。如果设置为true，<br>                                则将强制使用自动生成主键。尽管一些驱动不支持此常用项。</p>
<p>autoMappbehavior                指定MyBatista应如何自动映射列到字段或属性上。<br>                                None表示取消自动映射；<br>                                Partial只会自动映射没有定义嵌套结果集映射的结果集；<br>                                full会自动映射任意复杂的结果集。</p>
<p>safeRowBoundsEnabled			允许在嵌套语句中使用分页(RowBounds)。如果允许使用，则设置<br>                                为	false</p>
<p>safeResultHandlerEnabled		允许在嵌套语句中使用分页(ResultHandler)，如果使用设置为false。</p>
<p>returnlnstanceForEmptyRow		当返回的所有列是空时，MyBatis默认返回null。当开启这个设置时，<br>                                Mybatis会返回一个空实列。也适用于嵌套的结果集。</p>
<h2 id="3-类型别名-typeAiases"><a href="#3-类型别名-typeAiases" class="headerlink" title="3.类型别名(typeAiases)"></a>3.类型别名(typeAiases)</h2><p>解释：<br>类型别名(typeAiases)是为Java数据类型设置一个短的名称。<br>只和XML配置文件有关，用来减少完全限定名的冗余。</p>
<p>1. </p>
<pre class="line-numbers language-none"><code class="language-none">&lt;typeAliases&gt;
 &lt;typeAliase alias='Student' type='cn.edu.mybatis.po.Student' /&gt;
&lt;/typeAliases&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Student 就可以在任何使用 cn.edu.mybatis.po.Student 的地方。<br>2. </p>
<pre class="line-numbers language-none"><code class="language-none">&lt;typeAliases&gt;
 &lt;package name="cn.edu.mybatis.po" /&gt;
&lt;/typeAliases&gt;

@Alias("Student")
public class Student{
 ...
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>指定一个包名，Mybatis会在报名下搜索需要的JavaBean。</p>
<p>每一个在包 cn.edu.mybatis.po 中的JavaBean，在没有注解的情况下，都会使用 Bean 的首字母小写的非限定类名来作为她的别名。</p>
<h2 id="4-环境配置-environments"><a href="#4-环境配置-environments" class="headerlink" title="4.环境配置(environments)"></a>4.环境配置(environments)</h2><p>Mybatis可以配置多种环境，但是每一个 SqlSessionFactory实列只能对应一个环境。如果链接多个数据库，则需要创建多个 SqlSessionFactory实列。</p>
<p>为指定创建环境，需要将环境作为可选的参数传递给SQLSessionFactoryBuilder：</p>
<pre class="line-numbers language-none"><code class="language-none">SqlSessionFactory factory =
       new SqlSessionFactoryBuilder().build(reader,environment[,properties]);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>当使用默认环境时：</p>
<pre class="line-numbers language-none"><code class="language-none">SqlSessionFactory factory =
       new SqlSessionFactoryBuilder().build(reader[,properties]);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="1-元素定义配置环境"><a href="#1-元素定义配置环境" class="headerlink" title="1.元素定义配置环境"></a>1.<environments>元素定义配置环境</environments></h3><pre class="line-numbers language-none"><code class="language-none">&lt;environments default="del"&gt;
    &lt;environment id="del"&gt;
        &lt;transactionManager type="JDBC"&gt;&lt;/transactionManager&gt;
        &lt;dataSource type="POOLED"&gt;
            &lt;!--Java 18 value="com.mysql.cj.jdbc.Driver"--&gt;
            &lt;property name="driver" value="com.mysql.cj.jdbc.Driver"/&gt;
            &lt;property name="url" value="jdbc:mysql://localhost:3306/mybatis"/&gt;
            &lt;property name="username" value="root"/&gt;
            &lt;property name="password" value="love1314"/&gt;
        &lt;/dataSource&gt;
    &lt;/environment&gt;
&lt;/environments&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>(1). 默认使用的环境ID (default=“mysql”)</li>
<li>(2). 每个environment元素定义的环境ID (id=”mysql”)</li>
<li>(3). 事务管理器的配置(type=”JDBC”)</li>
<li>(4). 数据源的配置 (type=”POOLED”)</li>
</ul>
<h4 id="1-事务管理器和数据源-介绍"><a href="#1-事务管理器和数据源-介绍" class="headerlink" title="1.事务管理器和数据源 介绍"></a>1.事务管理器和数据源 介绍</h4><h5 id="1事务管理器-type-x3D-”-JDBC-x2F-MANAGED-“"><a href="#1事务管理器-type-x3D-”-JDBC-x2F-MANAGED-“" class="headerlink" title="1事务管理器 type=” [JDBC / MANAGED] “"></a>1事务管理器 type=” [JDBC / MANAGED] “</h5><ol>
<li>JDBC: 使用JDBC的提交和回滚设置，它依赖于从数据源得到的链接来管理事务作用域。</li>
<li>MANAGED: 这个配置不提交或回滚一个链接，而是让容器来管理事物的整个生命周期。默认情况关闭连接，有些容器不希望如此，需要将closeConnection属性设置为false，来阻止默认的关闭操作。</li>
<li>使用 Mybatis和Spring不需要配置事务管理器，Spring自带管理器会覆盖配置。</li>
</ol>
<h5 id="2-数据源-type-x3D-“-UNPOOLED-x2F-POOLED-x2F-JND-“"><a href="#2-数据源-type-x3D-“-UNPOOLED-x2F-POOLED-x2F-JND-“" class="headerlink" title="2.数据源 type= “ [UNPOOLED / POOLED / JND ] “"></a>2.数据源 type= “ [UNPOOLED / POOLED / JND ] “</h5><p>虽然数据源的配置是可选的，但为使用延迟加载，数据源是必须配置的.</p>
<ol>
<li>UNPOOLED: 只用于每次请求时打开和关闭请求，适用于连接池不重要的。</li>
<li>POOLED: 数据源利用“池”的概念将JDBC链接对象组织起来，避免创建新的链接实列时必须的初始化，节省认证时间。能使并发Web应用快速响应请求的处理方式，</li>
<li>JNDI: 数据源实现为EJB或应用服务区这类容器中的使用，容器可以集中或在外部配置数据源并设置一个JNDI上下文的应用。</li>
</ol>
<h2 id="5-映射器-mappers"><a href="#5-映射器-mappers" class="headerlink" title="5.映射器(mappers)"></a>5.映射器(mappers)</h2><pre class="line-numbers language-none"><code class="language-none">相对于类似路径的资源应引用
&lt;mappers&gt;
 &lt;mapper resource="cn/edu/mybtis/mapper/SrudentMapper.xml" /&gt;
&lt;/mappers&gt;

统一资源定位符
&lt;mappers&gt;
 &lt;mapper url="file:///var/mappers/SrudentMapper.xml" /&gt;
&lt;/mappers&gt;

映射器接口实现类的完全限定类名
&lt;mappers&gt;
 &lt;mapper class="cn.edu.mybtis.mapper.SrudentMapper.xml" /&gt;
&lt;/mappers&gt;

将包内的映射器接口实现全部注册为映射器
&lt;mappers&gt;
 &lt;package name="cn.edu.mybatis.mapper" /&gt;
&lt;/mappers&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h2 id="6-mapper-xml-常用SQL标签"><a href="#6-mapper-xml-常用SQL标签" class="headerlink" title="6. mapper.xml 常用SQL标签"></a>6. mapper.xml 常用SQL标签</h2><div class="tabs" id="1.查询语句"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#1.查询语句-1">1.查询语句</button></li><li class="tab"><button type="button" data-href="#1.查询语句-2">2.插入语句</button></li><li class="tab"><button type="button" data-href="#1.查询语句-3">3.删除语句</button></li><li class="tab"><button type="button" data-href="#1.查询语句-4">4.修改语句</button></li><li class="tab"><button type="button" data-href="#1.查询语句-5">5.模糊查询</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="1.查询语句-1"><pre class="line-numbers language-none"><code class="language-none">&lt;select id="selectByPrimaryKey"  resultMap="BaseResultMap" parameterType="java.lang.String" &gt;
   selec...   
 &lt;/select&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="1.查询语句-2"><pre class="line-numbers language-none"><code class="language-none">&lt;insert id="insert" parameterType="pojo.OrderTable" &gt;
  insert into ordertable(...)
    values(...)
&lt;/insert&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="1.查询语句-3"><pre class="line-numbers language-none"><code class="language-none">&lt;delete id="deleteByPrimaryKey" parameterType="java.lang.String" &gt;
    delete from ordertable  
      where order_id = #{orderId,jdbcType=VARCHAR}  
&lt;/delete&gt;  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="1.查询语句-4"><pre class="line-numbers language-none"><code class="language-none">&lt;update id="updateByPrimaryKey" parameterType="pojo.OrderTable" &gt;  
   update ordertable 
    set   
          cid = #{cid,jdbcType=VARCHAR},  
          address = #{address,jdbcType=VARCHAR},  
          create_date = #{createDate,jdbcType=TIMESTAMP},  
          orderitem_id = #{orderitemId,jdbcType=VARCHAR}  
    where 
          order_id = #{orderId,jdbcType=VARCHAR}  
&lt;/update&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="1.查询语句-5"><pre class="line-numbers language-none"><code class="language-none">&lt;select id="listProduct" resultType="Product"&gt;
    select * from product_
        &lt;if test="name!=null"&gt;
            where name like concat('%',#{name},'%')
        &lt;/if&gt;        
&lt;/select&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<h4 id="1-需要配置的属性"><a href="#1-需要配置的属性" class="headerlink" title="1.需要配置的属性"></a>1.需要配置的属性</h4><p>1、id=”xxxx”    表示此段SQL执行语句的唯一标识，也是接口的方法名称 (必须一致才能找到)</p>
<p>2、parameterType=”xxxx”    表示SQL语句中需要传入的参数，类型要与对应的接口方法的类型一致</p>
<p>3、resultMap=”xxx”    定义出参，调用已定义的映射管理器的id的值</p>
<p>4、resultType=”xxxx”    定义出参，匹配普通Java类型或自定义的pojo (出参类型若不指定，将为语句类型默认类型，如语句返回值为int)</p>
<h3 id="1-if-和-where-标签"><a href="#1-if-和-where-标签" class="headerlink" title="1.if 和 where 标签"></a>1.if 和 where 标签</h3><pre class="line-numbers language-none"><code class="language-none">&lt;select id="listProduct" resultType="Product"&gt;
    select * from product_
      &lt;where&gt;
        &lt;if test="name!=null"&gt;
            and name like concat('%',#{name},'%')
        &lt;/if&gt;        
        &lt;if test="price!=null and price!=0"&gt;
            and price &gt; #{price}
        &lt;/if&gt;
      &lt;/where&gt;     
&lt;/select&gt;

/**
作用:
标签会进行自动判断：
如果任何条件都不成立，那么就在sql语句里就不会出现where关键字（重点）
如果有任何条件成立，会自动去掉多出来的 and 或者 or
 */<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h3 id="2-set-标签"><a href="#2-set-标签" class="headerlink" title="2.set 标签"></a>2.set 标签</h3><pre class="line-numbers language-none"><code class="language-none">&lt;update id="updateProduct" parameterType="Product" &gt;
    update product_
    &lt;set&gt;
        &lt;if test="name != null"&gt;name=#{name},&lt;/if&gt;
        &lt;if test="price != null"&gt;price=#{price}&lt;/if&gt; 
    &lt;/set&gt;
     where id=#{id}   
&lt;/update&gt;

/**
作用:
标签会进行自动判断：
如果任何条件都不成立，那么就在sql语句里就不会出现where关键字（重点）
 */<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h3 id="3-trim-标签"><a href="#3-trim-标签" class="headerlink" title="3.trim 标签"></a>3.trim 标签</h3><pre class="line-numbers language-none"><code class="language-none">&lt;select id="listProduct" resultType="Product"&gt;
    select *from product_
    &lt;trim prefix="WHERE" prefixOverrides="AND |OR "&gt;
        &lt;if test="name!=null"&gt;
            and name like concat('%',#{name},'%')
        &lt;/if&gt;        
        &lt;if test="price!=null and price!=0"&gt;
            and price &gt; #{price}
        &lt;/if&gt;
    &lt;/trim&gt;      
&lt;/select&gt;
 
&lt;update id="updateProduct" parameterType="Product" &gt;
    update product_
    &lt;trim prefix="SET" suffixOverrides=","&gt;
        &lt;if test="name != null"&gt;name=#{name},&lt;/if&gt;
        &lt;if test="price != null"&gt;price=#{price}&lt;/if&gt;   
    &lt;/trim&gt;
     where id=#{id}   
&lt;/update&gt;

/**
  trim 用来定制想要的功能，比如where标签就可以用
 */<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h3 id="4-chooseWhenOtherwise-标签"><a href="#4-chooseWhenOtherwise-标签" class="headerlink" title="4.chooseWhenOtherwise 标签"></a>4.chooseWhenOtherwise 标签</h3><pre class="line-numbers language-none"><code class="language-none">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;
&lt;mapper namespace="com.myjava.pojo"&gt;

        &lt;select id="listProduct" resultType="Product"&gt;
              SELECT * FROM product_
              &lt;where&gt;
                &lt;choose&gt;
                  &lt;when test="name != null"&gt;
                    and name like concat('%',#{name},'%')
                  &lt;/when&gt;          
                  &lt;when test="price !=null and price != 0"&gt;
                    and price &gt; #{price}
                  &lt;/when&gt;                
                  &lt;otherwise&gt;
                    and id &gt;1
                  &lt;/otherwise&gt;
                &lt;/choose&gt;
              &lt;/where&gt;
        &lt;/select&gt;
&lt;/mapper&gt;

/**
  有任何任何条件符合，就进行条件查询，否则就只使用id&gt;1这个条件
 */<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="5-foreach-标签"><a href="#5-foreach-标签" class="headerlink" title="5.foreach 标签"></a>5.foreach 标签</h3><pre class="line-numbers language-none"><code class="language-none">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;

&lt;mapper namespace="com.myjava.pojo"&gt;
    &lt;select id="listProduct" resultType="Product"&gt;
          SELECT * FROM product_
            WHERE ID in
                &lt;foreach item="item" index="index" collection="list"
                    open="(" separator="," close=")"&gt;
                    #{item}
                &lt;/foreach&gt;
    &lt;/select&gt;
&lt;/mapper&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="6-bind-标签"><a href="#6-bind-标签" class="headerlink" title="6.bind 标签"></a>6.bind 标签</h3><pre class="line-numbers language-none"><code class="language-none">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;

&lt;mapper namespace="com.myjava.pojo"&gt;
    &lt;select id="listProduct" resultType="Product"&gt;
        &lt;bind name="likename" value="'%' + name + '%'" /&gt;
        select * from   product_  where name like #{likename}
    &lt;/select&gt;
 
&lt;/mapper&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h3 id="7-sql-片段标签"><a href="#7-sql-片段标签" class="headerlink" title="7.sql 片段标签"></a>7.sql 片段标签</h3><pre class="line-numbers language-none"><code class="language-none">&lt;!--定义sql片段--&gt;
&lt;sql id="orderAndItem"&gt;
    o.order_id,o.cid,o.address,o.create_date,o.orderitem_id,i.orderitem_id,i.product_id,i.count
&lt;/sql&gt;

&lt;select id="findOrderAndItemsByOid" parameterType="java.lang.String" resultMap="BaseResultMap"&gt;
    select     &lt;!--引用sql片段--&gt;
        &lt;include refid="orderAndItem" /&gt; 
    from 
          ordertable o 

    join  orderitem i 
    on    o.orderitem_id = i.orderitem_id
    where 
        o.order_id = #{orderId}

&lt;/select&gt;

/**
作用是:
通过该标签可定义能复用的sql语句片段，在执行sql语句标签中直接引用即可。
这样既可以提高编码效率，还能有效简化代码，提高可读性。
 */<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h2 id="7-Mybatis-多表查询"><a href="#7-Mybatis-多表查询" class="headerlink" title="7. Mybatis 多表查询"></a>7. Mybatis 多表查询</h2><h3 id="1-一对一"><a href="#1-一对一" class="headerlink" title="1. 一对一"></a>1. 一对一</h3><div class="tabs" id="mapper.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#mapper.xml-1">mapper.xml</button></li><li class="tab"><button type="button" data-href="#mapper.xml-2">POJO</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="mapper.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;sql id="ListMap"&gt;
    b.id,b.productName,p.proName,b.totalPrice,b.isPayment,b.creationDate
&lt;/sql&gt;
/**
    resultMap: 声明 一个存储多个POJO 对象的图表
    property: pojo 对象属性
    column: mysql 列名
 */
&lt;resultMap id="toProviderId" type="top.wabisabifag.entity.SmbmsBill"&gt;
    &lt;id property="id" column="id"/&gt;
    &lt;result property="productName" column="productName"/&gt;
    &lt;result property="totalPrice" column="totalPrice"/&gt;
    &lt;result property="isPayment" column="isPayment"/&gt;
    &lt;result property="creationDate" column="creationDate"/&gt;

    &lt;!-- 相同列名的做区分--&gt;
    &lt;association property="smbmsProvider" javaType="top.wabisabifag.entity.SmbmsProvider"&gt;
        &lt;result property="proName" column="proName"/&gt;
    &lt;/association&gt;
&lt;/resultMap&gt;

/**
    resultMap: 使用声明的图表
 */
&lt;select id="billShowList" resultMap="toProviderId"&gt;
    select  &lt;include refid="ListMap" /&gt;
        from smbms_bill b, smbms_provider p
    where b.providerId = p.id
&lt;/select&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="mapper.xml-2"><pre class="line-numbers language-none"><code class="language-none">private SmbmsProvider smbmsProvider;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>


<h3 id="2-一对多"><a href="#2-一对多" class="headerlink" title="2. 一对多"></a>2. 一对多</h3><div class="tabs" id="mapper.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#mapper.xml-1">mapper.xml</button></li><li class="tab"><button type="button" data-href="#mapper.xml-2">POJO</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="mapper.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;sql id="ListMap"&gt;
    b.id,b.productName,p.proName,b.totalPrice,b.isPayment,b.creationDate
&lt;/sql&gt;
/**
    resultMap: id="toProviderId"  声明 一个存储多个POJO 对象的图表
    property: pojo 对象属性
    column: mysql 列名
 */
&lt;resultMap id="toProviderId" type="top.wabisabifag.entity.SmbmsBill"&gt;
    &lt;id property="id" column="id"/&gt;
    &lt;result property="productName" column="productName"/&gt;
    &lt;result property="totalPrice" column="totalPrice"/&gt;
    &lt;result property="isPayment" column="isPayment"/&gt;
    &lt;result property="creationDate" column="creationDate"/&gt;

    &lt;!-- 配置集合信息 
        property: 集合在POJO对象的名称
        ofType：当前集合中的数据类型
    --&gt;
    &lt;collection property="smbmsProviderList" ofType="top.wabisabifag.entity.SmbmsProvider"&gt;
        &lt;result property="proName" column="proName"/&gt;
    &lt;/collection&gt;
&lt;/resultMap&gt;

/**
     resultMap = "toProviderId" 使用声明的图表
 */
&lt;select id="billShowList" resultMap="toProviderId"&gt;
    select  &lt;include refid="ListMap" /&gt;
        from smbms_bill b, smbms_provider p
    where b.providerId = p.id
&lt;/select&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="mapper.xml-2"><pre class="line-numbers language-none"><code class="language-none">private List&lt;SmbmsProvider&gt; smbmsProviderList;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>


<h3 id="3-多对多"><a href="#3-多对多" class="headerlink" title="3. 多对多"></a>3. 多对多</h3><div class="tabs" id="mapper.xml"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#mapper.xml-1">mapper.xml</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="mapper.xml-1"><pre class="line-numbers language-none"><code class="language-none">&lt;resultMap id="userRoleMap" type="user"&gt;
  /* user 信息 */
  &lt;id column="userId" property="id"/&gt;
  &lt;result column="username" property="username"/&gt;
  &lt;result column="password" property="password"/&gt;
  &lt;result column="birthday" property="birthday"/&gt;
    &lt;collection property="roleList" ofType="top.wabisabifag.entity.role"&gt;
          /* user内部roleList 信息 */
          &lt;id  property="id" cloumn="roleId"/&gt;
          &lt;result property="roleName" column="roleName"/&gt;
          &lt;result property="roleDesc" column="roleDesc"/&gt;
    &lt;/collection&gt;
&lt;/resultMap&gt;

&lt;select id="findUserAndRoleAll" resultMap="userRoleMap"&gt;
  select * from  user u,
                 sys_user_role ur,
                 sys_role r
    where 
            u.id=ur.userTd and ur.roleId=r.id 
&lt;/select&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>三张表，中间表进行连接作用，仅在查询语句时作用</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>













<h1 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h1><h2 id="Mybatis"><a href="#Mybatis" class="headerlink" title="Mybatis"></a>Mybatis</h2><ol>
<li>mybatis<br> 1.一级缓存<br>mapper调用对象代理的session,对数据库查询数据后会存在的数据缓存。<br>出现的问题:<br>      当在同一个方法中连贯query的时候，由于代码非 mapper代理绑定在前一个mapper对象上，会报错。<br>解决方法:<br>      再次赋值绑定到mapper的session上进行query。<br> 2.二级缓存<br>   (1)为什么有二级缓存：<br>   一级缓存，查询的数据不是数据库的数据，而是直接在Client端发送request请求给Tomcat，在服务器同一个线程的缓存中调用，该线程第二次调用时不访问数据库。<br>   (2)二级缓存的存在原理：<br>   二级缓存会重新独立访问数据库，以便获取最新的数据库信息。<br>   出现的问题:<br>   (1)由于Spring不对外开放，mybatis二级缓存会自动关闭对数据库的访问。<br>   (2)当数据操作的方法联动(动态)改动信息的时候，无法获得改动的最新数据。</li>
</ol>
<h1 id="Spring-—黑马程序员"><a href="#Spring-—黑马程序员" class="headerlink" title="Spring —黑马程序员"></a>Spring —黑马程序员</h1><h2 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h2><ol>
<li><p>思想：<br>IoC  ( inversion of Control) ，控制反转，强调的是原来在程序中创建Bean的权利反转给第三方。Spring接管操纵。<br>DI  （Dependency Injection），依赖注入，强调的bean之间关系，这种关系第三方负责设置。<br>AOP  （Aspect Oriented Programming)，面向切面编程。功能的横向抽取，主要的实现方式就是 Peoxy。</p>
</li>
<li><p>Spring提供：<br>IoC，AOP，Web MVC </p>
</li>
<li><p>Spring Frameworl技术栈：<br>Data Access：数据访问<br>Data Integration：数据集成<br>Web：Web开发<br>ADP：面向切面编程<br>Aspects：AOP思想实现<br>Core Container：核心容器<br>Test：单元测试，集成测试</p>
</li>
<li><p>BeanFactory与ApplicationContext的关系：<br>1.BeanFactory时Spring的早期接口，称为Spring的Bean工厂，Application Context时后期更高级的接口，是Spring容器；<br>2.Application Context早Bean Factory基础上对功能进行了扩展，列如：监听功能，国际化功能等。Bean Factory的API更偏向底层，Application Context的API多数是对底层API的封装；<br>3.Bean的创建主要逻辑和功能都被封装在Bean Factory中，Application Context不仅继承Bean Factory，而且Application Context内部还维护着Bean Factory的引用，所以，ApplicationContext与Bean Factory既有继承关系，又有任何关系；<br>4.bean的初始化实际不同，原始Bean Factory是在首次调用个体Bean是才进行Bean的创建，而Application Context则是配置文件加载，容器一创建就将Bean都实列化并初始化好；</p>
</li>
</ol>
<h2 id="基于xml的Spring应用"><a href="#基于xml的Spring应用" class="headerlink" title="基于xml的Spring应用"></a>基于xml的Spring应用</h2><h3 id="SpringBean-的配置详解"><a href="#SpringBean-的配置详解" class="headerlink" title="SpringBean 的配置详解"></a>SpringBean 的配置详解</h3><pre class="line-numbers language-none"><code class="language-none">xml配置方式										功能描述

&lt;bean id="" class=""&gt;							全限定名配置

&lt;bean name=""&gt;									通过name设置Bean的别名，通过别名也能直接获取到Bean实列

&lt;bean scope=""&gt;									Bean的作用范围，Bean Factory作为容器时取值singleton和prototype

&lt;bean lazy-init=""&gt;								Bean实列化时机，是否延迟加载。Bean Factory作为容器时无效

&lt;bean init-method=""&gt;							Bean的实列化后自动执行的初始化方法，method指定方法名

&lt;bean destory-method=""&gt;						Bean实列销毁钱的方法，method指定方法名

&lt;bean autowire="byType"&gt;						设置自动注入模式，常用的有按照类型byType，按照名字byName

&lt;bean factory-bean="" factory-method=""/&gt; 		指定那个工厂Bean的那个方法完成Bean的创建<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="SpringBean配置"><a href="#SpringBean配置" class="headerlink" title="SpringBean配置"></a>SpringBean配置</h3><pre class="line-numbers language-none"><code class="language-none">&lt;!--    配置UserServiceImpl--&gt;
   &lt;bean id="userService" class="top.wabisabifag.service.impl.UserServiceImpl"&gt;
       &lt;property name="userDao" ref="userDao"&gt;&lt;/property&gt;
   &lt;/bean&gt;
&lt;!--    篇日志UserDaoImpl--&gt;
   &lt;bean id="userDao" class="top.wabisabifag.service.impl.UserDaoImpl"&gt;&lt;/bean&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li><p>Bean的基础配置<br> 列如：<br>     配置UserDaoImpl由Spring容器负责管理<br>     <bean id="userDao" class="top.wabisabifag.dao.impl.UserDaoImpl"><br><br>     此时存储到Spring容器的Bean的beanName时uerDao，值是UserDaoImpl对象，可根据beanName获取Bean实列<br>     applicationContext.getBean(“userDao”);<br><br>     如不配置id，则Spring会把当前Bean实列的全限定名作为beanName<br>     applicationContext.getBean(“top.wabisabifag.dao.impl.UserDaoImpl”)</bean></p>
</li>
<li><p>Bean的别名配置<br> 可以为当前Bean指定多个别名，根据别名可获得Bean对象<br> <bean id="userDao" name="aa,bb" class="top.wabisabifag.dao.impl.UserDaoImpl"><br><br> 此时多个名称可以获得UserDaoImpl实列duixiang<br> applicationContext.getBean(“UserDao”);<br> applicationContext.getBean(“aa”);<br> applicationContext.getBean(“bb”);</bean></p>
</li>
<li><p>Bean的范围设置<br> 单纯的Spring环境的作用有两个：Singleton和Prototype<br> Singleton：单列，默认值，Spring容器创建时候就会进行Bean的实列化，并存储到容器内部的单列池中，每次getBean时都是从单列池中获取相同的Bean实列<br> prototype：原型，Spring容器初始化时不会创建Bean实列，当调用getBean时才会实列化Bean，每次getBean都会创建一个新的Bean实列</p>
</li>
<li><p>Bean的延迟加载<br> 当lazy-init设置为true，Spring容器创建时不会立即创建Bean实列，等待用到时在创建Bean实列并存储到单列池中，后续在使用该Bean直接从单列池获取，本质上该Bean还是单列<br> <bean id="userDao" class="top.wabisabifag.dao.impl.UserDaoImpl" lazy-init="true"></bean></p>
</li>
<li><p>Bean的初始化和销毁方法配置<br> Bean在被实列化后，可执行指定的初始化方法完成一些初始化的操作，Bean在销毁之前也可以执行指定的销毁方法完成一些操作，初始化方法名称和销毁方法名称通过<br> </p><pre class="line-numbers language-none"><code class="language-none">&lt;bean id="userDao" class="top.wabisabifag.dao.impl.UserDaoImpl" init-method="init" destory-method="destroy"/&gt;

public class UserDaoImpl implements UserDao{
 public UserDaoImpl(){};
 public void init(){};
 public void destory(){};
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p>
</li>
<li><p>Bean的实列化配置<br> Spring的实列化方式：</p>
</li>
<li><p>构造方式实列化：底层通过构造方法对Bean进行实列化</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;!--    配置UserServiceImpl--&gt;
   &lt;bean id="userService" class="top.wabisabifag.service.impl.UserServiceImpl"&gt;
       &lt;!-- UserDapImpl的有参构造--&gt;
 &lt;constructor-arg name="name" value="H"&gt;&lt;/constructor&gt;
 &lt;property name="userDao" ref="userDao"&gt;&lt;/property&gt;
   &lt;/bean&gt;
&lt;!--    篇日志UserDaoImpl--&gt;
   &lt;bean id="userDao" class="top.wabisabifag.service.impl.UserDaoImpl"&gt;&lt;/bean&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>工厂方式实列化：底层通过调用自定义的工厂方式对Bean进行实列化</p>
</li>
</ol>
<ul>
<li><p>静态工厂方法实列化Bean<br>  id定义一个在impl.UserServiceImpl函数方法下的 userDao 函数方法.<br>  可以被应用,便于在运行前在该方法中的其他功能的运行调用.<br>  </p><pre class="line-numbers language-none"><code class="language-none">&lt;!--    配置UserServiceImpl--&gt;
 		&lt;bean id="user" class="top.wabisabifag.service.impl.UserServiceImpl" 
factory-method="userDao"&gt;&lt;/bean&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p></p>
</li>
<li><p>实列工厂方法实列化Bean</p>
</li>
<li><p>实现FavtoryBean规范延迟实列化Bean</p>
</li>
</ul>
<p>2.Spring 的get方法</p>
<p>3.Spring 配置非定义Bean</p>
<p>4，Bean 实列化的基本流程</p>
<p>5.Spring 的后处理器</p>
<p>6.SpringBean 的生命周期</p>
<p>7.Spring Ioc 整体流程总结</p>
<p>8.Spring xml 方式整合第三方框架</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://github.com/Wabi-Sabifag/Wabi-Sabifag.github.io">Wabi-Sabifag</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://github.com/Wabi-Sabifag/Wabi-Sabifag.github.io/2023/02/18/JavaEE/">https://github.com/Wabi-Sabifag/Wabi-Sabifag.github.io/2023/02/18/JavaEE/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://github.com/Wabi-Sabifag/Wabi-Sabifag.github.io" target="_blank">当你抬头仰望星辰时，月辉亲昵双颊</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a><a class="post-meta__tags" href="/tags/JavaEE/">JavaEE</a><a class="post-meta__tags" href="/tags/Mybatis/">Mybatis</a><a class="post-meta__tags" href="/tags/MybatisPlus/">MybatisPlus</a><a class="post-meta__tags" href="/tags/SpringBoot/">SpringBoot</a><a class="post-meta__tags" href="/tags/Docker/">Docker</a><a class="post-meta__tags" href="/tags/Redis/">Redis</a><a class="post-meta__tags" href="/tags/Swaggger/">Swaggger</a></div><div class="post_share"><div class="social-share" data-image="/img/22.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li><li class="reward-item"><a href="/./img/Wabi-Sabifag.jpg" target="_blank"><img class="post-qr-code-img" src="/./img/Wabi-Sabifag.jpg" alt="BiliBili"/></a><div class="post-qr-code-desc">BiliBili</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/02/23/Vue.js/"><img class="prev-cover" src="/img/15.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Vue.js</div></div></a></div><div class="next-post pull-right"><a href="/2023/02/18/MyDiary/"><img class="next-cover" src="/img/7.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">MyDiary</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/08/22/MybatisPlus/" title="MybatisPlus"><img class="cover" src="/img/23.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-22</div><div class="title">MybatisPlus</div></div></a></div><div><a href="/2022/12/25/Java-the-best-langage-at-the-World/" title="Java, the world&#39;s best programming language"><img class="cover" src="/img/23.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-25</div><div class="title">Java, the world&#39;s best programming language</div></div></a></div><div><a href="/2023/08/19/Maven/" title="Maven基础"><img class="cover" src="/img/27.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-19</div><div class="title">Maven基础</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://safebooru.org//samples/3404/sample_2d70be5f0453c31b5e9ad641db7cf3fb90ba2c23.jpg?3541071" onerror="this.onerror=null;this.src='https://safebooru.org//samples/3404/sample_2d70be5f0453c31b5e9ad641db7cf3fb90ba2c23.jpg?3541071'" alt="avatar"/></div><div class="author-info__name">Wabi-Sabifag</div><div class="author-info__description">当残风不再，当石烂海竭，我迟迟归场</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">25</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">28</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://space.bilibili.com/364309102"><i class="fab fa-github"></i><span>我的兴趣都在这里</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Wabi-Sabifag" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://blog.csdn.net/qq_61109834" rel="external nofollow noreferrer" target="_blank" title="CSDN"><i class="fab fa-contao"></i></a><a class="social-icon" href="https://space.bilibili.com/364309102" rel="external nofollow noreferrer" target="_blank" title="BiliBli"><i class="fa fa-bold"></i></a><a class="social-icon" href="mailto:1109388794@qq.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">世界上的事我不可一饮而尽，唯愿至死依然热爱而真切的活着、目睹经途的千万。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-SpringBoot"><span class="toc-text">1.SpringBoot</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Rest%E9%A3%8E%E6%A0%BC"><span class="toc-text">1.Rest风格</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1Rest"><span class="toc-text">1.1Rest</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-Rest%E7%AE%80%E4%BB%8B"><span class="toc-text">1.1.1 Rest简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-%E5%9C%B0%E5%9D%80%E6%A0%8F%E4%BC%A0%E5%8F%82%E6%A8%A1%E5%BC%8F%E2%80%94-%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE"><span class="toc-text">1.1.2 地址栏传参模式—-参数配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-3-Rest%E5%BF%AB%E9%80%9F%E5%BC%80%E5%8F%91"><span class="toc-text">1.1.3 Rest快速开发</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE"><span class="toc-text">2.基础配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%B1%9E%E6%80%A7%E9%85%8D%E7%BD%AE"><span class="toc-text">2.1 属性配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-Springboot-%E5%A4%9A%E7%A7%8D%E5%B1%9E%E6%80%A7%E9%85%8D%E7%BD%AE-%E6%96%87%E4%BB%B6%E4%BC%98%E5%85%88%E7%BA%A7%E9%80%92%E5%87%8F"><span class="toc-text">2.1.1 Springboot 多种属性配置(文件优先级递减)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-yml%E6%A0%BC%E5%BC%8F"><span class="toc-text">1.yml格式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96"><span class="toc-text">2.数据读取</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E5%B0%81%E8%A3%85%E6%95%B0%E6%8D%AE"><span class="toc-text">3.封装数据</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-%E4%BF%AE%E6%94%B9%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E5%8F%A3"><span class="toc-text">2.1.2 修改服务器端口</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8A%80%E6%9C%AF%E6%95%B4%E5%90%88"><span class="toc-text">3.第三方技术整合</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-JUnit"><span class="toc-text">1.JUnit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-MybatisPlus"><span class="toc-text">2.MybatisPlus</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Lombok"><span class="toc-text">4.Lombok</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Druid"><span class="toc-text">5.Druid</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-SSMP%E6%95%B4%E5%90%88%E6%A1%88%E4%BE%8B"><span class="toc-text">2.SSMP整合案例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SMMP%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-text">SMMP源代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-SpringBoot%E7%BB%B4%E6%8A%A4"><span class="toc-text">3.SpringBoot维护</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%B7%A5%E7%A8%8B%E8%BF%90%E8%A1%8C"><span class="toc-text">1.工程运行</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Windows-jar-%E5%8C%85%E6%89%A7%E8%A1%8C"><span class="toc-text">1.Windows jar 包执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Linux-jar-%E5%8C%85%E6%89%A7%E8%A1%8C"><span class="toc-text">2.Linux jar 包执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E4%B8%B4%E6%97%B6%E5%B1%9E%E6%80%A7%E9%85%8D%E7%BD%AE"><span class="toc-text">3.临时属性配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%A4%9A%E7%8E%AF%E5%A2%83%E5%BC%80%E5%8F%91"><span class="toc-text">4.多环境开发</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-YAML"><span class="toc-text">1. YAML</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#YAML-%E5%BC%8A%E7%AB%AF"><span class="toc-text">YAML 弊端</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#YAML-%E4%BC%98%E5%8C%96"><span class="toc-text">YAML 优化</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-properties"><span class="toc-text">2. properties</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%8B%AC%E7%AB%8B%E7%9A%84%E5%8A%9F%E8%83%BD%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">3. 独立的功能配置文件</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BC%98%E5%8C%96-include-%E6%97%A0%E6%B3%95%E5%8A%A8%E6%80%81%E6%9B%B4%E6%94%B9%E9%97%AE%E9%A2%98"><span class="toc-text">优化 include 无法动态更改问题</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E5%A4%9A%E7%8E%AF%E5%A2%83%E5%BC%80%E5%8F%91%E6%8E%A7%E5%88%B6-Maven"><span class="toc-text">4. 多环境开发控制(Maven)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%97%A5%E5%BF%97"><span class="toc-text">5. 日志</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%97%A5%E5%BF%97%E8%AE%BE%E7%BD%AE"><span class="toc-text">1. 日志设置</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E6%97%A5%E5%BF%97%E5%B7%A5%E5%85%B7-%E5%8A%A8%E6%80%81%E5%92%8C%E7%BB%A7%E6%89%BF"><span class="toc-text">2. 日志工具 (动态和继承)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E6%97%A5%E5%BF%97%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F"><span class="toc-text">3. 日志输出格式</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-SpringBoot%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91"><span class="toc-text">4.SpringBoot应用开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%83%AD%E9%83%A8%E7%BD%B2"><span class="toc-text">1. 热部署</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%83%AD%E9%83%A8%E7%BD%B2%E4%BE%9D%E8%B5%96"><span class="toc-text">1. 热部署依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%83%AD%E9%83%A8%E7%BD%B2%E8%8C%83%E5%9B%B4"><span class="toc-text">2. 热部署范围</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%85%B3%E9%97%AD%E7%83%AD%E9%83%A8%E7%BD%B2"><span class="toc-text">3. 关闭热部署</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E8%AE%BE%E7%BD%AE%E6%96%87%E4%BB%B6%E5%B1%82%E7%BA%A7%E6%8E%A7%E5%88%B6"><span class="toc-text">1.设置文件层级控制</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E7%B3%BB%E7%BB%9F%E5%B1%82%E7%BA%A7%E8%A6%86%E7%9B%96%E6%8E%A7%E5%88%B6"><span class="toc-text">2. 系统层级覆盖控制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Swagger%E7%94%9F%E6%88%90WebAPI%E6%96%87%E6%A1%A3"><span class="toc-text">2. Swagger生成WebAPI文档</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E9%83%A8%E7%BD%B2%E5%BA%94%E7%94%A8Swagger"><span class="toc-text">1.部署应用Swagger</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%AC%AC%E4%B8%89%E6%96%B9Bean-%E5%B1%9E%E6%80%A7%E7%BB%91%E5%AE%9A-configuration"><span class="toc-text">2. 第三方Bean 属性绑定(configuration)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Bean-%E5%B1%9E%E6%80%A7%E7%BB%91%E5%AE%9A"><span class="toc-text">1. Bean 属性绑定</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AE%BD%E6%9D%BE%E7%BB%91%E5%AE%9A"><span class="toc-text">2. 宽松绑定</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%B8%B8%E9%87%8F%E8%AE%A1%E9%87%8F%E5%8D%95%E4%BD%8D%E5%BA%94%E7%94%A8-jdk%E7%89%88%E6%9C%AC-8"><span class="toc-text">3. 常量计量单位应用(jdk版本:8)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%95%B0%E6%8D%AE%E6%A0%A1%E9%AA%8C"><span class="toc-text">4. 数据校验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2"><span class="toc-text">5. 进制数据转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%B5%8B%E8%AF%95"><span class="toc-text">6. 测试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%8A%A0%E8%BD%BD%E6%B5%8B%E8%AF%95%E4%B8%93%E7%94%A8%E5%B1%9E%E6%80%A7"><span class="toc-text">1. 加载测试专用属性</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E5%B1%80%E9%83%A8%E9%85%8D%E7%BD%AE%E5%AF%BC%E5%85%A5"><span class="toc-text">1. 局部配置导入</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Web-%E7%8E%AF%E5%A2%83%E6%A8%A1%E6%8B%9F%E6%B5%8B%E8%AF%95"><span class="toc-text">2. Web 环境模拟测试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E4%B8%9A%E5%8A%A1%E5%B1%82%E6%95%B0%E6%8D%AE%E6%B5%8B%E8%AF%95%E4%BA%8B%E7%89%A9%E5%9B%9E%E6%BB%9A"><span class="toc-text">3. 业务层数据测试事物回滚</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E6%95%B0%E6%8D%AE%E8%AE%BE%E5%AE%9A"><span class="toc-text">4. 测试用例数据设定</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E8%AE%BE%E5%AE%9A%E9%9A%8F%E6%9C%BA%E6%95%B0%E6%8D%AE"><span class="toc-text">1.  测试用例设定随机数据</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E6%95%B0%E6%8D%AE%E5%B1%82%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-text">7. 数据层解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-SQL"><span class="toc-text">1. SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE-DruidDataSource"><span class="toc-text">1. 数据源配置(DruidDataSource)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96-jdbcTemplate"><span class="toc-text">2. 数据持久化(jdbcTemplate)</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-JDBCTemplate-%E9%85%8D%E7%BD%AE"><span class="toc-text">1. JDBCTemplate 配置</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E5%BA%93-MySQL"><span class="toc-text">3. 数据库(MySQL)</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E8%AE%BF%E9%97%AEH2-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%8D%E5%8A%A1%E9%A1%B5%E9%9D%A2"><span class="toc-text">1. 访问H2 数据库服务页面</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-NoSQL"><span class="toc-text">2. NoSQL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-Redis"><span class="toc-text">1. Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-Redis%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C"><span class="toc-text">1. Redis基础操作</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-Redis%E6%95%B4%E5%90%88"><span class="toc-text">2. Redis整合</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-jedis-%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AE%9E%E7%8E%B0%E6%8A%80%E6%9C%AF%E5%88%87%E6%8D%A2"><span class="toc-text">3. jedis 客户端实现技术切换</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-Mongo"><span class="toc-text">2. Mongo</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-MongoDB-%E7%89%B9%E6%80%A7"><span class="toc-text">1. MongoDB 特性</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-Mysql-Redis-%E5%BC%8A%E7%AB%AF"><span class="toc-text">2. Mysql Redis 弊端</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90"><span class="toc-text">3. 数据分析</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-Mongo-%E8%BF%90%E8%A1%8C"><span class="toc-text">4. Mongo 运行</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5-Mongo-%E6%95%B4%E5%90%88"><span class="toc-text">5. Mongo 整合</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-ES"><span class="toc-text">3. ES</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E7%B4%A2%E5%BC%95%E6%93%8D%E4%BD%9C"><span class="toc-text">1. 索引操作</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-%E6%96%87%E6%A1%A3%E6%93%8D%E4%BD%9C"><span class="toc-text">2. 文档操作</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-Elasticsearch-%E6%95%B4%E5%90%88"><span class="toc-text">3. Elasticsearch 整合</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-%E5%88%86%E8%AF%8D%E5%99%A8-%E5%92%8C-%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95%E5%B1%9E%E6%80%A7"><span class="toc-text">4. 分词器 和 创建索引属性</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E6%95%B4%E5%90%88%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8A%80%E6%9C%AF"><span class="toc-text">8. 整合第三方技术</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%BC%93%E5%AD%98-%E9%83%A8%E5%88%86%E8%BF%87%E6%97%B6%EF%BC%8C%E4%BB%A5%E6%9C%80%E6%96%B0%E4%B8%BA%E4%B8%BB%EF%BC%8C%E8%87%AA%E8%A1%8C%E7%90%86%E8%A7%A3"><span class="toc-text">1. 缓存 (部分过时，以最新为主，自行理解)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%A8%A1%E6%8B%9F%E7%BC%93%E5%AD%98"><span class="toc-text">1. 模拟缓存</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E6%A8%A1%E6%8B%9F%E9%AA%8C%E8%AF%81"><span class="toc-text">2. 模拟验证</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-SpringBoot-%E7%BC%93%E5%AD%98"><span class="toc-text">3. SpringBoot 缓存</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E6%A8%A1%E6%8B%9F%E7%9F%AD%E4%BF%A1%E9%AA%8C%E8%AF%81-Simple"><span class="toc-text">4. 模拟短信验证(Simple)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-Ehcache-Redis-memcached-%E7%BC%93%E5%AD%98%E7%BB%9F%E4%B8%80%E6%8E%A5%E5%8F%A3%E9%85%8D%E7%BD%AE"><span class="toc-text">5. Ehcache Redis memcached 缓存统一接口配置</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-Ehcache-Redis"><span class="toc-text">1. Ehcache Redis</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-memcached-%E7%BC%93%E5%AD%98%E6%95%B4%E5%90%88"><span class="toc-text">2. memcached 缓存整合</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-jetCache"><span class="toc-text">6. jetCache</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-jetCache-%E7%89%B9%E6%80%A7"><span class="toc-text">1. jetCache 特性</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-%E6%95%B4%E4%BD%93%E9%83%A8%E7%BD%B2-%E5%9F%BA%E7%A1%80"><span class="toc-text">2. 整体部署(基础)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-jetCache-%E6%96%B9%E6%B3%95%E7%BC%93%E5%AD%98-%E6%94%B9%E5%8A%A8%E5%9F%BA%E7%A1%80"><span class="toc-text">3. jetCache 方法缓存(改动基础)</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7-j2cache"><span class="toc-text">7. j2cache</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-j2cache-%E7%89%B9%E6%80%A7"><span class="toc-text">1. j2cache 特性</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-j2cache-%E4%B8%BB%E8%A6%81%E6%95%B4%E5%90%88-Redis-Ehcache"><span class="toc-text">2. j2cache (主要整合 Redis Ehcache)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%BB%BB%E5%8A%A1"><span class="toc-text">2. 任务</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-SpringBoot-%E6%95%B4%E5%90%88-Quartz"><span class="toc-text">1. SpringBoot 整合 Quartz</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E6%A6%82%E5%BF%B5"><span class="toc-text">1. 概念</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-Quartz"><span class="toc-text">2. Quartz</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-Spring-Task"><span class="toc-text">2. Spring Task</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-SpringBoot-%E6%95%B4%E5%90%88-JavaMail"><span class="toc-text">3. SpringBoot 整合 JavaMail</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-JavaMail-%E5%9F%BA%E7%A1%80"><span class="toc-text">1. JavaMail(基础)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%B6%88%E6%81%AF"><span class="toc-text">3. 消息</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E5%90%8C%E6%AD%A5%E6%B6%88%E6%81%AF"><span class="toc-text">1. 同步消息</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%BC%82%E6%AD%A5%E6%B6%88%E6%81%AF"><span class="toc-text">2. 异步消息</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-JMS"><span class="toc-text">1. JMS</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-AMQP"><span class="toc-text">2. AMQP</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-MQTT"><span class="toc-text">3. MQTT</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-Kafka"><span class="toc-text">4. Kafka</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E6%B6%88%E6%81%AF%E6%A1%88%E4%BE%8B-%E2%80%94-%E6%A8%A1%E6%8B%9F%E8%AE%A2%E5%8D%95%E7%9F%AD%E4%BF%A1%E9%80%9A%E7%9F%A5"><span class="toc-text">3. 消息案例 — 模拟订单短信通知</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-ActiveMQ"><span class="toc-text">1. ActiveMQ</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-RabbitMQ"><span class="toc-text">2. RabbitMQ</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-RocketMQ"><span class="toc-text">3. RocketMQ</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-Kafka-1"><span class="toc-text">4. Kafka</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E7%9B%91%E6%8E%A7"><span class="toc-text">4. 监控</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E7%9B%91%E6%8E%A7%E7%9A%84%E6%84%8F%E4%B9%89"><span class="toc-text">1. 监控的意义</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E7%9B%91%E6%8E%A7%E7%9A%84%E5%AE%9E%E6%96%BD%E6%96%B9%E5%BC%8F"><span class="toc-text">1. 监控的实施方式</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%8F%AF%E8%A7%86%E5%8C%96%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0"><span class="toc-text">2. 可视化监控平台</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-SpringBoot-Admin"><span class="toc-text">1. SpringBoot Admin</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%9B%91%E6%8E%A7%E5%8E%9F%E7%90%86"><span class="toc-text">3. 监控原理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%91%E6%8E%A7%E6%8C%87%E6%A0%87"><span class="toc-text">4. 自定义监控指标</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-Docker"><span class="toc-text">2. Docker</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E4%BC%A0%E7%BB%9F-Linux-%E5%AE%89%E8%A3%85-MySQL-%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">1. 传统 Linux 安装 MySQL 数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-text">1. 准备工作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83"><span class="toc-text">1. 查看系统环境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%B8%8B%E8%BD%BDMySQL-%E5%AE%89%E8%A3%85%E5%8C%85"><span class="toc-text">2. 下载MySQL 安装包</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%89%E8%A3%85"><span class="toc-text">2. 安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%8D%B8%E8%BD%BD%E9%BB%98%E8%AE%A4%E6%95%B0%E6%8D%AE%E5%BA%93-MariaDB"><span class="toc-text">1. 卸载默认数据库 MariaDB</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Docke-%E5%AE%89%E8%A3%85"><span class="toc-text">2.Docke 安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%85%8D%E7%BD%AEDocker-%E7%9A%84-yum-%E5%BA%93"><span class="toc-text">1. 配置Docker 的 yum 库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%89%E8%A3%85-Docker"><span class="toc-text">2. 安装 Docker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%85%8D%E7%BD%AE%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F"><span class="toc-text">3. 配置镜像加速</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Docker-%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2MySQL"><span class="toc-text">4. Docker 一键部署MySQL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4"><span class="toc-text">3. 常见命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%9F%A5%E7%9C%8BDockerHub%EF%BC%8C%E6%8B%89%E5%8F%96nginx-%E9%95%9C%E5%83%8F%EF%BC%8C%E5%88%9B%E5%BB%BA%E8%BF%90%E8%A1%8CNginx%E5%AE%B9%E5%99%A8"><span class="toc-text">4. 查看DockerHub，拉取nginx 镜像，创建运行Nginx容器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%91%BD%E4%BB%A4%E5%88%AB%E5%90%8D"><span class="toc-text">5. 命令别名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="toc-text">6.数据卷</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%8D%B7%E6%8C%82%E8%BD%BD"><span class="toc-text">1. 数据卷挂载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-mysql%E5%AE%B9%E5%99%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E6%8C%82%E8%BD%BD"><span class="toc-text">2. mysql容器的数据挂载</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E8%87%AA%E5%AE%9A%E4%B9%89%E9%95%9C%E5%83%8F"><span class="toc-text">7. 自定义镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%95%9C%E5%83%8F%E7%BB%93%E6%9E%84"><span class="toc-text">1. 镜像结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Dockerfile"><span class="toc-text">Dockerfile</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E7%BD%91%E7%BB%9C"><span class="toc-text">8. 网络</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%B9%E5%99%A8%E4%BA%92%E8%81%94"><span class="toc-text">1. 容器互联</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-DockerCompose"><span class="toc-text">9. DockerCompose</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-docker-compose-%E5%91%BD%E4%BB%A4%E6%A0%BC%E5%BC%8F"><span class="toc-text">1. docker compose 命令格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-docker-compose-yml%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2"><span class="toc-text">2. docker-compose.yml一键部署</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-Redis"><span class="toc-text">3.Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Redis-%E5%9F%BA%E7%A1%80"><span class="toc-text">1.Redis 基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%88%9D%E8%AF%86Redis"><span class="toc-text">1.初识Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%AE%A4%E8%AF%86NoSQL"><span class="toc-text">1.认识NoSQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%AE%A4%E8%AF%86Redis"><span class="toc-text">2.认识Redis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%AE%89%E8%A3%85Redis"><span class="toc-text">3.安装Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-Redis%E6%8C%87%E5%AE%9A%E9%85%8D%E7%BD%AE%E5%90%AF%E5%8A%A8"><span class="toc-text">1.Redis指定配置启动</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF"><span class="toc-text">2.开机自启</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-Redis%E5%AE%A2%E6%9C%8D%E7%AB%AF"><span class="toc-text">3.Redis客服端</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-text">1.命令行客户端</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-%E5%9B%BE%E5%BD%A2%E5%8C%96%E6%A1%8C%E9%9D%A2%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-text">2.图形化桌面客户端</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Redis%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4"><span class="toc-text">2.Redis常见命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5%E7%A7%8D%E5%B8%B8%E8%A7%81%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-text">1.5种常见数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-Redis%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-text">1.Redis数据结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-Redis%E9%80%9A%E7%94%A8%E5%91%BD%E4%BB%A4-Keys"><span class="toc-text">2.Redis通用命令(Keys)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-String%E7%B1%BB%E5%9E%8B"><span class="toc-text">3.String类型</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-String%E7%9A%84%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E6%9C%89%EF%BC%9A"><span class="toc-text">1.String的常见命令有：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-key%E7%9A%84%E7%BB%93%E6%9E%84"><span class="toc-text">2.key的结构</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-Hash%E7%B1%BB%E5%9E%8B"><span class="toc-text">4.Hash类型</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-Hash%E7%9A%84%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E6%9C%89%EF%BC%9A"><span class="toc-text">1.Hash的常见命令有：</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-List%E7%B1%BB%E5%9E%8B"><span class="toc-text">5.List类型</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-List%E7%89%B9%E5%BE%81"><span class="toc-text">1.List特征</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-List%E7%9A%84%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4"><span class="toc-text">2.List的常见命令</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-%E6%A8%A1%E6%8B%9F-%E6%A0%88-%E5%8A%9F%E8%83%BD"><span class="toc-text">3.模拟 栈 功能</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-Set%E7%B1%BB%E5%9E%8B"><span class="toc-text">6.Set类型</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-Set%E7%9A%84%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4"><span class="toc-text">1.Set的常见命令</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7-SortedSet%E7%B1%BB%E5%9E%8B"><span class="toc-text">7.SortedSet类型</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-SortedSet%E7%89%B9%E6%80%A7"><span class="toc-text">1.SortedSet特性</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-SortedSet%E7%9A%84%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4"><span class="toc-text">2.SortedSet的常见命令</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Redis%E7%9A%84Java%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-text">3.Redis的Java客户端</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Jedis%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-text">1.Jedis客户端</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-Springboot%E6%95%B4%E5%90%88Jedis"><span class="toc-text">1.Springboot整合Jedis</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-SpringDataRedis-%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-text">2.SpringDataRedis 客户端</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-RedisTemplate%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-text">1.RedisTemplate工具类</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-SpringBoot-%E9%85%8D%E7%BD%AE%E5%BA%8F%E5%88%97%E5%8C%96%E7%B1%BB"><span class="toc-text">1.SpringBoot 配置序列化类</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-SpringDataRedis%E6%95%B4%E5%90%88"><span class="toc-text">2.SpringDataRedis整合</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Axios"><span class="toc-text">4.Axios</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Axios%E7%89%B9%E6%80%A7"><span class="toc-text">1.Axios特性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-redis%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0"><span class="toc-text">5.redis课程笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Axios-%E4%BD%BF%E7%94%A8"><span class="toc-text">2.Axios 使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AE%89%E8%A3%85vue-axios"><span class="toc-text">1.安装vue axios</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E4%B8%8B%E8%BD%BD-vue-axios"><span class="toc-text">1.下载 vue-axios</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%9C%A8main-js-%E5%BC%95%E5%85%A5"><span class="toc-text">2.在main.js 引入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E5%8F%91%E9%80%81axios%E8%AF%B7%E6%B1%82"><span class="toc-text">3.发送axios请求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-SpringMVC-%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98"><span class="toc-text">4.SpringMVC 解决跨域问题</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E8%A7%A3%E5%86%B3axios%E6%97%A0%E6%B3%95%E4%BC%A0%E9%80%92data%E4%B8%AD%E7%9A%84%E5%8F%82%E6%95%B0%E9%97%AE%E9%A2%98"><span class="toc-text">1.解决axios无法传递data中的参数问题</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-MyBatis%E5%85%A5%E9%97%A8"><span class="toc-text">9.MyBatis入门</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82%E6%A1%86%E6%9E%B6"><span class="toc-text">1.数据持久层框架</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%B1%82"><span class="toc-text">1.数据持久层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-ORM"><span class="toc-text">2.ORM</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Mybatis%E6%A1%86%E6%9E%B6"><span class="toc-text">2.Mybatis框架</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MyBatis%E7%89%B9%E7%82%B9"><span class="toc-text">MyBatis特点</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%AE%80%E5%8D%95%E6%98%93%E5%AD%A6"><span class="toc-text">1.简单易学</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%81%B5%E6%B4%BB"><span class="toc-text">2.灵活</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%8F%90%E4%BE%9B%E6%98%A0%E5%B0%84%E6%A0%87%E7%AD%BE"><span class="toc-text">3.提供映射标签</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-MyBatis%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-text">3.MyBatis工作原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-MyBatis%E6%A0%B8%E5%BF%83%E7%B1%BB"><span class="toc-text">1.MyBatis核心类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Configuration"><span class="toc-text">1.Configuration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-SqlSessionFactory"><span class="toc-text">2.SqlSessionFactory</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-SqlSession"><span class="toc-text">3.SqlSession</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#SqlSession%E7%9A%84%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-text">SqlSession的实现类</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-DefaultSqlSession"><span class="toc-text">1.DefaultSqlSession</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-SqlSessionManager"><span class="toc-text">2.SqlSessionManager</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Executor"><span class="toc-text">4.Executor</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-MappedStatement"><span class="toc-text">5.MappedStatement</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-MyBatis%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-text">2.MyBatis工作流程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4"><span class="toc-text">4.Mybatis入门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-SQL-1"><span class="toc-text">1.SQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-cn-edu-example-mybatis-mapper"><span class="toc-text">2.cn.edu.example.mybatis.mapper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-cn-edu-example-mybatis-po"><span class="toc-text">3.cn.edu.example.mybatis.po</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-cn-edu-example-mybatis-test"><span class="toc-text">3.cn.edu.example.mybatis.test</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-mybatis-config-xml"><span class="toc-text">4.mybatis-config.xml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%BE%93%E5%87%BA"><span class="toc-text">5.输出</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-Mybatis%E9%85%8D%E7%BD%AE"><span class="toc-text">10 Mybatis配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E5%B1%9E%E6%80%A7-properties"><span class="toc-text">1.1 属性(properties)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E8%AE%BE%E7%BD%AE-settings"><span class="toc-text">1.2 设置(settings)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E7%B1%BB%E5%9E%8B%E5%88%AB%E5%90%8D-typeAiases"><span class="toc-text">3.类型别名(typeAiases)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-environments"><span class="toc-text">4.环境配置(environments)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%85%83%E7%B4%A0%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83"><span class="toc-text">1.元素定义配置环境</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E5%99%A8%E5%92%8C%E6%95%B0%E6%8D%AE%E6%BA%90-%E4%BB%8B%E7%BB%8D"><span class="toc-text">1.事务管理器和数据源 介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E5%99%A8-type-x3D-%E2%80%9D-JDBC-x2F-MANAGED-%E2%80%9C"><span class="toc-text">1事务管理器 type&#x3D;” [JDBC &#x2F; MANAGED] “</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E6%BA%90-type-x3D-%E2%80%9C-UNPOOLED-x2F-POOLED-x2F-JND-%E2%80%9C"><span class="toc-text">2.数据源 type&#x3D; “ [UNPOOLED &#x2F; POOLED &#x2F; JND ] “</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%98%A0%E5%B0%84%E5%99%A8-mappers"><span class="toc-text">5.映射器(mappers)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-mapper-xml-%E5%B8%B8%E7%94%A8SQL%E6%A0%87%E7%AD%BE"><span class="toc-text">6. mapper.xml 常用SQL标签</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E9%9C%80%E8%A6%81%E9%85%8D%E7%BD%AE%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="toc-text">1.需要配置的属性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-if-%E5%92%8C-where-%E6%A0%87%E7%AD%BE"><span class="toc-text">1.if 和 where 标签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-set-%E6%A0%87%E7%AD%BE"><span class="toc-text">2.set 标签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-trim-%E6%A0%87%E7%AD%BE"><span class="toc-text">3.trim 标签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-chooseWhenOtherwise-%E6%A0%87%E7%AD%BE"><span class="toc-text">4.chooseWhenOtherwise 标签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-foreach-%E6%A0%87%E7%AD%BE"><span class="toc-text">5.foreach 标签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-bind-%E6%A0%87%E7%AD%BE"><span class="toc-text">6.bind 标签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-sql-%E7%89%87%E6%AE%B5%E6%A0%87%E7%AD%BE"><span class="toc-text">7.sql 片段标签</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Mybatis-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-text">7. Mybatis 多表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%B8%80%E5%AF%B9%E4%B8%80"><span class="toc-text">1. 一对一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%B8%80%E5%AF%B9%E5%A4%9A"><span class="toc-text">2. 一对多</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%A4%9A%E5%AF%B9%E5%A4%9A"><span class="toc-text">3. 多对多</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9D%A2%E8%AF%95%E9%A2%98"><span class="toc-text">面试题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Mybatis"><span class="toc-text">Mybatis</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring-%E2%80%94%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98"><span class="toc-text">Spring —黑马程序员</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring"><span class="toc-text">Spring</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Exml%E7%9A%84Spring%E5%BA%94%E7%94%A8"><span class="toc-text">基于xml的Spring应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SpringBean-%E7%9A%84%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3"><span class="toc-text">SpringBean 的配置详解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SpringBean%E9%85%8D%E7%BD%AE"><span class="toc-text">SpringBean配置</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/03/15/Sqlite/" title="Sqlite基础语法"><img src="/img/19.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Sqlite基础语法"/></a><div class="content"><a class="title" href="/2024/03/15/Sqlite/" title="Sqlite基础语法">Sqlite基础语法</a><time datetime="2024-03-14T23:40:46.000Z" title="发表于 2024-03-15 07:40:46">2024-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/10/ErrorReport/" title="ErrorReport"><img src="/img/18.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ErrorReport"/></a><div class="content"><a class="title" href="/2023/10/10/ErrorReport/" title="ErrorReport">ErrorReport</a><time datetime="2023-10-10T11:00:22.000Z" title="发表于 2023-10-10 19:00:22">2023-10-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/08/23/RequirementSpecification/" title="RequirementSpecification"><img src="/img/13.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="RequirementSpecification"/></a><div class="content"><a class="title" href="/2023/08/23/RequirementSpecification/" title="RequirementSpecification">RequirementSpecification</a><time datetime="2023-08-23T04:55:04.000Z" title="发表于 2023-08-23 12:55:04">2023-08-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/08/22/MybatisPlus/" title="MybatisPlus"><img src="/img/23.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MybatisPlus"/></a><div class="content"><a class="title" href="/2023/08/22/MybatisPlus/" title="MybatisPlus">MybatisPlus</a><time datetime="2023-08-22T13:35:35.000Z" title="发表于 2023-08-22 21:35:35">2023-08-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/08/19/Maven/" title="Maven基础"><img src="/img/27.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Maven基础"/></a><div class="content"><a class="title" href="/2023/08/19/Maven/" title="Maven基础">Maven基础</a><time datetime="2023-08-19T13:49:08.000Z" title="发表于 2023-08-19 21:49:08">2023-08-19</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By Wabi-Sabifag</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><div><a onclick="window.open('https://bilibili.com')"><img src=''>湖公网安备 </a></div> <div>当内心一片虚无的时刻，我将心脏埋入这无尽的土壤</div>  <div>理想主义 现实主义 实用主义</div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="60198" data-server="netease" date-type="playlist" data-fixed="true" data-autoplay="true"></div><link rel="stylesheet" href="css/style.css"><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script></div></body></html>